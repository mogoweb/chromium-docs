<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/developer-guide","deleted":false,"title":"Chromium OS Developer Guide","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/chromium-os/developer-guide\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os","parentWuid":"wuid:gx:83df2ab1f8880ba","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Chromium OS Developer Guide","locale":"en","wuid":"wuid:gx:27255a11f3a32ed5","revision":451,"path":"/chromium-os/developer-guide","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"developer-guide","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Chromium OS Developer Guide - The Chromium Projects" />
<meta itemprop="name" content="Chromium OS Developer Guide - The Chromium Projects" />
<meta property="og:title" content="Chromium OS Developer Guide - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Chromium OS Developer Guide - The Chromium Projects</title>
<meta itemprop="image" content="https://sites.google.com/a/chromium.org/dev/_/rsrc/1291311476547/chromium-os/developer-guide/TrackerName.png?height=85&amp;width=320" />
<meta property="og:image" content="https://sites.google.com/a/chromium.org/dev/_/rsrc/1291311476547/chromium-os/developer-guide/TrackerName.png?height=85&amp;width=320" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../developers/discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../chromium-os.1.html" dir="ltr">Chromium OS</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Chromium OS Developer Guide</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:400px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-2"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Introduction"><strong>1 </strong>Introduction</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Target-audience"><strong>1.1 </strong>Target audience</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Organization-content"><strong>1.2 </strong>Organization &amp; content</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Typography-conventions"><strong>1.3 </strong>Typography conventions</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Modifying-this-document"><strong>1.4 </strong>Modifying this document</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Additional-information"><strong>1.5 </strong>Additional information</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Prerequisites"><strong>2 </strong>Prerequisites</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Install-git-subversion-and-curl"><strong>2.1 </strong>Install git, subversion, and curl</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Install-depot_tools"><strong>2.2 </strong>Install depot_tools</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Tweak-your-sudoers-configuration"><strong>2.3 </strong>Tweak your sudoers configuration</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Configure-git"><strong>2.4 </strong>Configure git</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Preparations-to-submit-changes"><strong>2.5 </strong>Preparations to submit changes</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Double-check-that-you-are-running-a-64-bit-architecture"><strong>2.6 </strong>Double-check that you are running a 64-bit architecture</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Verify-that-your-default-file-permissions-umask-setting-is-correct"><strong>2.7 </strong>Verify that your default file permissions (umask) setting is correct</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Get-the-Source"><strong>3 </strong>Get the Source</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Decide-where-your-source-will-live"><strong>3.1 </strong>Decide where your source will live</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Get-the-source"><strong>3.2 </strong>Get the source code</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Building-Chromium-OS"><strong>4 </strong>Building Chromium OS</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Create-a-chroot"><strong>4.1 </strong>Create a chroot</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Enter-the-chroot"><strong>4.2 </strong>Enter the chroot</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Select-a-board"><strong>4.3 </strong>Select a board</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Initialize-the-build-for-a-board"><strong>4.4 </strong>Initialize the build for a board</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Set-the-chronos-user-password"><strong>4.5 </strong>Set the chronos user password</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Build-the-packages-for-your-board"><strong>4.6 </strong>Build the packages for your board</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Build-a-disk-image-for-your-board"><strong>4.7 </strong>Build a disk image for your board</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Look-at-your-disk-image-optional-"><strong>4.8 </strong>Look at your disk image (optional)</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Installing-Chromium-OS-on-your-Device"><strong>5 </strong>Installing Chromium OS on your Device</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Put-your-image-on-a-USB-disk"><strong>5.1 </strong>Put your image on a USB disk</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Disable-verified-boot"><strong>5.2 </strong>Disable verified boot</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Boot-from-your-USB-disk"><strong>5.3 </strong>Boot from your USB disk</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Installing-your-Chromium-OS-image-to-your-hard-disk"><strong>5.4 </strong>Installing your Chromium OS image to your hard disk</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Getting-to-a-command-prompt-on-Chro"><strong>5.5 </strong>Getting to a command prompt on Chromium OS</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Building-an-image-to-run-in-a-virtu"><strong>5.6 </strong>Building an image to run in a virtual machine</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Making-changes-to-packages-whose-source-code-is-checked-into-Chromium-OS-git-repositories"><strong>6 </strong>Making changes to packages whose source code is checked into Chromium OS git repositories</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Keep-the-tree-green"><strong>6.1 </strong>Keep the tree green</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Run-cros_workon-start"><strong>6.2 </strong>Run cros_workon start</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Run-repo-sync"><strong>6.3 </strong>Run repo sync</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Figure-out-where-the-ebuild-source-"><strong>6.4 </strong>Find out which ebuilds map to which directories</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Create-a-branch-for-your-changes"><strong>6.5 </strong>Create a branch for your changes</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Make-your-changes"><strong>6.6 </strong>Make your changes</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Set-your-editor"><strong>6.7 </strong>Set your editor</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Submit-changes-locally"><strong>6.8 </strong>Submit changes locally</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Upload-your-changes-and-get-a-code-review"><strong>6.9 </strong>Upload your changes and get a code review</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Try-seeing-the-mainline-again"><strong>6.10 </strong>Try seeing the mainline again</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Work-on-something-else-while-you-re-waiting"><strong>6.11 </strong>Work on something else while you're waiting</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Send-your-changes-to-the-Commit-Queue"><strong>6.12 </strong>Send your changes to the Commit Queue</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Make-sure-your-changes-didn-t-break-things"><strong>6.13 </strong>Make sure your changes didn't break things</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Share-your-changes-using-the-Gerrit-sandbox"><strong>6.14 </strong>Share your changes using the Gerrit sandbox</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Clean-up-after-you-re-done-with-your-changes"><strong>6.15 </strong>Clean up after you're done with your changes</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Making-changes-to-non-cros_workon-able-packages"><strong>7 </strong>Making changes to non-cros_workon-able packages</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Adding-small-patches-to-existing-packages"><strong>7.1 </strong>Adding small patches to existing packages</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Making-changes-to-the-way-that-the-"><strong>7.2 </strong>Making changes to the way that the chroot is constructed</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Building-an-individual-package"><strong>7.3 </strong>Building an individual package</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Making-changes-to-the-Chromium-web-"><strong>7.4 </strong>Making changes to the Chromium web browser on Chromium OS</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Using-Clang-to-get-better-compiler-diagnostics"><strong>8 </strong>Using Clang to get better compiler diagnostics</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Description"><strong>8.1 </strong>Description</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Wrapper-Options"><strong>8.2 </strong>Wrapper Options</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Testing"><strong>8.3 </strong>Testing</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Local-Debugging"><strong>9 </strong>Local Debugging</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Debugging-both-x86-and-non-x86-binaries-on-your-workstation."><strong>9.1 </strong>Debugging both x86 and non-x86 binaries on your workstation.</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Remote-Debugging"><strong>10 </strong>Remote Debugging</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Setting-up-remote-debugging-by-hand."><strong>10.1 </strong>Setting up remote debugging by hand.</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Automated-remote-debugging-using-gdb--BOARD-script-gdb-lumpy-gdb-daisy-gdb-parrot-etc-."><strong>10.2 </strong>Automated remote debugging using gdb-${BOARD} script (gdb-lumpy, gdb-daisy, gdb-parrot, etc).</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-How-do-I-fix-network-problems-in-th"><strong>10.3 </strong>Examples of debugging using the gdb-${BOARD} script.</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Troubleshooting"><strong>11 </strong>Troubleshooting</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-I-lost-my-developer-tools-on-the-stateful-partition-can-I-get-them-back-"><strong>11.1 </strong>I lost my developer tools on the stateful partition, can I get them back?</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Running-Tests"><strong>12 </strong>Running Tests</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Seeing-which-tests-are-implemented-by-an-ebuild"><strong>12.1 </strong>Seeing which tests are implemented by an ebuild</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Getting-an-image-that-has-been-modi"><strong>12.2 </strong>Creating a recovery image that has been modified for test</a></li></ol></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Additional-information1"><strong>13 </strong>Additional information</a><ol class="goog-toc"><li class="goog-toc"><a href="developer-guide.1.html#TOC-Developer-mode"><strong>13.1 </strong>Toolchain Compilers</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Developer-mode1"><strong>13.2 </strong>Developer mode</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Attribution-requirements"><strong>13.3 </strong>Attribution requirements</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-Documentation-on-this-site"><strong>13.4 </strong>Documentation on this site</a></li><li class="goog-toc"><a href="developer-guide.1.html#TOC-External-documentation"><strong>13.5 </strong>External documentation</a></li></ol></li></ol></div></div></div></div>
<font color="#000000" size="2"><a name="TOC-Intro"></a></font>
<h2><a name="TOC-Introduction"></a>Introduction</h2>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">This guide describes how to work on Chromium OS. If you want to help develop Chromium OS and you're looking for detailed information about how to get started, you're in the right place.  You can also use the <a href="quick-start-guide.html">quick-start guide</a> instead, which gives just the basic steps that work for most people.<br />
</div>
<font color="#000000" size="2"><a name="TOC-Audience-of-this-document"></a></font>
<h3><a name="TOC-Target-audience"></a>Target audience</h3>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
The target audience of this guide is anyone who wants to obtain, build, or contribute to Chromium OS. That includes new developers who are interested in the project 
and who simply want to browse through the Chromium OS code, as well as developers who have been 
working on Chromium OS for a long time.
</div>
<h3><a name="TOC-Organization-content"></a>Organization &amp; content</h3>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">This guide describes the common tasks required to develop Chromium OS. The guide is organized linearly, so that developers who are new to Chromium OS can follow the tasks in sequence. The tasks are grouped into the following sections:</div>
<div>
<ul><li><a href="http://dev.chromium.org/chromium-os/developer-guide#TOC-Prerequisites" style="color:rgb(0,102,204)">Prerequisites</a></li>
<li><a href="http://dev.chromium.org/chromium-os/developer-guide#TOC-Get-the-Source" style="color:rgb(0,102,204)">Getting the source code</a></li>
<li><a href="developer-guide.1.html#TOC-Building-Chromium-OS" style="color:rgb(0,102,204)">Building Chromium OS</a></li>
<li><a href="http://dev.chromium.org/chromium-os/developer-guide#TOC-Installing-Chromium-OS-on-your-Device" style="color:rgb(0,102,204)">Running your image</a></li>
<li><a href="developer-guide.1.html#TOC-Making-changes-to-packages-whose-source-code-is-checked-into-Chromium-OS-git-repositories" style="color:rgb(0,102,204)">Making changes to packages whose source code is checked into Chromium OS git repositories</a></li>
<li><a href="developer-guide.1.html#TOC-Making-changes-to-non-cros_workon-able-packages" style="color:rgb(0,102,204)">Making changes to non-cros_workon-able packages</a></li>
<li><a href="developer-guide.1.html#TOC-Using-Clang-to-get-better-compiler-diagnostics" style="color:rgb(0,102,204)">Using Clang to get better compiler diagnostics</a></li>
<li><a href="developer-guide.1.html#TOC-Local-Debugging" style="color:rgb(0,102,204)">Local Debugging</a></li>
<li><a href="developer-guide.1.html#TOC-Remote-Debugging" style="color:rgb(0,102,204)">Remote Debugging</a></li>
<li><a href="developer-guide.1.html#TOC-Troubleshooting" style="color:rgb(0,102,204)">Troubleshooting</a></li>
<li><a href="developer-guide.1.html#TOC-Running-Tests" style="color:rgb(0,102,204)">Running Tests</a></li>
<li><a href="developer-guide.1.html#TOC-Additional-information1" style="color:rgb(0,102,204)">Additional information</a></li></ul>
</div>
<h3><a name="TOC-Typography-conventions"></a>Typography conventions</h3>
<ul style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<li style="margin-top:0.2em"><b>Paths, files, and commands</b> are shown in different colors to indicate whether they apply to (1) your build computer (the computer on which you're doing development), (2) the chroot on your build computer, or (3) your Chromium OS computer (the device on which you run the images you build):</li></ul>
<ul style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<table border="1" cellpadding="3" cellspacing="0" style="border-collapse:collapse;border:1px solid rgb(0,0,0);margin:1em 1em 0.75em">
<tbody>
<tr>
<th style="text-align:center;background-color:rgb(204,204,204)">Color</th>
<th style="text-align:center;background-color:rgb(204,204,204)">Paths, files, and commands:<br />
</th>
</tr>
<tr>
<td style="padding:2px 5px"><span style="font-family:courier new,monospace;color:rgb(56,118,29)">green text</span></td>
<td style="padding:2px 5px">on your build computer</td>
</tr>
<tr>
<td style="padding:2px 5px"><span style="font-family:courier new,monospace;color:rgb(153,0,255)">purple text</span></td>
<td style="padding:2px 5px">inside the chroot on your build computer</td>
</tr>
<tr>
<td style="padding:2px 5px"><span style="font-family:courier new,monospace;color:rgb(153,0,0)">crimson text</span></td>
<td style="padding:2px 5px">on your Chromium OS computer</td>
</tr>
</tbody>
</table>
<li style="margin-top:0.2em"><b>Notes</b> are shown using the following conventions:
<ul>
<li style="margin-top:0.2em"><b style="color:rgb(230,145,56)">IMPORTANT NOTE</b> describes required actions and critical information<br />
</li>
<li style="margin-top:0.2em"><b>SIDE NOTE</b> describes explanations, related information, and alternative options<br />
</li>
<li style="margin-top:0.2em"><b style="color:rgb(255,0,0)">TODO</b> describes questions or work that is needed on this document
</li>
</ul>
</li>
</ul>
<h3><a name="TOC-Modifying-this-document"></a>Modifying this document</h3>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
Only people with @chromium.org accounts can edit this document. Everyone else should post to the<span> </span><a href="http://groups.google.com/a/chromium.org/group/chromium-os-dev" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium OS dev group</a>.
</div>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin-top:1.5em">If you're a Chromium OS developer, <b>YOU SHOULD UPDATE THIS DOCUMENT</b> and fix things as appropriate.  There's a "Sign In" text button at the very bottom of this page.  Sign in (with your @chromium.org account, of course) and you'll get an "Edit" button at the top of the page.  Bias towards action: </div>
<ul style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<li style="margin-top:0.3em">If you see a <font color="#ff0000">red TODO</font> and you know the right answer, fix it!</li>
<li style="margin-top:0.3em">If you see something wrong, fix it. </li>
<li style="margin-top:0.3em">If you're not sure of the perfect answer, still fix it.   Stick in a <font color="#ff0000">red TODO</font> noting your uncertainty if you aren't sure, but don't let anything you know to be wrong stick around.</li></ul>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin-top:1.5em">Please try to abide by the following guidelines when you modify this document:</div>
<ul style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<li style="margin-top:0.3em">Put all general "getting started" information directly on this page. It's OK if this document grows big.</li>
<li style="margin-top:0.3em">If some information is also relevant for other documents, put the information in this document and add links from the other documents to this document. If you do not have a choice and must put information relevant to getting started in other documents, add links in this document to discrete chunks of information in the other documents. Following a web of links can be very confusing, especially for people who are new to a project, so it's very important to maintain a linear flow as much as possible.<br />
</li>
<li style="margin-top:0.3em">Where possible, describe a single way of doing things. If you specify multiple options, provide a clear explanation why someone following the instructions would pick one option over the others. If there is disagreement about how to do things, consider listing alternative options in a SIDE NOTE.</li>
<li style="margin-top:0.3em">Keep Google-specific references to a minimum. A large number of the people working on Chromium OS work at Google, and this document may occasionally contain references that are only relevant to engineers at Google. Google engineers, please keep such references to a minimum – Chromium OS is an open source project that should stay as open as possible.</li></ul>
<h3><a name="TOC-Additional-information"></a>Additional information</h3>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
This document provides an overview of the tasks required to develop Chromium OS. After you've learned the basics, check out the links in the <a href="developer-guide.1.html#TOC-Additional-information1">additional information</a> section at the end of this document for <span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times New Roman;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px">tips and tricks, FAQs, and </span></span>important details (e.g., the Chromium OS directory structure, using the dev server, etc.).<br />
<br />
Finally, if you build a Chromium OS image, please read this important note about <a href="developer-guide.1.html#TOC-Attribution-requirements">attribution requirements</a>.<br />
<br />
<br />
</div>
<hr style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px" />
<hr size="2" style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px" width="100%" />
<span style="text-indent:0px">
<font color="#000000" size="2"><a name="TOC-Getting-started-with-Chromium-OS-de"></a></font>
<font color="#000000" size="2"><a name="TOC-Prerequisites"></a></font>
<h2><a name="TOC-Prerequisites"></a>Prerequisites</h2>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">You must have Linux to develop Chromium OS.  Any recent or up-to-date distribution should work.  However, we can't support everyone and their dog's Linux distro, so the only official supported environment is listed below.  If you encounter issues with other setups, patches are generally welcomed, but please do not expect us to figure out your distro.</div>
<div>
<ul>
<li style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><a href="http://www.ubuntu.com/" style="color:rgb(0,102,204)">Ubuntu</a><span> </span>Linux (version 14.04 - Trusty)</li>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin:0.3em 1em 1em">Most developers working on Chromium OS are using Trusty (the LTS version of Ubuntu). It is possible that things will work if you're running a different Linux distribution, but you will probably find life easier if you're on this one.</div>
<li style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">an x86_64 64-bit system for performing the build<br />
<br />
</li>
<li style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">an account with <code style="color:rgb(0,96,0)">sudo</code> access</li>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin:0.3em 1em 1em">
You need root access to run the <code style="color:rgb(0,96,0)">chroot</code> command and to modify the mount table. <b>NOTE:</b> Do not run any of the commands listed in this document as root – the commands themselves will run sudo to get root access when needed.
</div></ul>
<div>
<ul><li style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">4 GB of RAM</li>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin:0.3em 1em 1em">While it may be technically possible to build with less, linking the browser uses 4GB, and swapping to disk will make the build prohibitively slow.</div></ul>
</div>
<div style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px;margin-top:1.5em">
You will have a much nicer time if you also have:
</div>
<ul style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<li>a fast multi-processor machine with lots of memory</li>
<div style="margin:0.3em 1em 1em">
The build system is optimized to make good use of all processors, and an 8 core machine will build nearly 8x faster than a single core machine. If you are building the full Chromium OS including Chrome (the browser), your machine should have at least 4GB of RAM, and 8GB is better. If you only have 4GB of RAM make sure you have at least 4GB of swap. There have been reports of even getting by with 2GB of RAM on a Linux box not running a GUI.
</div>
<li>a good Internet connection</li>
<div style="margin:0.3em 1em 1em">
This will help for the initial download (minimum of about 2GB) and any further updates.</div></ul>
<div>
<h3><a name="TOC-Install-git-subversion-and-curl"></a>Install git, subversion, and curl</h3>
<h3 style="border-collapse:separate;font-size:13px;font-weight:normal"><a name="TOC-Install-git"></a></h3>
<div style="border-collapse:separate">Install the git and subversion revision control systems, and the curl download helper. On Ubuntu, the magic incantation to do this is:</div>
<div style="border-collapse:separate"><br />
</div>
<div style="border-collapse:separate">
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code>sudo apt-get install </code><span style="color:rgb(0,96,0);font-family:monospace">git-core gitk git-gui </span><span style="color:rgb(0,96,0);font-family:monospace">subversion curl</span></div>
<div><code><br />
</code></div>
<div>
<div style="border-collapse:separate">This command also installs git's graphical front end (<code>git gui</code>) and revision history browser (<code>gitk</code>).</div>
</div>
<div><br />
</div>
</div>
</div>
<hr style="border-collapse:separate" />
<h3><a name="TOC-Install-depot_tools"></a>Install depot_tools</h3>
<h3 style="border-collapse:separate;font-size:13px;font-weight:normal"><a name="TOC-Install-depot_tools"></a></h3>
<div style="border-collapse:separate">To get started, follow the instructions at <a href="../developers/how-tos/install-depot-tools.html" style="color:rgb(0,102,204)">install depot_tools</a>. This step is required so that you can use the <span style="font-family:courier new,monospace;color:rgb(56,118,29)">repo</span> command to get/sync the source code.</div>
<div style="border-collapse:separate"><br />
</div>
<div style="border-collapse:separate">
<hr style="border-collapse:separate" />
<h3><a name="TOC-Tweak-your-sudoers-configuration"></a>Tweak your sudoers configuration</h3>
<h3 style="font-size:13px;border-collapse:separate;font-weight:normal"><a name="TOC-Install-depot_tools"></a></h3>
<div style="border-collapse:separate">
<p><font size="2"><font face="Arial"><span style="white-space:pre-wrap">You must tweak your sudoers configuration to turn off the tty_tickets option as described in </span></font></font><a href="http://www.chromium.org/chromium-os/tips-and-tricks-for-chromium-os-developers#TOC-Making-sudo-a-little-more-permissive" style="background-color:transparent;font-size:10pt">http://www.chromium.org/chromium-os/tips-and-tricks-for-chromium-os-developers#TOC-Making-sudo-a-little-more-permissive</a><font face="Arial" style="font-size:small;background-color:transparent"><span style="white-space:pre-wrap">. This is required for using </span></font><span style="background-color:transparent;color:rgb(0,96,0);font-family:monospace">cros_sdk</span><font face="Arial" style="font-size:small;background-color:transparent"><span style="white-space:pre-wrap">.</span></font></p>
</div>
</div>
<h3 style="border-collapse:separate;font-weight:normal"><a name="TOC-1"></a><font size="2"><a name="TOC-Install-git"></a></font></h3>
<div style="border-collapse:separate">
<hr />
</div>
<h3><a name="TOC-Configure-git"></a>Configure git</h3>
<h3 style="border-collapse:separate;font-size:13px;font-weight:normal"><a name="TOC-Configure-git"></a></h3>
<div style="border-collapse:separate">Setup git now. If you don't do this, you may run into errors/issues later.  Replace <code>you@example.com</code> and <code>Your Name</code> with your information:</div>
<div style="border-collapse:separate"><br />
</div>
<div style="border-collapse:separate"><span style="font-family:arial,sans-serif;border-collapse:collapse">
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px">
<div><code>git config --global user.email "you@example.com"</code></div>
<div><code>git config --global user.name "Your Name"</code></div>
</div>
<br />
</span></div>
<div style="border-collapse:separate"><br />
</div>
<div style="border-collapse:separate">
<hr />
</div>
<h3><a name="TOC-Preparations-to-submit-changes"></a>Preparations to submit changes</h3>
<h3 style="border-collapse:separate;font-size:13px;font-weight:normal"><a name="TOC-Preparations-if-you-are-committer"></a></h3>
<div style="border-collapse:separate"><span style="border-collapse:separate;font-family:Times New Roman;font-size:medium"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px"><b style="color:rgb(230,145,56)">IMPORTANT NOTE</b>: </span></span>If you are new to Chromium OS, you can skip this step <span style="font-size:10pt">(go to "</span><a href="developer-guide.1.html#TOC-Decide-where-your-source-will-live" style="font-size:10pt">decide where your source will live</a><span style="font-size:10pt">")</span><span style="font-size:10pt">.  This is only for people who wish to make changes to the tree.  Remember: anyone can post changes to Gerrit for review.</span></div>
<h4 style="border-collapse:separate;font-weight:normal"><a name="TOC-Submit-your-public-key-to-the-gitma"></a></h4>
<div>Follow the instructions <a href="developer-guide/gerrit-guide.html">here</a> to setup your code review account(s) and machine access credentials for the source repos. Remember a @chromium.org account is not required to submit code for review.</div>
<div>
<div style="border-collapse:separate"><br />
</div>
<div style="border-collapse:separate">
<hr />
</div>
<h3><a name="TOC-Double-check-that-you-are-running-a-64-bit-architecture"></a>Double-check that you are running a 64-bit architecture</h3>
<p>Run the following command:</p>
<div style="border-collapse:separate"></div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:normal;border-collapse:separate">
<div><code>uname -m</code></div>
<div></div>
</div>
<p>You should see the result: <code>x86_64</code></p>
<p>If you see something else (for example, <code style="border-collapse:separate">i686,</code> which means you are on a 32-bit machine or a 64-bit machine running a 32-bit OS) then you won't be able to build Chromium OS.  The project would happily welcome patches to fix this. </p>
<div>
<hr />
<h3><a name="TOC-Verify-that-your-default-file-permissions-umask-setting-is-correct"></a><font face="arial, sans-serif" size="3">Verify that your default file permissions (umask) setting is correct</font></h3>
</div>
<p><font size="2">Sources need to be world-readable to properly function inside the chroot (described later). For that reason, the last digit of your umask should not be higher than 2, eg. '002' or '022'. Many distros have this by default, Ubuntu, for instance, does not. It is essential to put the following line into your ~/.bashrc file before you checkout or sync your sources.</font></p>
<div><font size="2">
<div class="sites-codeblock sites-codesnippet-block"><code>umask 022</code></div>
</font></div>
<p>You can verify that this works by creating any file and checking if its permissions are correct.</p>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>$ touch ~/foo</code></div>
<div>
<div><code>$ ls -la ~/foo</code></div>
<div><code>-rw-r--r-- 1 user group 0 2012-08-30 23:09 /home/user/foo</code></div>
</div>
<div></div>
</div>
</div>
<br />
<hr size="2" style="border-collapse:separate;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px" width="100%" />
<h2><a name="TOC-Get-the-Source"></a>Get the Source</h2>
</div>
</span><span style="text-indent:0px">
<div>
</div>
<h3><a name="TOC-Decide-where-your-source-will-live"></a>Decide where your source will live</h3>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">Chromium OS developers commonly put their source code in <code style="color:rgb(0,96,0)">${HOME}/chromiumos</code>. If you feel strongly, put your own source elsewhere, but note that <b>all commands in this document assume that your source code is in</b> <code style="color:rgb(0,96,0)">${HOME}/chromiumos</code>.<br />
<br />
<span style="font-family:Arial,Verdana,sans-serif;font-size:13px">
<div>Create the directory for your source code with this command:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">mkdir -p ${HOME}/chromiumos</code></div>
</div>
<div>
</div>
</span><br />
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><b><font color="#e69138">IMPORTANT NOTE</font></b>: If your home directory is on NFS (as is true for engineers at Google), you<span> </span><b>must</b> place your code somewhere else. Not only is it a bad idea to build directly from NFS for performance reasons, but builds won't actually work (builds use sudo, and root doesn't have access to your NFS mount, unless your NFS server has the no_root_squash option). Wherever you place your source, you can still add a symbolic link to it from your home directory (this is suggested), like so:</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px">
<div><code style="color:rgb(0,96,0)">mkdir -p </code><span style="font-family:monospace;color:rgb(0,96,0)">/usr/local/<b>path/to/source</b>/chromiumos</span></div>
<div><code style="color:rgb(0,96,0)">ln -s /usr/local/<b>path/to/source</b>/chromiumos ${HOME}/chromiumos</code></div>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
</span>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<hr />
</div>
<h3><a name="TOC-Get-the-source"></a>Get the source code</h3>
<div style="border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<p>Chromium OS uses <a href="http://source.android.com/source/git-repo.html">repo</a> to sync down source code. <code style="color:rgb(0,96,0)">repo</code> is a wrapper for the<span> </span><a href="http://git-scm.com/" style="color:rgb(0,102,204);outline-style:none">git</a> that helps deal with a large number of<span> </span><code style="color:rgb(0,96,0)">git</code><span> </span>repositories. You already installed<span> </span><code style="color:rgb(0,96,0)">repo</code><span> </span>when you <a href="../developers/how-tos/install-depot-tools.html">installed<span> </span><code style="color:rgb(0,96,0)">depot_tools</code><span> </span>above</a>.</p>
<p><b>Make sure you have followed the gerrit credentials setup instructions <a href="developer-guide/gerrit-guide.1.html">here</a>.</b></p>
<p>(<b>Note: </b>If you are on a slow network connection or have low disk space, you can use the <b>minilayout</b> option below. This starts you out with a minimum amount of source code. This isn't a particularly well tested configuration and has been known to break from time-to-time, so we usually recommend against it.)</p>
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>cd ${HOME}/chromiumos</code></div>
<div><code># Note: Add the "-g minilayout" option to do a minilayout checkout.</code></div>
<div><code>repo init -u https://chromium.googlesource.com</code><span style="color:rgb(0,96,0);font-family:monospace">/</span><code>chromiumos/manifest.git </code><span style="color:rgb(0,96,0);font-family:monospace">--repo-url https://chromium.googlesource.com</span><span style="color:rgb(0,96,0);font-family:monospace">/</span><span style="color:rgb(0,96,0);font-family:monospace">external/repo.git [-g minilayout]</span></div>
<div><code>repo sync</code></div>
</div>
</div>
<p><b>Googlers:</b> See <a href="http://goto/chromeos-building">goto/chromeos-building</a> for internal notes.</p>
<h4><a name="TOC-Optionally-add-Google-API-keys"></a><b>Optionally add Google API keys</b></h4>
Secondly, decide whether you need to use features of Chromium that access Google APIs from the image<b> </b>you are building  (<b>signing in</b>, translating web pages, geolocation, etc<b>)</b>.  If the answer is yes, you will need to have keys (see <a href="http://www.chromium.org/developers/how-tos/api-keys">http://www.chromium.org/developers/how-tos/api-keys</a>) either in your include.gypi, or in a file in your home directory called ".googleapikeys".  If either of these file are present for step 1 of building (below) they will be included automatically.  If you don't have these keys, these features of chromium will be quietly disabled.

<h4><a name="TOC-Branch-Builds"></a>Branch Builds</h4>
<p>If you want to build on a branch, pass the branch name to repo init (e.g: <code>repo init -u &lt;URL&gt; [-g minilayout] <b>-b 0.9.94.T</b></code>).</p>
<p>When you use<span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"> </span><code style="color:rgb(0,96,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">repo init</code><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"> you will be asked </span>to confirm your name, email address, and whether you want color in your terminal. This command runs quickly. The<span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"> </span><code style="color:rgb(0,96,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">repo sync</code><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"> command </span>takes a lot longer.</p>
<p>More info can be found in the <a href="how-tos-and-troubleshooting/working-on-a-branch.html">working on a branch page</a>.</p>
<div style="border-collapse:separate">
<hr size="2" style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;line-height:normal;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif" width="100%" />
<h2><a name="TOC-Building-Chromium-OS"></a>Building Chromium OS</h2>
<h3><a name="TOC-Create-a-chroot"></a>Create a chroot</h3>
<p>To make sure everyone uses the same exact environment and tools to build Chromium OS, all building is done inside a<span> </span><a href="http://en.wikipedia.org/wiki/Chroot" style="color:rgb(0,102,204);outline-style:none">chroot</a>.  This chroot is its own little world: it contains its own compiler, its own tools (its own copy of bash, its own copy of sudo), etc.  Now that you've synced down the source code, you need to create this chroot. Assuming you're already in<span> </span><code style="color:rgb(0,96,0)">${HOME}/chromiumos</code><span> </span>(or wherever your source lives), the command to download and install the chroot is:</p>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-width:1px;border-top-style:solid;border-right-style:solid;border-bottom-style:solid;border-left-style:solid;border-top-color:rgb(211,211,211);border-right-color:rgb(211,211,211);border-bottom-color:rgb(211,211,211);border-left-color:rgb(211,211,211);display:block;padding-top:0.5em;padding-right:0px;padding-bottom:0.5em;padding-left:1em">
<div>
<div><font color="#006000" face="monospace" style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:13px;text-transform:none;white-space:normal;word-spacing:0px">cros_sdk</font></div>
</div>
</div>
<p>If this does not work, make sure you've added the depot_tools directory to your PATH already (as was needed above with using <code>repo</code>).</p>
<p>This will download and setup a prebuilt chroot from Chromium OS mirrors (under 400M). If you prefer to rather build it from source, or have trouble accessing the servers, use <span style="color:rgb(0,96,0);font-family:monospace;line-height:13px;background-color:rgb(239,239,239)">cros_sdk --bootstrap</span>. Note that this will also enter the chroot. If you prefer to build only, use <span style="color:rgb(0,96,0);font-family:monospace;line-height:13px;background-color:rgb(239,239,239)">--download</span>.</p>
<p>The command with --bootstrap takes about half an hour to run on a four core machine. It compiles quite a bit of software, which it installs into your chroot, and downloads some additional items (around 300MB). While it is building you will see a regular update of the number of packages left to build. Once the command finishes, the chroot will take up total disk space of a little over 3GB.</p>
<p>The chroot lives by default at <code style="color:rgb(0,96,0)">${HOME}/chromiumos/chroot</code>. Inside that directory you will find system directories like<span> </span><code style="color:rgb(0,96,0)">/usr/bin</code><span> </span>and<span> </span><code style="color:rgb(0,96,0)">/etc</code>. These are local to the chroot and are separate from the system directories on your machine. For example, the chroot has its own version of the<span> </span><code style="color:rgb(0,96,0)">ls</code><span> </span>utility. It will be very similar, but it is actually a different binary than the normal one you use on your machine.</p>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;line-height:normal">
<h4><a name="TOC-SIDE-NOTES:"></a><b style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">SIDE NOTES:</b></h4>
<ul><li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;margin-top:0.5em">You shouldn't have to create the chroot very often. Most developers create it once and never touch it again unless someone explicitly sends out an email telling them to recreate their chroot.</li>
<li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;margin-top:0.5em">The <span style="font-family:monospace;color:rgb(0,96,0)">cros_sdk</span> command currently doesn't work behind a proxy server, but there is a <a href="http://crosbug.com/10048" style="color:rgb(0,102,204);outline-style:none">workaround</a>.</li>
<li style="margin-top:0.5em">To help personalizing your chroot, the file <span style="color:rgb(0,96,0);font-family:monospace">${HOME}/.cros_chroot_init</span> is executed (if it exists) when the chroot is created.  The path to the chroot is passed as its argument (<span style="color:rgb(0,96,0);font-family:monospace">$1</span>).</li></ul>
</div>
</div>
<div>
<h3><a name="TOC-Enter-the-chroot"></a>
<hr />
<span style="text-indent:0px">Enter the chroot</span></h3>
</div>
<span style="text-indent:0px">
<p>Most of the commands that Chromium OS developers use on a day-to-day basis (including the commands to build a Chromium OS image) expect to be run from within the chroot. You can enter the chroot by calling:</p>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">cros_sdk</code></div>
</div>
<p>This is the same command used to create the chroot, but if the chroot already exists, it will just enter.</p>
<p>NOTE: if you want to run a single command in the chroot (rather than entering the chroot), prefix that command with <span style="background-color:rgb(255,255,255)"><span style="color:rgb(0,96,0);font-family:monospace;line-height:13px">cros_sdk -- </span><span style="color:rgb(0,96,0);font-family:monospace;line-height:13px">.</span></span></p>
</span><span style="text-indent:0px">
<p>This command will probably prompt you for your password for the<span> </span><code style="color:rgb(0,96,0)">sudo</code><span> </span>command (entering the chroot requires root privileges). Once the command finishes, that terminal is in the chroot and you'll be in the<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk/src/scripts</font></code><span> </span>directory, where most build commands live. In the chroot you can only see a subset of the filesystem on your machine. However, through some trickery (bind mounts), you will have access to the whole<span> </span><code style="color:rgb(0,96,0)">src</code> directory from within the chroot – this is so that you can build the software within the chroot.</p>
<p>Note in particular that the <code style="color:rgb(0,96,0)"><font color="#9900ff">src/scripts</font></code> directory is the same<span> </span><code style="color:rgb(0,96,0)">src/scripts</code><span> </span>directory found within the Chromium OS directory you were in before you entered the chroot<span style="font-size:10pt;background-color:transparent">, even though it looks like a different location. That's because when you enter the chroot, the </span><code style="font-size:10pt;background-color:transparent"><font color="#9900ff">~/trunk</font></code><span style="font-size:10pt;background-color:transparent"> directory in the chroot is mounted such that it points to the main Chromium OS directory </span><span style="font-size:10pt;font-family:monospace;color:rgb(0,96,0);background-color:transparent">${HOME}/chromiumos</span><span style="font-size:10pt;background-color:transparent">. That means that changes that you make to the source code outside of the chroot immediately take effect inside the chroot.</span></p>
</span><span style="text-indent:0px">
<p>Calling this will also install a chroot, if you don't have one yet, for example by not following the above.</p>
<p>While in the chroot you will see a special "(cros-chroot)" prompt to remind you that you are there:</p>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">(cros-chroot) johnnyrotten@flyingkite ~/trunk/src/scripts $ </code></div>
</div>
</div>
<p>You generally cannot run programs on your filesystem from within the chroot. For example, if you are using eclipse as an IDE, or gedit to edit a text file, you will need to run those programs outside the chroot. As a consolation, you can use vim. If you are desperate for emacs, try typing <code style="color:rgb(0,96,0)">sudo emerge emacs</code>. Of course this command will build emacs from source so allow 5-10mins.</p>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<h4><a name="TOC-IMPORTANT-NOTES:"></a><b><font color="#e69138">IMPORTANT NOTES</font></b><font color="#e69138">:<br />
</font></h4>
<ul><li style="margin-top:0.5em"><font color="#9900ff">In this document, commands that are intended to be entered inside the chroot, and paths inside the chroot, are colored purple.</font></li>
<li style="margin-top:0.5em"><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times New Roman;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px"><b>If you need to delete your chroot</b>, use <code style="color:rgb(0,96,0)">cros_sdk --delete</code><span> </span>to delete it properly. Using<span> </span><code style="color:rgb(0,96,0)">rm -rf</code><span> </span>could end up deleting your source tree due to the active bind mounts.</span></span></li></ul>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<h4><a name="TOC-SIDE-NOTES:1"></a><b>SIDE NOTES</b>:
</h4>
<ul>
<li style="margin-top:0.5em">If you need to share lots of files inside and outside chroot (for example, settings for your favorite editor / tools, or files downloaded by browser outside chroot, etc.), read <a href="tips-and-tricks-for-chromium-os-developers.html" style="color:rgb(0,102,204);outline-style:none">Tips and Tricks</a>.</li>
<li style="margin-top:0.5em">There is a file system loop because inside<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk</font></code><span> </span>you will find the chroot again. Don't think about this for too long. If you try to use<span> </span><code style="color:rgb(0,96,0)">du -s ${HOME}/chromiumos/chroot/home</code><span> </span>you
 might get a message about a corrupted file system. This is nothing to 
worry about, and just means that your computer doesn't understand this loop either. (If you <i>can</i> understand this loop, try<span> </span><a href="http://www.google.com/search?q=the+fourth+dimension" style="color:rgb(0,102,204);outline-style:none">something harder</a>.)</li></ul>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<hr />
</div>
<h3 style="color:rgb(0,0,0);line-height:normal"><a name="TOC-Select-a-board"></a><font face="arial, sans-serif">Select a board</font></h3>
Building Chromium OS produces a disk image (usually just called an "image") that can be copied directly onto the boot disk of a computer intended to run Chromium OS.  Depending on the specifics of that computer, you may want different files in the disk image. For example, if your computer has an ARM processor, you'll want to make sure that all executables in the image are compiled for the ARM instruction set. Similarly, if your computer has special hardware, you'll want to include a matching set of device drivers.
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">Different classes of computers are referred to by Chromium OS as different target "boards"  The following are some example boards:</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<ul><li style="font-weight:normal"><b>x86-generic</b><span> </span>- builds a generic image suitable for computers with a x86-compatible CPU (32 bit)</li>
<li><b>amd64-generic - </b>builds a generic image suitable for computers with a x86_64-compatible CPU (64 bit)</li>
<li style="font-weight:normal"><b>arm-generic</b><span> </span>- builds a generic image suitable for computers with an ARM CPU (32 bit)</li></ul>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">You need to choose a board for your first build. Don't worry too much about this choice – you can always build for another board later. If you want a list of known boards, you can look in<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk/src/overlays</font></code>.</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div style="font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">Each command in the build processes takes a <code><font color="#9900ff">--board</font></code> parameter.  To facilitate this, it can be helpful to keep the name of the board in a shell variable. This is not strictly necessary, but if you do this, you can simply copy and paste the commands below into your terminal program. Enter the following<span style="color:rgb(0,0,0)"> </span><font color="#9900ff" style="color:rgb(0,0,0)">inside your chroot</font> (note: change<span style="color:rgb(0,0,0)"> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">x86-generic</font></code><span style="color:rgb(0,0,0)"> </span>to whatever board you want to build for):</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">export BOARD=x86-generic</font></code></div>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">This setting only holds while you stay in the chroot. If you leave and come back, you need to do specify this setting again.</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div style="border-collapse:separate;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px"><b style="line-height:normal;color:rgb(0,0,0);font-size:13px;font-family:Arial,Verdana,sans-serif">SIDE NOTES</b>:<br />
<ul><li style="margin-top:0.5em">If you look at <span style="line-height:normal;color:rgb(153,0,255);font-size:13px;font-family:monospace">~/trunk/src/overlays<span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">, </span></span>you may notice two different naming patterns: <span style="line-height:normal;color:rgb(153,0,255);font-family:monospace">overlay-BOARD</span> and <span style="line-height:normal;color:rgb(153,0,255);font-family:monospace">overlay-variant-BOARD-VARIANT</span> (note the dash here). If you intend to build for particular board variant, you'll want to use <span style="line-height:normal;color:rgb(153,0,255);font-family:monospace">BOARD_VARIANT</span> pair (note the underscore here) as your board name. E.g. for <span style="line-height:normal;color:rgb(153,0,255);font-family:monospace">overlay-variant-peach-pi<span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"> the correct value for </span></span><span style="color:rgb(153,0,255);font-family:monospace"><span style="line-height:normal;background-color:rgb(255,255,255)">BOARD</span></span><span style="line-height:normal;color:rgb(153,0,255);font-family:monospace"><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"> would be </span>peach_pi</span>.</li></ul>
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px"><br />
</div>
<div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;border-collapse:separate;font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-transform:none;white-space:normal;word-spacing:0px">
<hr />
</div>
<div style="border-collapse:separate">
<h3 style="font-style:normal;font-variant:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);line-height:normal"><a name="TOC-Initialize-the-build-for-a-board"></a><font face="arial, sans-serif" size="3"><a name="TOC-Initialize-the-build-for-a-board"></a>Initialize the build for a board</font></h3>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">To start building for a given board, issue the following command<span> </span><font color="#9900ff">inside your chroot</font><span> </span>(you should be in the<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk/src/scripts</font></code><span> </span>directory):</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">./setup_board --board=${BOARD}</font></code></div>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">This command sets up the board target with a default sysroot of<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">/build/${BOARD}</font></code>. The command downloads a small amount of stuff and takes a few minutes to complete.<br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><b>SIDE NOTES</b>:<br />
<ul><li style="margin-top:0.5em">If you pass the <code style="color:rgb(0,96,0)"><font color="#9900ff">--default</font></code> flag to <code style="color:rgb(0,96,0)"><font color="#9900ff">setup_board</font></code>, the command writes the board name in the file<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk/src/scripts/.default_board</font></code><span> </span>(it does the same thing as <code style="color:rgb(0,96,0)"><font color="#9900ff">echo ${BOARD} &gt; ~/trunk/src/scripts/.default_board</font></code>). This makes it so that you don't need to specify a<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">--board</font></code> argument to subsequent commands. These instructions do not use the <code style="color:rgb(0,96,0)"><font color="#9900ff">--default</font></code> flag so that you can explicitly see what commands are board-specific.</li>
<li style="margin-top:0.5em">If you have previously set up this board, the <code style="color:rgb(0,96,0)"><font color="#9900ff">setup_board</font></code> command will fail. If you really want to clobber your old board files and start fresh, try passing the <code style="color:rgb(0,96,0)"><font color="#9900ff">--force</font></code> flag, which deletes the old <code style="color:rgb(0,96,0)"><font color="#9900ff">/build/${BOARD}</font></code> directory for you. Like<span> </span><code style="color:rgb(0,96,0)">cros_sdk</code>, most people only re-run<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">setup_board</font></code><span> </span>when told to (they don't re-run it even after a<span> </span><code style="color:rgb(0,96,0)">repo sync</code>).</li>
<li style="margin-top:0.5em">You can delete the board sysroot at any time with:<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">sudo rm -rf /build/${BOARD}</font></code></li></ul>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<hr />
</div>
<h3 style="font-style:normal;font-variant:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><a name="TOC-Set-the-chronos-user-password"></a><font size="3"><a name="TOC-Set-the-chronos-user-password"></a>Set the chronos user password</font></h3>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">On a Chromium OS computer, you can get command line access (and root access through the<span> </span><code style="color:rgb(0,96,0)">sudo</code><span> </span>command) by logging in with the shared user account "<font face="'courier new', monospace">chronos</font>".  You should set a password for the <span style="font-family:courier new,monospace">chronos</span> user by entering the command below from inside the <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/scripts</span> directory:</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./set_shared_user_password.sh</font></code></div>
</div>
<br />
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">You will be prompted for a password, which will be stored in encrypted form in <span style="color:rgb(153,0,255);font-family:monospace;line-height:13px">/etc/shared_user_passwd.txt</span>. </div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);line-height:normal"><b style="font-family:Arial,Verdana,sans-serif">SIDE NOTES:</b> <br />
<ul><li style="font-family:Arial,Verdana,sans-serif;margin-top:0.5em">The encrypted password is stored inside chroot. That means that<span> </span>if you recreate your chroot, you have to run this command again.</li>
<li style="margin-top:0.5em">If you don't set a shared user password, the password for the<span style="font-family:Arial,Verdana,sans-serif"> </span><font face="'courier new', monospace" style="font-family:Arial,Verdana,sans-serif">chronos</font><span style="font-family:Arial,Verdana,sans-serif"> </span>account may end up being any number of things depending on some complicated (and constantly evolving) formula that includes whether you build a developer image, whether you boot into developer mode, and the current state of the scripts.  The password might be empty, or a well-known string (such as "<font face="courier new, monospace">test0000</font>" on test images), or it might be impossible to login with<span style="font-family:Arial,Verdana,sans-serif"> </span><font face="'courier new', monospace" style="font-family:Arial,Verdana,sans-serif">chronos</font>.  It is strongly recommended that you simply set a shared user password.  <font color="#ff0000" style="font-family:Arial,Verdana,sans-serif">TODO: put a link to some place with more info about this.</font></li></ul>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<hr />
</div>
<h3 style="font-style:normal;font-variant:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><a name="TOC-Build-the-packages-for-your-board"></a><font size="3"><a name="TOC-Build-the-packages-for-your-board"></a>Build the packages for your board</font></h3>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">To build all the packages for your board, run the following command from inside the <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/scripts</span> directory:</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">./build_packages</font></code><span style="font-family:monospace;color:rgb(153,0,255)"> --board=${BOARD}</span></div>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">This step is the rough equivalent of<span> </span><code style="color:rgb(0,96,0)">make all</code><span> </span>in a standard Makefile system.  This command handles incremental builds; you should run it whenever you change something and need to rebuild it (or after you run<span> </span><code style="color:rgb(0,96,0)">repo sync</code>). </div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">Normally, the <span style="color:rgb(153,0,255);line-height:13px"><font face="'courier new', monospace">build_packages</font></span> command builds the stable version of a package (i.e. from committed git sources), unless you are working on a package (with <code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon</font></code>). If you are working on a package, <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">build_packages</span> will build using your local sources. See below for information about <span style="font-family:monospace;color:rgb(153,0,255)">cros_workon</span>.</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;line-height:normal"><b style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">SIDE NOTES:</b> 
<ul>
<li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;margin-top:0.5em">Even though there are some flags that can optimize your build (like <code style="color:rgb(0,96,0)"><font color="#9900ff">--nowithdev</font></code>, <font color="#9900ff">--nowithautotest</font>, etc), you <b>should not</b> use these flags (even if you don't plan on building a developer / test image). There are some <a href="http://crosbug.com/5777" style="color:rgb(0,102,204);outline-style:none">issues with virtual packages</a> that can cause some hard-to-debug differences if you use one of these flags.</li>
<li style="margin-top:0.5em">The <span style="color:rgb(153,0,255);font-family:monospace">--nowithdebug </span>flag is an exception to the previous point.  By default, packages other than Chrome will be compiled in debug mode; that is, with  <font color="#9900ff" face="monospace">NDEBUG</font> undefined and with debugging constructs like  <font color="#9900ff" face="monospace">DCHECK</font>,  <span style="color:rgb(153,0,255);font-family:monospace">DLOG</span>, and the red "Debug image" message present.  If you supply <span style="color:rgb(153,0,255);font-family:monospace">--nowithdebug</span>, then  <font color="#9900ff" face="monospace">NDEBUG</font> will be defined and the debugging constructs will be removed.</li>
<li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;margin-top:0.5em">The first time you run the <font color="#9900ff"><font face="'courier new', monospace">build_packages</font></font> command, it will take a long time (around 90 minutes on a four core machine), as it must build every package, and also download about 1.7GB of source packages and 1.3GB of binary packages. <a href="how-tos-and-troubleshooting/portage-build-faq.html#TOC-What-does-build_packages-actually-d">See here</a> for more information about what the <font face="'courier new', monospace"><font color="#9900ff">build_packages</font></font> command actually does. In short, it tries to download existing binary packages to avoid building anything (and puts them in<font color="#9900ff"><font face="'courier new', monospace">/build/${BOARD}/packages</font></font><span> </span>for subsequent builds). Failing that, it downloads source packages, puts them in <font color="#9900ff"><font face="'courier new', monospace">/var/lib/portage/distfiles-target</font></font>, and builds them.</li>
</ul>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<hr />
</div>
<h3 style="font-style:normal;font-variant:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><a name="TOC-Build-a-disk-image-for-your-board"></a><font size="3"><a name="TOC-Build-a-disk-image-for-your-board"></a>Build a disk image for your board</font></h3>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">Once the<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">build_packages</font></code><span> </span>step is finished, you can build a Chromium OS-base developer image by running the command below from inside the <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/scripts</span> directory:</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./build_image --board=${BOARD} --noenable_rootfs_verification dev</font></code></div>
</div>
<br />
<div style="font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;line-height:normal"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;color:rgb(0,0,0)">The args for build_image specify what type of build you want (dev in the example above).  Developers should normally build developer (dev) images.  A developer image provides a Chromium OS-based image with additional developer packages.  To build a test image with additional test-specific packages that also accepts an incoming ssh connection, use 'test' instead of 'dev'. If building a test image, the password set using </span><span style="font-family:monospace;line-height:13px;background-color:rgb(255,255,255)"><font size="2"><font color="#9900ff">set_shared_user_password.sh</font></font></span><span style="font-size:13px;background-color:transparent"> will be ignored and "<font face="courier new, monospace">test0000</font>" will be the password instead. The </span><font color="#9900ff" style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent">--noenable_rootfs_verification</font><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent"> turns off verified boot allowing you to freely modify the root file system.  The system is less secure using this flag, however, for rapid development you may want to set this flag.  If you would like a more secure, locked-down version of Chromium OS, then simply remove the <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">--noenable_rootfs_verification</span> flag.  Finally if you want just the pristine Chromium OS-based image (closest to Chrome OS but not quite the same), pass in </span><font color="#9900ff" style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent">base</font><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent"> rather than </span><font color="#9900ff" style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent">dev</font><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent">.  Use </span><font color="#9900ff" style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent">build_image --help</font><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;background-color:transparent"> for more information.</span></div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">The image produced by <span style="font-family:monospace;color:rgb(153,0,255)">build_image</span> will be located in <code style="color:rgb(0,96,0)"><font color="#9900ff">~/trunk/src/build/images/${BOARD}/versionNum/</font></code> (where <span style="font-family:monospace;color:rgb(153,0,255)">versionNum</span> will actually be a version number).  The most recent image produced for a given board will be symlinked to <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/build/images/${BOARD}/latest</span>.</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><b><font color="#e69138">IMPORTANT NOTE</font></b>: It's up to you to delete old builds that you don't need. Every time you run<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">build_image</font></code>, the command creates files that take up <b>over</b><span> </span><b>4GB of space</b><b>(!)</b>.</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<hr />
</div>
<font color="#000000" style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px"><a name="TOC-Looking-at-your-disk-image-optional"></a></font>
<h3 style="font-style:normal;font-variant:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><a name="TOC-Look-at-your-disk-image-optional-"></a><font size="3">Look at your disk image (optional)</font></h3>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<div>The preferred way to mount the image you just built to look at its contents is:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block"><font color="#9900ff" face="monospace">./mount_gpt_image.sh --board=${BOARD} -f $(./get_latest_image.sh --board=${BOARD})</font></div>
<div><br />
</div>
<div>Again, don't forget to unmount the root filesystem when you're done:</div>
<span style="line-height:13px">
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px">
<div>
<div><span style="font-family:monospace"><font color="#9900ff">./mount_gpt_image.sh --board=${BOARD} -u</font><font color="#0b5394"> </font></span></div>
</div>
</div>
</span>
<div><br />
</div>
</div>
<div>Optionally, you can unpack the partition as separate files and mount them directly:</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><span style="font-family:monospace"><code style="color:rgb(0,96,0)"><font color="#9900ff">cd ~/trunk/src/build/images/${BOARD}/latest</font></code></span></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./unpack_partitions.sh chromiumos_image.bin</font></code></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">mkdir -p rootfs</font></code></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">sudo mount -o loop,ro part_3 rootfs</font></code></div>
</div>
<div><br />
</div>
This will do a loopback mount of the rootfs from your image to the location <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">~/trunk/src/build/images/${BOARD}/latest/rootfs</span> in your chroot.</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">If you built with "<span style="color:rgb(34,34,34);font-family:arial,sans-serif">--noenable_rootfs_</span><span style="color:rgb(34,34,34);font-family:arial,sans-serif">verification" you can omit the "ro" option to mount it read write.</span></div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">If you built an x86 Chromium OS image, you can probably even try chrooting into the image:</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">sudo chroot </font></code><span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/build/images/${BOARD}/latest/rootfs</span></div>
</div>
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal"><br />
</div>
<div style="font-size:13px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;text-transform:none;white-space:normal;word-spacing:0px;color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;line-height:normal">This is a little hacky (the Chromium OS rootfs isn't really designed to be a chroot for your host machine), but it seems to work pretty well. Don't forget to <code style="color:rgb(0,96,0)">exit</code> this chroot when you're done.<br />
<br />
</div>
</div>
</span>When you're done, unmount the root filesystem:<br />
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div>
<div><span style="font-family:monospace"><font color="#9900ff">sudo umount ~/trunk/src/build/images/${BOARD}/latest/rootfs</font><font color="#0b5394"> </font></span></div>
</div>
</div>
<br />
<div><br />
</div>
<hr size="2" width="100%" />
<hr size="2" width="100%" />
<h2><a name="TOC-Installing-Chromium-OS-on-your-Device"></a>Installing Chromium OS on your Device</h2>
<h3><a name="TOC-Put-your-image-on-a-USB-disk"></a>Put your image on a USB disk</h3>
<h4><a name="TOC-Put-your-image-on-a-USB-disk"></a></h4>
<p>The easiest way to get your image running on your target computer is to put the image on a USB flash disk (sometimes called a USB key), and boot the target computer from the flash disk. The first step is to insert a USB flash disk (4GB or bigger) into your build computer. <b><font color="#e69138">This disk will be completely erased, so make sure it doesn't have anything important on it</font></b>.  Wait ~10 seconds for the USB disk to register, then type the following command:</p>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">cros flash usb:// ${BOARD}/latest</font></code></div>
</div>
<p>For more details on using this tool, see the <a href="build/cros-flash.html">Cros Flash page</a>. <span style="font-size:13.3333330154419px;background-color:transparent">Note that auto-mounting of USB devices should be turned off as it may corrupt the disk image while it's being written.</span></p>
<div><span style="font-size:10pt;background-color:transparent">When the </span><span style="font-size:10pt;font-family:monospace;color:rgb(153,0,255);line-height:13px;background-color:transparent">cros flash</span><span style="font-size:10pt;background-color:transparent"> command finishes, you can simply unplug your USB key and it's ready to boot from.</span></div>
<div><br />
</div>
<div><b><font color="#e69138">IMPORTANT NOTE</font></b>: To emphasize again, <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">cros flash</span> completely replaces the contents of your USB disk. Make sure there is nothing important on your USB disk before you run this command.<br />
</div>
<div><br />
</div>
<div><b>SIDE NOTES:</b>
<ul>
<li style="margin-top:0.5em">If you want to create a test image (used for allowing Chromium OS to talk to autotest), see the <a href="developer-guide.1.html#TOC-Running-Tests">Running Tests</a> section.</li>
</ul>
</div>
<h3><a name="TOC-Disable-verified-boot"></a>Disable verified boot</h3>
<p>How this is accomplished for non Google Chrome OS devices depends heavily on the BIOS and can vary drastically, so we will not attempt to cover that.</p>
<p>For Google Chrome OS devices, see the <a href="getting-dev-hardware/dev-hardware-list.1.html">Developer Hardware</a> page.</p>
<h3><a name="TOC-Boot-from-your-USB-disk"></a>Boot from your USB disk</h3>
<h4><a name="TOC-Boot-from-your-USB-disk"></a></h4>
<p>You should be able to configure your target computer's BIOS to boot from your USB key. After you've done that, simply plug in your newly minted USB key and reboot your target computer – it should now boot from the Chromium OS image on your USB key. Your Chromium OS image may not have all the drivers to run all of the peripherals on your computer, but it should at least boot.</p>
<p>For specific information about what works on various different machines, see the <a href="getting-dev-hardware/dev-hardware-list.1.html">Developer Hardware</a> page.</p>
<h3><a name="TOC-Installing-your-Chromium-OS-image-to-your-hard-disk"></a>Installing your Chromium OS image to your hard disk</h3>
<div>Once you've booted from your USB key and gotten to the command prompt, you can install your Chromium OS image to the hard disk on your computer with this command:</div>
<div><br />
</div>
<div style="color:rgb(153,0,0)">
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code style="color:rgb(153,0,0)">/usr/sbin/chromeos-install</code></div>
</div>
<div><br />
</div>
<div><b><font color="#e69138">IMPORTANT NOTE</font></b>: Installing Chromium OS onto your hard disk will <b><font color="#ff0000">WIPE YOUR HARD DISK CLEAN</font></b>.</div>
<h3><a name="TOC-Getting-to-a-command-prompt-on-Chro"></a>Getting to a command prompt on Chromium OS</h3>
<div>Since you set the shared user password (with <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">set_shared_user_password.sh</span>) when you built your image, you have the ability to login as the <span style="font-family:courier new,monospace;color:rgb(153,0,0)">chronos</span><span style="color:rgb(153,0,0)"> </span>user:<br />
<ol><li style="margin-top:0.2em">After your computer has booted to the Chromium OS login screen, press <span style="color:rgb(153,0,0)">[ Ctrl ] [ Alt ] [ F2 ]</span> to get a text-based login prompt. ( <span style="color:rgb(153,0,0)">[ F2 ] </span>may appear as <font color="#990000">[ </font><span style="font-family:verdana,arial,helvetica,code2000,sans-serif;font-size:small"><font color="#990000">→</font></span><font color="#990000"> ]</font> on your Notebook keyboard.)</li>
<li style="margin-top:0.2em">Login with the<span> </span><font face="'courier new', monospace" style="color:rgb(153,0,0)">chronos</font><span> </span>user and enter the password you set earlier.</li>
</ol>
</div>
<div>
</div>
<div>Because you built an image with developer tools, you also have an alternate way to get a terminal prompt. The alternate shell is a little nicer (in the very least, it keeps your screen from dimming on you), even if it is a little harder to get to. To use this alternate shell:</div>
<div>
<ol style="list-style-type:decimal">
<li style="margin-top:0.2em">Go through the standard Chromium OS login screen (you'll need to setup a network, etc.) and get to the web browser.  It's OK to login as guest.</li>
<li style="margin-top:0.2em">Press <span style="color:rgb(153,0,0)">[ Ctrl ] [ Alt ] [ T ]</span> to get the crosh shell.</li>
<li style="margin-top:0.2em">Use the<span> </span><code style="color:rgb(153,0,0)">shell</code><span> </span>command to get the shell prompt. NOTE: you<span> </span><b>don't</b> need to enter the <span style="font-family:courier new,monospace;color:rgb(153,0,0)">chronos</span> password here, though you will still need the password if you want to use the<span> </span><code style="color:rgb(153,0,0)">sudo</code><span> </span>command.</li>
</ol>
<br />
<hr />
<hr />
<h3><a name="TOC-Building-an-image-to-run-in-a-virtu"></a>Building an image to run in a virtual machine</h3>
<div>Many times it is easier to simply run Chromium OS in a virtual machine like <span style="font-family:monospace;color:rgb(0,96,0)">kvm</span>.  You can adapt the previously built Chromium OS image so that it is usable by <code style="color:rgb(0,96,0)">kvm</code> (which uses qemu images) by entering this command from the <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/scripts</span> directory:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./image_to_vm.sh --board=${BOARD}</font></code></div>
</div>
<br />
<div>This command creates the file <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">~/trunk/src/build/images/${BOARD}/latest/chromiumos_qemu_image.bin</span>.</div>
<div><br />
</div>
<div><b>SIDE NOTES:<br />
</b>
<ul><li style="margin-top:0.5em">Only KVM/QEMU VM's are actively supported at the moment.</li>
<li style="margin-top:0.5em">You can specify source/destination paths with the<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">--from</font></code><span> </span>and<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">--to</font></code><span> </span>parameters.</li>
<li style="margin-top:0.5em">If you're interested in creating a test image (used for allowing Chromium OS to talk to autotest), see the<span> </span><a href="developer-guide.1.html#TOC-Running-Tests" style="color:rgb(0,102,204);outline-style:none">Running Tests</a><span> </span>section.</li></ul></div>
<hr size="2" width="100%" />
<hr size="2" width="100%" />
<a name="TOC-Making-changes"></a>
<a name="TOC-Making-changes-to-a-package-whose-s"></a>
<h2><a name="TOC-Making-changes-to-packages-whose-source-code-is-checked-into-Chromium-OS-git-repositories"></a>Making changes to packages whose source code is checked into Chromium OS git repositories<br />
</h2>
<hr size="2" width="100%" />
<h3><a name="TOC-Keep-the-tree-green"></a>Keep the tree green</h3>
<div>
Now that you can build and run Chromium OS, you're ready to start making changes to the code.<br />
<br />
Before you start, take a moment to understand Chromium's source management strategy of "keeping the tree green". For the Chromium OS project, <b>keeping the tree green</b> means:<br />
</div>
<span style="font-family:arial,sans-serif;border-collapse:collapse">
<div>
<div>
<div>
<ol style="list-style-type:decimal"><li style="margin-left:15px">Any new commits should not destabilize the build:</li>
<ul><li style="margin-left:15px">Images built from the tree should always have basic functionality working.</li>
<li style="margin-left:15px">There may be minor functionality not working, and it may be the case, for example, that you will need to use Terminal to fix or work around some of the problems. 
<br />
<br />
</li></ul>
<li style="margin-left:15px">If you must introduce unstable changes to the tree (which should happen infrequently), you should use parameterization to hide new, unstable functionality behind a flag that's turned off by default. The Chromium OS team leaders may need to develop mechanisms for parameterizing different parts of the system (such as the init script).<br />
<br />
</li>
<li style="margin-left:15px">Internal "dev channel" releases will be produced directly from the tree, with a quick branch to check-point the release version. Any fixes required for a release will be pulled from the tree, avoiding merges back to tree.</li>
</ol>
</div>
</div>
</div>
</span>
<div><span style="font-family:arial,sans-serif;border-collapse:collapse"><span style="background-color:rgb(255,255,255)">This </span><span><span style="background-color:rgb(255,255,255)">strategy</span></span><span style="background-color:rgb(255,255,255)"> has
 many benefits, including avoiding separate build trains for parallel 
development (and the cost of supporting such development), as well as avoiding large, 
costly merges from forked branches.<br />
<br />
<b>SIDE NOTE</b>: "Keep the tree green" means something a bit different for Chromium OS than for Chromium, which is much further along in its life cycle.</span><span style="background-color:rgb(255,255,255)"> </span></span><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times New Roman;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px"><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times New Roman;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px">
<span style="font-family:arial,sans-serif;border-collapse:collapse">
</span></span></span></span></span><br />
</div>
<br />
<div>The steps in this section describe how to make changes to a Chromium OS package whose source is checked into the Chromium OS source control system. Specifically, this is a package where:</div>
<div>
<ul><li>The<span> </span><code style="color:rgb(0,96,0)"><b>ebuild</b></code><span> </span>for the package lives in the <code style="color:rgb(0,96,0)">src/third_party/chromiumos-overlay</code> or <code style="color:rgb(0,96,0)">src/overlays/overlay-${BOARD}</code><span> </span>directories.</li>
<li>There is an <span style="font-family:monospace;color:rgb(0,96,0)">ebuild</span> for the package that ends with<span> </span><code style="color:rgb(0,96,0)">9999.ebuild</code>.</li>
<li>The <span style="font-family:monospace;color:rgb(0,96,0)">ebuild</span> inherits from the <code style="color:rgb(0,96,0)">cros-workon</code><span> </span>class.</li>
<li>The <span style="font-family:monospace;color:rgb(0,96,0)">ebuild</span> has a<span> </span><code style="color:rgb(0,96,0)">KEYWORDS</code><span> </span>in the ebuild containing this architecture name (like "<code style="color:rgb(0,96,0)">x86</code>").</li></ul>
You can see a list of all such packages by running the following command from inside the <span style="font-family:monospace;color:rgb(153,0,255)">~/trunk/src/scripts</span> directory:</div>
<br />
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon --board=${BOARD} list --all <br />
</font></code></div>
</div>
<div>
<br />
<hr size="2" width="100%" />
<h3><a name="TOC-Run-cros_workon-start"></a>Run cros_workon start</h3>
</div>
<div>The first thing you need to do is to mark the package as active. Use the command below, replacing <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">${PACKAGE_NAME}</span> with your package name (e.g., <code style="color:rgb(0,96,0)"><font color="#9900ff">chromeos-wm</font></code>):</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon --board=${BOARD} start ${PACKAGE_NAME}</font></code></div>
</div>
<br />
<div>This command:</div>
<div>
<ul><li>Indicates that you'd like to build the<span> </span><code style="color:rgb(0,96,0)">9999</code><span> </span>version of the<span> </span><code style="color:rgb(0,96,0)">ebuild</code> instead of the stable, committed version.</li>
<li>Indicates that you'd like to build from source every time.</li>
<li>If you specified that you wanted the<span> </span><code style="color:rgb(0,96,0)">minilayout</code><span> </span>when you did your<span> </span><code style="color:rgb(0,96,0)">repo init</code>, this command adds a clause to your<span> </span><code style="color:rgb(0,96,0)">.repo/local_manifest.xml</code><span> </span>to tell<span> </span><code style="color:rgb(0,96,0)">repo</code><span> </span>to sync down the source code for this package next time you do a<span> </span><code style="color:rgb(0,96,0)">repo sync</code>.</li></ul>
<br />
<hr size="2" width="100%" />
<a name="TOC-repo-sync"></a>
<h3><a name="TOC-Run-repo-sync"></a>Run repo sync</h3>
</div>
<div>After running <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">cros_workon</span>, sync down the sources. This is critical if you're using the<span> </span><code style="color:rgb(0,96,0)">minilayout</code>, but is probably a good idea in any case to make sure that you're working with the latest code (it'll help avoid merge conflicts later).  Run the command below from outside the chroot, anywhere under your <code style="color:rgb(0,96,0)">~/chromiumos</code><span> </span>directory:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">repo sync</code></div>
</div>
<div>
<div><br />
</div>
<div><br />
<hr size="2" width="100%" />
<h3><a name="TOC-Figure-out-where-the-ebuild-source-"></a>Find out which ebuilds map to which directories<br />
</h3>
</div>
<div>The <font color="#9900ff" face="monospace">cros_workon</font> tool can help you find out what ebuilds map to each directory. You can view a full list of ebuilds and directories using the following command:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><font color="#9900ff"><code><font color="#9900ff">cros_workon info --board=${BOARD} --all</font></code></font></div>
<br />
</div>
<div>If you want to find out which ebuilds use source code from a specific directory, you can use grep to find them. For example:</div>
</div>
<div><br />
</div>
<div>
<div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><font color="#9900ff"><code><font color="#9900ff">cros_workon info --board=${BOARD} --all | grep platform/ec</font></code></font></div>
<br />
</div>
<div>This returns the following output:</div>
<div>
<div><font color="#9900ff" face="monospace"><span>    c</span>hromeos-base/ec-utils chromiumos/platform/ec src/platform/ec</font></div>
<div></div>
</div>
</div>
<div><br />
</div>
<div>This tells you the following information:</div>
<div>
<ol><li>The name of the ebuild is <span style="color:rgb(153,0,255);font-family:monospace">chromeos-base/ec-utils</span></li>
<li><span style="color:rgb(153,0,255);font-family:monospace"><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">The path to the git repository on the server is </span></span><span style="color:rgb(153,0,255);font-family:monospace">chromiumos/platform/ec</span></li>
<li><span style="color:rgb(153,0,255);font-family:monospace"><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">The path to the source code on your system is </span></span><span style="color:rgb(153,0,255);font-family:monospace">src/platform/ec</span></li>
</ol>
<div>
<div>You can similarly find what source code is associated with a given ebuild by grepping for the ebuild name in the list.</div>
<div><br />
</div>
<div>To find out where the ebuild lives:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code><font color="#9900ff">equery-${BOARD} which</font></code><span style="font-family:monospace;color:rgb(153,0,255)"> ${PACKAGE_NAME}</span></div>
</div>
<div><br />
</div>
<div>As an example, for <span style="font-family:monospace;line-height:13px"><font color="#9900ff">PACKAGE_NAME=ec-utils</font></span>, the above command might display:<br />
    <code><font color="#9900ff">/home/.../trunk/src/third_party/chromiumos-overlay/chromeos-base/ec-utils/ec-utils-9999.ebuild</font></code></div>
<div><br />
</div>
<div><b>SIDE NOTE:</b> If you run the same command <b>without</b> running cros_workon first, you can see the difference:</div>
<div>    <code><font color="#9900ff">/home/.../trunk/src/third_party/chromiumos-overlay/chromeos-base/ec-utils/ec-utils-0.0.1-r134.ebuild</font></code></div>
<div><font color="#006000" face="monospace"><br />
</font></div>
</div>
</div>
<hr size="2" width="100%" />
<h3><a name="TOC-Create-a-branch-for-your-changes"></a>Create a branch for your changes</h3>
<div>Since Chromium OS uses<span> </span><code style="color:rgb(0,96,0)">repo</code>/<code style="color:rgb(0,96,0)">git</code>, you should always create a local branch whenever you make changes.<br />
<br />
First, find the source directory for the project you just used <span style="color:rgb(153,0,255);font-family:monospace">cros_workon</span> on. This isn't directly related to the project name you used with <span style="color:rgb(153,0,255);font-family:monospace">cros_workon</span>. (This isn't very helpful - someone with more experience, actually tell us how to find it reliably? --Meredydd)</div>
<div><br />
</div>
<div>cd into that directory, in particular the "<span style="color:rgb(153,0,255);font-family:monospace">files/</span>" directory in which the actual source resides. In the command below, replace <span style="font-family:monospace;color:rgb(0,96,0);line-height:13px">${BRANCH_NAME}</span> with a name that is meaningful to you and that describes your changes (nobody else will see this name):</div>
<div>
<div>
<br />
</div>
</div>
<div>
<div>
<div><font style="background-color:rgb(204,204,204)"><font color="#9900ff">
</font>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:16px"><code><font color="#9900ff">repo start ${BRANCH_NAME} .</font></code></div>
</font></div>
</div>
</div>
<p>The branch that this creates will be based on the remote branch (which one? --Meredydd). If you've made any other local changes, they will not be present in this branch.</p>
<div>
<hr size="2" width="100%" />
<h3><a name="TOC-Make-your-changes"></a>Make your changes</h3>
</div>
<p>You should be able to make your changes to the source code now.  To incrementally compile your changes, use </p>
<div><font color="#9900ff" face="'courier new', monospace">
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff" size="3">cros_workon_make --board=${BOARD} ${PACKAGE_NAME}</font></code></div>
</font></div>
<p>This will build your package inside your source directory.  Change a single file, and it will rebuild only that file and re-link.  If your package contains test binaries, using</p>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon_make --board=${BOARD} ${PACKAGE_NAME} --test</font></code></div>
</div>
<p>will build and run those binaries as well.  Call<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon_make --help</font></code><span> </span>to see other options that are supported.</p>
<div>
<p>You probably want to get your changes onto your device now.  You need to install the changes you made by using </p>
</div>
<div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code><font color="#9900ff">cros_workon_make --board=${BOARD} ${PACKAGE_NAME} --install</font></code></div>
</div>
</div>
<p><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif">You can then rebuild an image with </span><code>build_image</code> and reimage your device, but you might also want to take a peek at <a href="build/cros-deploy.html"><code>cros deploy</code></a><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"> if you want something a little quicker.</span></p>
<hr size="2" width="100%" />
<h3><a name="TOC-Set-your-editor"></a>Set your editor</h3>
<div>Many of the commands below (in particular <code style="color:rgb(0,96,0)">git</code>) open up an editor. You probably want to run one of the three commands below depending on your favorite editor.  <br />
</div>
<br />
<div>If you're not a *nix expert,<span> </span><code style="color:rgb(0,96,0)">nano</code><span> </span>is a reasonable editor:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">export EDITOR='nano'</code></div>
</div>
<br />
<div>If you love<span> </span><code style="color:rgb(0,96,0)">vi</code>:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">export EDITOR='vi'</code></div>
</div>
<br />
<div>If you love<span> </span><code style="color:rgb(0,96,0)">emacs</code><span> </span>(and don't want an XWindow to open up every time you do something):</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">export EDITOR='emacs -nw'</code></div>
</div>
<div><br />
</div>
<div>You should probably add one of those lines to your<span> </span><code style="color:rgb(0,96,0)">.bashrc</code><span> </span>(or similar file) too.</div>
<div><br />
</div>
<hr size="2" width="100%" />
<h3><a name="TOC-Submit-changes-locally"></a>Submit changes locally</h3>
<div>When your changes look good, commit them to your local branch using<span> </span><code style="color:rgb(0,96,0)">git</code>. Full documentation of how to use <span style="font-family:monospace;color:rgb(0,96,0)">git</span> is beyond the scope of this guide, but you might be able to commit your changes by running something like the command below from the project directory:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">git commit -a</code></div>
</div>
<br />
<div>The <span style="font-family:monospace;color:rgb(0,96,0)">git</span> commit command brings up a text editor. You should describe your changes, save, and exit the editor. Note that the description you provide is only for your own use. When you upload your changes for code review, the<span> <font color="#006000" face="monospace">repo upload</font></span><span> </span>command grabs all of your previous descriptions, and gives you a chance to edit them.</div>
<div><br />
</div>
<hr size="2" width="100%" />
<a name="TOC-Upload-your-changes-and-get-a-code-"></a>
<h3><a name="TOC-Upload-your-changes-and-get-a-code-review"></a>Upload your changes and get a code review<br />
</h3>
<div>Once your changes are committed locally, upload your changes using <font color="#006000" face="monospace">repo upload</font>. The <font color="#006000" face="monospace">repo upload</font> command takes all of the changes that are unmerged and asks them if you want to upload them.  You can specifically say to only look for unmerged changes in your current repo by passing in '.'.  Please note that you must have a <a href="developer-guide/gerrit-guide.1.html">Gerrit account</a> before you can upload changes.</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><font color="#006000" face="monospace">repo upload [.|project-name] [--current-branch]</font></div>
</div>
<div><br />
It is important to note that repo uses the Change-Id in your git commits to track code reviews.  So in order to work on a CL the standard work flow is to use <code>git commit --amend</code> rather than make a new commit.  This differs from our old <code>git-cl</code> style.</div>
<div><br />
</div>
<div><img border="0" height="85" src="https://sites.google.com/a/chromium.org/dev/_/rsrc/1291311476547/chromium-os/developer-guide/TrackerName.png?height=85&amp;width=320" style="display:inline;float:right;margin:5px 10px" width="320" />In your local commit logs make sure to add a <span style="font-family:monospace;color:rgb(0,96,0);line-height:13px">BUG=</span><span style="font-family:monospace;line-height:13px"> </span><span style="line-height:13px"><font face="arial, sans-serif">field and </font></span><span style="font-family:monospace;color:rgb(0,96,0);line-height:13px">TEST=</span><font face="arial, sans-serif"><span style="line-height:13px"> field.</span>  For </font><span style="font-family:monospace;color:rgb(0,96,0);line-height:13px">BUG=</span>, you should put something that looks like:<span> </span><code style="color:rgb(0,96,0)">BUG=bug-tracker:number</code>.  You can get a tracker name by looking in the upper-left corner of the tracker page (e.g. in the image on the right, the tracker name is "chromium-os"). If your changes are related to more than one tracker issue, you can list all the issues separated with commas.</div>
<div><br />
</div>
<div>For <span style="font-family:monospace;color:rgb(0,96,0);line-height:13px">TEST=</span>, you should describe what you did to test the changes.</div>
<div><br />
</div>
<div>Here's what a sample description should look like:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div>
<div><code style="color:rgb(0,96,0)"># Enter a description of the change.</code></div>
<div><code style="color:rgb(0,96,0)"># This will displayed on the codereview site.</code></div>
<div><code style="color:rgb(0,96,0)"># The first line will also be used as the subject of the review.</code></div>
<div><code style="color:rgb(0,96,0)">Here's a SHORT, one-line summary of my change.</code></div>
<div><br />
</div>
<div><code style="color:rgb(0,96,0)">And here are more details</code></div>
<div><code style="color:rgb(0,96,0)">...this can be as long as I want.</code></div>
<div><br />
</div>
<div><code style="color:rgb(0,96,0)">BUG=chromium-os:99999, chromium:88888</code></div>
<div><code style="color:rgb(0,96,0)">TEST=Ran all the white box tests</code></div>
<div><code style="color:rgb(0,96,0)"><br />
</code></div>
<div><font color="#006000" face="monospace"><span style="font-size:12px;color:rgb(0,0,0);line-height:normal"><code>Change-Id: I8d7f86d716f1da76f4c85259f401c3ccc9a031ff</code><br />
</span></font></div>
</div>
</div>
<div>Once you run <code>repo upload</code>, this uploads the changes and prints out a URL for the code review (if it's a new code review). Go to that URL (log in with your chromium.org account, which you might want to do in an "incognito" window in Chrome), and use the "<b>Review-&gt;Publish Comments</b>" link to mail your changes to your reviewers.</div>
<div><br />
</div>
<div>You should pick reviewers that know the code you're working on well and that will do the best reviews. Picking reviewers who will just rubber-stamp your changes is a bad idea. The point of submitting changes is to submit good code, not to submit as much code as you can. If you don't know who should review your changes, start by looking at the<span> </span><code style="color:rgb(0,96,0)">git log</code><span> </span>for the project that you're working on. Simply type the command below in a directory related to your project:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">git log</code></div>
</div>
<div><br />
</div>
<div><br />
</div>
<div>Your reviewers will likely provide comments about changes that you should make before submitting your code. You should make such changes, submit them locally, and then re-upload your changes for code review by amending your changes to your git commit and re-running repo upload.</div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code># make some changes</code></div>
<div><code>git add -u .</code></div>
<div><code>git commit --amend</code></div>
<div></div>
</div>
<br />
<div>If you have a chain of commits (which <code>repo upload .</code> converts to a chain of CLs), and you need to modify any commits that are not at the top of the chain, use interactive rebase:
</div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>git rebase -i</code></div>
<div><code># This shows a list of cherry-picks into a temporary branch.</code></div>
<div><code># Change some of the "pick" keywords to "edit".  Then exit the editor.</code></div>
<div><code>git log # shows you are at the first "edit"ed commit.  All earlier commits are cherry-picked.</code></div>
<div><code># Make some modifications.</code></div>
<div><code>git add -u .</code></div>
<div><code>git commit --amend</code></div>
<div><code>git rebase --continue # goes to the next "edit"ed commit.</code></div>
<div><code>repo upload . --current-branch # when all modifications are ready to be uploaded again.</code></div>
</div>
<div><br />
</div>
<hr size="2" width="100%" />
<h3><a name="TOC-Try-seeing-the-mainline-again"></a>Try seeing the mainline again</h3>
<div>While you're working on your changes, you might want to go back to the mainline for a little while (maybe you want to see if some bug you are seeing is related to your changes, or if the bug was always there). If you want to go back to the mainline without abandoning your changes, you can run the following command from within a directory associated with your project:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">git checkout cros/master</code></div>
</div>
<br />
<div>When you're done, you can get back to your changes by running:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">git checkout ${BRANCH_NAME} </code></div>
</div>
<br />
<hr size="2" width="100%" />
<h3><a name="TOC-Work-on-something-else-while-you-re-waiting"></a>Work on something else while you're waiting</h3>
<div>If you want to start on another (unrelated) change while waiting for your code review, you can <code style="color:rgb(0,96,0)">repo start</code> another branch. When you want to get back to your first branch, run the following command from within a directory associated with your project:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">git checkout ${BRANCH_NAME}</code><code style="color:rgb(0,96,0)"> </code></div>
</div>
<div><br />
</div>
<hr size="2" width="100%" />
<h3><a name="TOC-Send-your-changes-to-the-Commit-Queue"></a>Send your changes to the Commit Queue</h3>
<div>
<div>Eventually, all your reviewers will be happy and will give you a Looks Good and Approved (the latter is only available to owners of the code) message in Gerrit.  When a reviewer is satisfied with the CL but wants other reviewers to approve they may give a +1. If they choose to test it they can also mark Verified but typically you'll need to test the CL and mark Verified yourself.  Both Looks Good and Approved (+2) and Verified must be set in order to commit your CL.  Once they are set, set the Commit Ready bit on your CL and the commit queue will test the change.</div>
<div><br />
</div>
<div>Before the Commit Queue picks up your CL it must pass a pre-CQ trybot.  This trybot run is triggered automatically when your CL is marked Looks Good and Approved.  You can trigger this trybot earlier by checking 'Trybot-Ready' and, if the run passes, it will not be required again before the Commit Queue picks up the CL.</div>
</div>
</div>
<div><br />
</div>
<div>Note it is possible that your change will be rejected because of a merge conflict.  If it is, rebase against any new changes and re-upload your patch.  This patch will have to be re-approved before it is allowed to be committed. (Note: If it's just a trivial rebase, you can approve the rebase yourself.)</div>
<div><br />
</div>
<div>More details on the Commit Queue can be found in the <a href="../developers/tree-sheriffs/sheriff-details-chromium-os/commit-queue-overview.1.html">Commit Queue Overview</a>.</div>
<div>
<div>
<div>
<br />
</div>
<hr size="2" width="100%" />
<a name="TOC-Making-sure-your-change-didn-t-brea"></a>
<h3><a name="TOC-Make-sure-your-changes-didn-t-break-things"></a>Make sure your changes didn't break things</h3>
<div>After you commit, make sure you didn't break the build by checking the <a href="http://build.chromium.org/buildbot/chromiumos" style="color:rgb(0,102,204);outline-style:none">buildbot</a>.<br />
</div>
</div>
<div><br />
</div>
<div>
<hr size="2" width="100%" />
<a name="TOC-Cleaning-up-after-you-re-done-with-"></a>
<h3><a name="TOC-Share-your-changes-using-the-Gerrit-sandbox"></a>Share your changes using the Gerrit sandbox</h3>
</div>
<div>
<div style="font-family:arial;font-size:small">It is possible to upload changes to a personal sandbox on Gerrit. This way, a change can be shared between developers before it is ready for code review.</div>
</div>
<div style="font-family:arial;font-size:small"><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block"><font color="#006000" face="monospace">project_url=https://chromium.googlesource.com/$(git config remote.cros.projectname)<br />
</font><span style="color:rgb(0,96,0);font-family:monospace">git push ${project_url} HEAD:refs/sandbox/</span><code>${USER}</code><span style="color:rgb(0,96,0);font-family:monospace">/</span><code>${BRANCH_NAME}</code></div>
<div style="font-family:Arial,Verdana,sans-serif;font-size:13px"><br />
</div>
</div>
<div style="font-family:Arial,Verdana,sans-serif;font-size:13px"><span style="line-height:18px;font-family:sans-serif;font-size:small">Other developers can then fetch your changes using the following commands:</span></div>
</div>
<div class="sites-codeblock sites-codesnippet-block">
<div><span style="color:rgb(0,96,0);font-family:monospace">project_url=https://chromium.googlesource.com/$(git config remote.cros.projectname)</span></div>
<div><code>git fetch ${project_url} refs/sandbox/${USER}/${BRANCH_NAME}</code><br />
<code> git checkout FETCH_HEAD </code></div>
</div>
<br />
<div>
<div>
<div style="font-size:small"><font face="sans-serif"><span style="line-height:18px">In a given repository, you can explore sandboxes using the ls-remote command:</span></font></div>
<div style="font-size:small"><font face="sans-serif"><span style="line-height:18px"><br />
</span></font></div>
<div style="font-size:small">
<div style="font-size:13px">
<div style="font-family:arial;font-size:small">
<div class="sites-codeblock sites-codesnippet-block" style="line-height:13px;color:rgb(0,96,0);font-family:monospace;font-size:13px">git ls-remote cros "refs/sandbox/${USER}/*"<br />
git ls-remote cros "refs/sandbox/*"<br />
</div>
<div><br />
</div>
</div>
</div>
</div>
</div>
</div>
<div>Once you're finished with a sandbox, you can delete it using the following commands:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block"><span style="color:rgb(0,96,0);font-family:monospace">project_url=https://chromium.googlesource.com/$(git config remote.cros.projectname)</span><font color="#006000" face="monospace"><br />
</font><span style="color:rgb(0,96,0);font-family:monospace">git push $project_url :refs/sandbox/</span><code>${USER}</code><span style="color:rgb(0,96,0);font-family:monospace">/</span><code>${BRANCH_NAME}</code></div>
<div><br />
</div>
</div>
<hr size="2" width="100%" />
<a name="TOC-Cleaning-up-after-you-re-done-with-"></a>
<h3><a name="TOC-Clean-up-after-you-re-done-with-your-changes"></a>Clean up after you're done with your changes</h3>
<div>After you're done with your changes, you're ready to clean up. The most important thing to do is to tell<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon</font></code><span> </span>that you're done by running the following command:</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon --board=${BOARD} stop ${PACKAGE_NAME}</font></code></div>
</div>
<div><br />
</div>
<div>This command tells <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">cros_workon</span> to stop forcing the<span> </span><code style="color:rgb(0,96,0)">-9999.ebuild</code><span> </span>and to stop forcing a build from source every time.</div>
<div><br />
</div>
<div>You can also delete the branch that repo created. There are a number of ways to do so; here is one way:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">repo abandon ${BRANCH_NAME} ${CROS_WORKON_PROJECT}</code></div>
</div>
<div><br />
</div>
<div><br />
</div>
<div><b>SIDE NOTES:</b><br />
<ul><li style="margin-top:0.5em">If you don't specify a project name, the<span> </span><code style="color:rgb(0,96,0)">repo abandon</code><span> </span>command will throw out any local changes across<span> </span><b>all projects</b>. You might also want to look at<span> </span><code style="color:rgb(0,96,0)">git branch -D</code><span> </span>or<span> </span><code style="color:rgb(0,96,0)">repo prune</code>.</li>
<li style="margin-top:0.5em">If you're using the<span> </span><code style="color:rgb(0,96,0)">minilayout</code>, doing a <span style="font-family:monospace;color:rgb(153,0,255)">cros_workon stop</span> <b>will not</b> remove your source code. The code will continue to stay on your hard disk and get synced down.</li></ul>
</div>
<hr />
<div>
</div>
<div>
<hr size="2" width="100%" />
<a name="TOC-Making-changes-to-something-other-t"></a>
<h2><a name="TOC-Making-changes-to-non-cros_workon-able-packages"></a>Making changes to non-cros_workon-able packages</h2>
</div>
<div>If you want to make to changes to something other than packages whose source is checked into the Chromium OS source control system, you can follow the instructions in the previous section, but skip the<span> </span><code style="color:rgb(0,96,0)"><font color="#9900ff">cros_workon</font></code><span> </span>step. Note specifically that you still need to run<span> </span><code style="color:rgb(0,96,0)">repo start</code><span> </span>to <a href="developer-guide.1.html#TOC-Create-a-branch-for-your-changes">create a branch for your changes</a>.</div>
<div><br />
</div>
<div>The types of changes that fall into this category include:<br />
</div>
<div>
<ul><li>changes to build scripts (pretty much anything in<span> </span><code style="color:rgb(0,96,0)">src/scripts</code>)</li>
<li>changes to<span> </span><code style="color:rgb(0,96,0)">ebuild</code><span> </span>files themselves (like the ones in<span> </span><code style="color:rgb(0,96,0)">src/third_party/chromiumos-overlay</code>)<br />
</li><ul><li>To change these files, you need to "manually uprev" the package. For example, if we're making a modification to for the Pixel overlay (link), then </li><li><font color="#38761d">cd src/overlays/overlay-link/chromeos-base/chromeos-bsp-link</font></li><li><font color="#38761d">mv chromeos-bsp-link-0.0.2-r29.ebuild chromeos-bsp-link-0.0.2-r30.ebuild</font></li><li><span style="font-size:13.3333330154419px">chromeos-bsp-link-0.0.2-r29.ebuild is a symlink that points to </span><span style="font-size:13.3333330154419px">chromeos-bsp-link-0.0.2.ebuild. To uprev the package, simply increment the revision (r29) number.</span></li></ul>
<li>adding small patches to existing packages whose source code is NOT checked into Chromium OS git repositories</li>
<li>changes to <font face="'courier new', monospace"><code>eclass</code></font> files (like the ones in<span> </span><code style="color:rgb(0,96,0)">src/third_party/chromiumos-overlay/eclass</code>)</li>
<li>changes to the buildbot infrastructure (in <code>crostools</code>)</li>
<li><font color="#ff0000">TODO: anything else?</font></li></ul>
<div>
<hr />
</div>
<div></div>
<h3><a name="TOC-Adding-small-patches-to-existing-packages"></a><b><font size="3">Adding small patches to existing packages</font></b></h3>
<div><font size="2">When you need to add small patches to existing packages whose source code is not checked into a Chromium OS git repository (e.g. it comes from portage, and is not a <font color="#9900ff" face="'courier new', monospace">cros_workon</font>-able package), you need to do the following:</font></div>
<div><font size="2"><br />
</font></div>
<div><span style="font-size:small">First,</span><span style="font-size:small"> f</span><font size="2">ind the package ebuild file under <font color="#274e13" face="'courier new', monospace">third_party/chromiumos-overlay</font><font face="arial, sans-serif">.</font></font></div>
<div><font size="2"><font face="arial, sans-serif"><br />
</font></font></div>
<div><font size="2">Then, create a patch file from the exact version of the package that is used by the current ebuild.  If other patches are already in the ebuild, you'll want to add your patch LAST, and build the patch off of the source that has already had the existing patches applied (either do it by hand, or set FEATURES=noclean and build your patch off of the temp source).  Note that patch order is significant, since the ebuild expects each patch line number to be accurate after the previous patch is applied.</font></div>
<div><font size="2"><br />
</font></div>
<div><font size="2">Place your patch in the "<font color="#274e13" face="'courier new', monospace">files</font>" subdir of the directory that contains the ebuild file (e.g. <font color="#274e13" face="'courier new', monospace">third_party/chromiumos-overlay/dev-libs/mypackage/files/mypackage-1.0.0-my-little-patch.patch</font>).</font></div>
<div><font size="2"><br />
</font></div>
<div><span style="font-family:arial,sans-serif;font-size:small">Then, in the prepare() section of the ebuild (create one if it doesn't exist), add an epatch line:</span></div>
<div><font size="2"><font face="arial, sans-serif"><br />
</font></font></div>
<div><font color="#274e13" face="'courier new', monospace" size="2">epatch "${FILESDIR}"/${P}-my-little-patch.patch</font></div>
<div><font color="#274e13" face="'courier new', monospace" size="2"><br />
</font></div>
<div><font face="arial, sans-serif" size="2">Lastly, you'll need to bump the revision number in the name of the ebuild file (or symlink) so the build system picks up the change.  The current wisdom is that the ebuild file should be symlinked instead of being renamed.  For example, if the original ebuild file is "</font><span style="color:rgb(39,78,19);font-family:courier new,monospace;font-size:small">mypackage-1.0.0.ebuild</span><span style="font-family:arial,sans-serif;font-size:small">", you should create a</span><font face="arial, sans-serif" size="2"> "</font><span style="font-size:small;color:rgb(39,78,19);font-family:courier new,monospace">mypackage-1.0.0-r1.ebuild</span><span style="font-size:small;font-family:arial,sans-serif">"</span><span style="font-family:arial,sans-serif;font-size:small"> symbolic link that points at the original ebuild file.  If that symlink already exists, create the next higher "rN" symlink.</span></div>
</div>
<div><font color="#ff0000">
<hr />
</font></div>
<h3><a name="TOC-Making-changes-to-the-way-that-the-" style="color:rgb(0,102,204);outline-style:none"></a>Making changes to the way that the chroot is constructed</h3>
<div><span style="color:rgb(255,0,0)">TODO:</span> <span style="color:rgb(255,0,0)">This section is currently a placeholder, waiting for someone to fill it in.</span>  However, a few notes:</div>
<div>
<ul><li style="margin-top:0.5em">Many of the commands that take a<span> </span><code style="color:rgb(0,96,0)">--board=${BOARD}</code><span> </span>parameter also take a<span> </span><code style="color:rgb(0,96,0)">--host</code><span> </span>parameter, which makes the commands affect the host (i.e. the chroot) rather than the board.</li>
<ul><li style="margin-top:0.3em">Most notably,<span> </span><code style="color:rgb(0,96,0)">cros_workon --host</code><span> </span>says that you want to build a package used in the chroot from source.</li></ul></ul>
</div>
<div>
<div><br />
</div>
<div>
<hr />
</div>
<h3><a name="TOC-Building-an-individual-package"></a>Building an individual package</h3>
<div><font color="#ff0000">TODO: Document this better, and add the new cros_workon_make.</font></div>
<div><br />
</div>
<div>
<div><span style="font-size:16px"><b><font size="3"><span style="font-size:13px;font-weight:normal"><b>SIDE NOTE:</b>To build an individual portage package, for a particular board, use <code style="color:rgb(0,96,0)"><font color="#9900ff">emerge-${BOARD}</font></code>.</span></font></b></span></div>
<div><span style="font-size:16px"><b><font size="3"><span style="font-size:13px;font-weight:normal">For example, if you want to build dash to test on your device:</span></font></b></span></div>
<div>
<div><br />
</div>
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff">emerge-${BOARD} dash</font></code></div>
</div>
</div>
<div><br />
</div>
<div>To install the package to the device, see <code><a href="build/cros-deploy.html">cros deploy</a></code>.<br />
<br />
</div>
<div>
<hr />
</div>
<h3><a name="TOC-Making-changes-to-the-Chromium-web-"></a>Making changes to the Chromium web browser on Chromium OS</h3>
<div>If you just want to make modifications to the Chromium web browser and quickly deploy your changes to an already-built Chromium OS image, see <a href="how-tos-and-troubleshooting/building-chromium-browser.1.html" style="color:rgb(0,102,204);outline-style:none">Making changes to the Chromium web browser on Chromium OS</a>.<br />
<br />
</div>
<div>To use your local checkout of the Chromium source code when building a Chromium OS image, set the <code>--chrome_root</code> flag appropriately when entering the chroot, e.g.</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>cros_sdk --chrome_root=${HOME}/chrome</code></div></div><div><br /></div><div>Within the chroot, you'll also need to either start working on the <code>chromeos-chrome</code> package:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>cros_workon --board=${BOARD} start chromeos-chrome</code></div></div><div><br /></div><div>or set the <code>CHROME_ORIGIN</code> environment variable appropriately:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>export CHROME_ORIGIN=LOCAL_SOURCE</code></div></div><div><br /></div><div>See <code>src/third_party/chromiumos-overlay/chromeos-base/chromeos-chrome/chromeos-chrome-9999.ebuild</code> for additional possible values for the <code>CHROME_ORIGIN</code> variable.</div><div><br /></div><div>If you have an internal checkout of the Google Chrome source and want to build the browser with official branding, export <code>USE=chrome_internal</code>.</div><div><br /></div>
<div>
<div>
<hr size="2" width="100%" />
<hr />
<h2><a name="TOC-Using-Clang-to-get-better-compiler-diagnostics"></a><span><font size="4">Using Clang to get better compiler diagnostics</font></span></h2>
<div>
<div><br />
<hr />
</div>
<h3><a name="TOC-Description"></a><font size="3">Description</font></h3>
</div>
<div>The ChromeOS toolchain provides a feature to get Clang syntax-only compiler diagnostics without having to do a separate build with the Clang compiler. To enable this feature, add '-clang' to the C[XX]FLAGS used by the package for its build. </div>
<div><br />
</div>
<div>Addition of the '-clang' option to the build is interpreted by the compiler driver wrapper script, which then invokes Clang with -fsyntax-only option, and after a successful Clang run, invokes the gcc compiler. Any errors generated by Clang will stop compilation just like a regular build does. In addition to Clang warnings, you will also see warning from gcc, in some cases for the same source construct. </div>
<div><br />
</div>
<div>The presence of a few specific gcc options, for example, '-print-*' or '-E' will disable a clang run, even if '-clang' is specified. This is to allow package configure scripts to run correctly even in the presence of the '-clang' option. </div>
<div><br />
</div>
<div>
<div><br />
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob"></a>
<h3><a name="TOC-Wrapper-Options"></a>Wrapper Options</h3>
</div>
<div><br />
</div>
<div>The wrapper script also interprets a few other options. All options specific to the wrapper only are tabulated below:</div>
<div><br />
</div>
<div>
<table border="1" bordercolor="#888" cellspacing="0" style="border-collapse:collapse;border-top-color:rgb(136,136,136);border-right-color:rgb(136,136,136);border-bottom-color:rgb(136,136,136);border-left-color:rgb(136,136,136);border-top-width:1px;border-right-width:1px;border-bottom-width:1px;border-left-width:1px">
<tbody>
<tr>
<td style="text-align:center;width:190px;height:15px"><b> Option</b></td>
<td style="text-align:center;width:749px;height:15px"><b>Description</b></td>
</tr>
<tr>
<td style="width:190px;height:31px"> <font face="'courier new', monospace">-clang</font></td>
<td style="width:749px;height:31px"><font face="'courier new', monospace">Invoke Clang front-end with -fsyntax-only and all other options specified on the command line. On successful completion of Clang compile, continue the build with gcc or g++. <br />
The presence of '-print-*', '-dump*', '@*', '-E', '-' or '-M' will disable clang invocation. </font></td>
</tr>
<tr>
<td style="width:190px;height:30px"><font face="'courier new', monospace"> -Xclang-only=&lt;option&gt;</font></td>
<td style="width:749px;height:30px"><font face="'courier new', monospace">This is a special option that can be used to pass &lt;option&gt; to Clang and not to gcc or g++. This can be used, for example, to turn off a specific Clang warning.<br />
Example: -Xclang-only=-Wno-c++11-extensions will add -Wno-c++11-extensions to the Clang invocation.</font></td>
</tr>
<tr>
<td style="width:190px;height:15px"><font face="'courier new', monospace">-print-cmdline</font></td>
<td style="width:749px;height:15px"><font face="'courier new', monospace">In addition to doing the builds, print the exact command-line used for both Clang and gcc. </font></td>
</tr>
</tbody>
</table>
<br />
</div>
<div>
<div><br />
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob"></a>
<h3><a name="TOC-Testing"></a>Testing</h3>
</div>
<div>You can test your package with Clang before adding '-clang' to your ebuild or Makefiles using the CFLAGS or CXXFLAGS variable. While using this, you need to be careful not to overwrite existing CFLAGS or CXXFLAGS. Here's an example: </div>
<div><br />
</div>
<div>
<div style="line-height:13px;background-color:rgb(239,239,239)"><code><font color="#9900ff">(cr) $ CFLAGS="$(portageq-$board envvar CFLAGS) -clang" CXXFLAGS="$(portageq-$board envvar CXXFLAG) -clang" emerge-$board chromeos-chrome</font></code></div>
</div>
<div><code><br />
</code></div>
<div>After your package builds cleanly with Clang, you can add '-clang' to your e-build. </div>
<div><br />
</div>
</div>
<hr size="2" width="100%" />
<hr />
<h2><a name="TOC-Local-Debugging"></a>Local Debugging</h2>
<div>
<div><br />
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob"></a>
<h3><a name="TOC-Debugging-both-x86-and-non-x86-binaries-on-your-workstation."></a>Debugging both x86 and non-x86 binaries on your workstation.</h3>
If you build your projects incrementally, write unit tests and use them to drive your development, you may want to debug your code without shipping it over to a running device or VM.</div>
<div><br />
</div>
<div>gdb-${BOARD} sets up gdb in your board sysroot and ensures that gdb is using the proper libraries, debug files, etc. for debugging, allowing you to run your target-compiled binaries. </div><div><span style="font-size:13.3333330154419px">It should already be installed in your chroot.  If you do not have the script, update your repository to get the latest changes, then re-build your packages:</span><br style="font-size:13.3333330154419px" /><br style="font-size:13.3333330154419px" /><div style="font-size:13.3333330154419px"><div><div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code>repo sync</code><br /><br /><code><font color="#9900ff">./build_packages --board=...<br /></font></code></div></div><br />This should install gdb-${BOARD} in the /usr/local/bin directory inside the chroot.   These board-specific gdb wrapper scripts correctly handle <u><i>both local and remote debugging</i></u> (see next section for more information on remote debugging).  When used for local debugging, these scripts will run inside a special chroot-inside-your-chroot, rooted in the board's sysroot. For example if you are using gdb-lumpy, it will run inside a chroot based entirely in your /build/lumpy sysroot.  <i><u>The libraries that it will load and use are the libraries in the sysroot</u>,</i> i.e. the target libraries for the board; the gdb binary it will use is the gdb  binary in that tree.  While debugging with gdb-lumpy (for local debugging), you will not be able to see/access any files outside of the /build/lumpy tree.  While for the most part this is very good, as it ensures the correct debugging environment, it does mean that if you want to use this script to debug a lumpy binary, such as a unit test, that you built outside of the /build/lumpy tree, you will need to copy the binary to the /build/lumpy tree first.  Also, if you want the debugger to be able to see the source files when debugging, you will need to make sure they exist inside the /build/lumpy tree as well (see example below).</div></div><div style="font-size:13.3333330154419px"><br /></div><div>IMPORTANT NOTE <span style="font-size:10pt;background-color:transparent">1:  Local and remote debugging functionality are combined in this single script.  Some of the options shown below only work for remote debugging.</span></div>
<div>
<div><br /></div><div>IMPORTANT NOTE 2:  When doing local debugging of x86 binaries, they will try to execute on your desktop machine (using the appropriate libraries and gdb binaries).  It is possible that for some x86 boards, the binaries may use instructions not understood by your hardware (particularly some vector instructions), in which case you will need to do remote debugging with the actual hardware instead.</div><div><br /></div><div>IMPORTANT NOTE 3:  You can use this script with *some* debugging functionality for local debugging of non-x86 binaries.  The script loads qemu and runs the non-x86 binaries in qemu.  However qemu</div><div>has some unfortunate limitations.  For example you can "set" breakpoints in the binary (to see what addresses correspond to locations in the source), examine the source or assembly code, and execute the program.  But qemu does not actually hit the breakpoints, so you cannot suspend <span style="font-size:10pt;background-color:transparent">execution in the middle when running under qemu.   For full debugging functionality with non-x86 binaries, you must debug them remotely running on the correct hardware (see next section on remote debugging).  You can see this in the example below, where gdb-daisy does not actually stop at the breakpoint it appears to set, although it does correctly execute the program.</span></div><div>
<br />
</div>
</div>
<div></div>
<div class="sites-codeblock sites-codesnippet-block">
<div><font color="#9900ff" face="arial, sans-serif" size="3">(cr) $ gdb-daisy -h</font></div>
<div><code><font color="#9900ff" face="arial, sans-serif" size="3"><br />
</font></code></div><div><code><font color="#9900ff" face="arial, sans-serif" size="3"><div>usage: cros_gdb [-h]</div><div>                [--log-level {fatal,critical,error,warning,notice,info,debug}]</div><div>                [--log_format LOG_FORMAT] [--debug] [--nocolor]</div><div>                [--board BOARD] [-g GDB_ARGS] [--remote REMOTE] [--pid PID]</div><div>                [--remote_pid PID] [--no-ping] [--attach ATTACH_NAME] [--cgdb]</div><div>                [binary-to-be-debugged] [args-for-binary-being-debugged]</div><div><br /></div><div>Wrapper for running gdb.</div><div><br /></div><div>This handles the fun details like running against the right sysroot, via</div><div>qemu, bind mounts, etc...</div><div><br /></div><div>positional arguments:</div><div>  inf_args              Arguments for gdb to pass to the program being</div><div>                        debugged. These are positional and must come at the</div><div>                        end of the command line. This will not work if</div><div>                        attaching to an already running program.</div><div>...</div><div><br /></div><div><div>(cr) $ gdb-daisy /bin/grep shebang /bin/ls</div><div>15:51:06: INFO: RunCommand: file /build/daisy/bin/grep</div><div>Reading symbols from /bin/grep...Reading symbols from /usr/lib/debug/bin/grep.debug...done.</div><div>done.</div><div>(daisy-gdb) b main</div><div>Breakpoint 1 at 0x2814: file grep.c, line 2111.</div><div>(daisy-gdb) disass main</div><div>Dump of assembler code for function main:</div><div>   0x00002814 &lt;+0&gt;:<span style="white-space:pre"> </span>ldr.w<span style="white-space:pre"> </span>r2, [pc, #3408]<span style="white-space:pre"> </span>; 0x3568 &lt;main+3412&gt;</div><div>   0x00002818 &lt;+4&gt;:<span style="white-space:pre"> </span>str.w<span style="white-space:pre"> </span>r4, [sp, #-36]!</div><div>   0x0000281c &lt;+8&gt;:<span style="white-space:pre"> </span>movs<span style="white-space:pre"> </span>r4, #0</div><div>   0x0000281e &lt;+10&gt;:<span style="white-space:pre"> </span>strd<span style="white-space:pre"> </span>r5, r6, [sp, #4]</div><div>   0x00002822 &lt;+14&gt;:<span style="white-space:pre"> </span>ldr.w<span style="white-space:pre"> </span>r3, [pc, #3400]<span style="white-space:pre"> </span>; 0x356c &lt;main+3416&gt;</div><div>   0x00002826 &lt;+18&gt;:<span style="white-space:pre"> </span>movs<span style="white-space:pre"> </span>r5, #2</div><div>   0x00002828 &lt;+20&gt;:<span style="white-space:pre"> </span>strd<span style="white-space:pre"> </span>r7, r8, [sp, #12]</div></div><div>...</div><div><div>(daisy-gdb) run</div><div>Starting program: /bin/grep shebang /bin/ls</div><div>qemu: Unsupported syscall: 26</div><div>#!/usr/bin/coreutils --coreutils-prog-shebang=ls</div><div>qemu: Unsupported syscall: 26</div><div>During startup program exited normally.</div><div>(daisy-gdb) quit</div></div></font></code></div>
</div>
<div><br />
</div><div>Note in the example above that, unlike "regular" gdb, you can pass the arguments for the program being debugged to the gdb wrapper script just by adding them to the command line after the name of the program being debugged. </div><div><span style="font-size:10pt;background-color:transparent"><br /></span></div><div><span style="font-size:10pt;background-color:transparent">The commands below show how to copy your incrementally-compiled unit test binary and source file(s) to the appropriate sysroot and then start gdb with that binary (using the correct libraries, etc).</span></div>
<div><br />
<span style="font-family:monospace;line-height:13px;background-color:rgb(239,239,239)"><font color="#9900ff">
</font>
<div class="sites-codeblock sites-codesnippet-block"><code><font color="#9900ff">(cr) $ cd /build/lumpy/tmp/portage<br />(cr) $ mkdir shill-test<br />(cr) $ cd shill-test<br />(cr) $ cp &lt;path-to-binary&gt;/shill_unittest .<br /></font></code><span style="color:rgb(153,0,255);line-height:1;font-size:10pt">(cr) $ cp &lt;path-to-src&gt;/shill_unittest.cc .<br /></span><span style="color:rgb(153,0,255);line-height:1;font-size:10pt">(cr) $ gdb-lumpy<br />(gdb-lumpy) directory /tmp/portage/shill-test          # Tell gdb to add /tmp/portage/shill-test to the paths it searches for source files<br />(gdb-lumpy) file ./shill_unittest</span></div>
</span></div>
<div><br /></div><div>If gdb is still looking for the source file in the wrong directory path, you can use 'set substitute-path &lt;from&gt; &lt;to&gt;' inside gdb to help it find the right path (inside your sysroot) for searching for source files.</div><div><br /></div>
</div>
<hr size="2" width="100%" />
<hr />
<h2><a name="TOC-Remote-Debugging"></a>Remote Debugging<br />
</h2>
<br />
<div>
<div>
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob"></a>
<h3><a name="TOC-Setting-up-remote-debugging-by-hand."></a>Setting up remote debugging by hand.</h3>
If you want to manually run through all the steps necessary to set up your system for remote debugging and start the debugger, see <a href="http://www.chromium.org/chromium-os/how-tos-and-troubleshooting/remote-debugging" style="color:rgb(0,102,204);outline-style:none">Remote Debugging in Chromium OS</a>.<br />
<br />
<div>
<div>
<div>
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob"></a>
<h3><a name="TOC-Automated-remote-debugging-using-gdb--BOARD-script-gdb-lumpy-gdb-daisy-gdb-parrot-etc-."></a>Automated remote debugging using gdb-${BOARD} script (gdb-lumpy, gdb-daisy, gdb-parrot, etc).<br />
</h3>
gdb-${BOARD} is a script that automates many of the steps necessary for setting up remote debugging with gdb.  It should already be installed in your chroot.  If you do not have the script, update your repository to get the latest changes, then re-build your packages:<br />
<br />
<div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)">repo sync</code><br />
<br />
<code style="color:rgb(0,96,0)"><font color="#9900ff">./build_packages --board=...<br />
</font></code></div>
</div>
<br />
This should install gdb_remote in the /usr/bin directory inside the chroot.  The gdb-${BOARD} script takes several options.  The most important ones are mentioned below.<br />
</div>
<br />
</div>
</div>
"--gdb_args" ("-g") are arguments to be passed to gdb itself (rather than to the program gdb is debugging).  If multiple arguments are passed, each argument requires a separate -g flag. </div><div>E.g gdb-lumpy --remote=123.45.67.765  -g "-core=/tmp/core" -g "-directory=/tmp/source"<br />
<br />
"--remote" is the ip_address or name for your chromebook, if you are doing remote debugging.  If you omit this argument, the assumption is you are doing local debugging in the sysroot on your desktop (see section above).  if you are debugging in the VM, then you need to specify either ':vm:' or 'localhost:9222'.<br />
<br />
"--pid" is the pid of a running process on the remote device to which you want gdb/gdbserver to attach.<br />
<br />
"--attach" is the name of the running process on the remote device to which you want gdb/gdbserver to attach.  If you want to attach to the Chrome browser itself, there are three special names you can use:  'browser' will attach to the main browser process; 'gpu-process' will attach to the GPU process; and 'renderer' will attach to the renderer process if there is only one.  If there is more than one renderer process --attach=renderer will return a list of the renderer pids and stop.</div><div><br /></div><div>To have gdb/gdbserver start and attach to a new (not already running) binary, give the name of the binary, followed by any arguments for the binary, at the end of the command line:</div><div><br /></div><div><div><div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><span style="color:rgb(153,0,255)"><font size="3">$ gdb-daisy --remote=123.45.67.809 /bin/grep "test" /tmp/myfile</font></span></div></div><br style="font-size:13.3333330154419px" /></div><div>When doing remote debugging you *must* use the --pid or the --attach option, or specify the name of a new binary to start.  You cannot start a remote debugging session without having specified the program to debug in one of these three ways.<br />
<br />
When you invoke gdb-${BOARD} --remote=..., it will connect to the notebook or VM (automatically setting up port-forwarding on the VM), make sure the port is entered into the iptables, and start up gdbserver, using the correct port and binary, either attaching to the binary (if a remote pid or name was specified) or starting up the binary.  It will also start the appropriate version of gdb (for whichever type of board you are debugging) on your desktop and connect the gdb on your desktop to the gdbserver on the remote device.<br /><br />
<br />
<div>
<hr />
</div>
<h3><a name="TOC-How-do-I-fix-network-problems-in-th"></a>Examples of debugging using the gdb-${BOARD} script.</h3>
Below are three examples of using the board-specific gdb wrapper scripts to start up debugging sessions.  The first two examples show connecting to a remote chromebook.  The first one automatically finds the browser's running GPU process, attaches gdbserver to the running process, starts gdb on the desktop, and connects the local gdb to gdbserver.  It also shows the user running  the 'bt' (backtrace) command after gdb comes up.  The second example shows the user specifying the pid of a process on the chromebook.  Again the script attaches gdbserver to the process, starts gdb on the desktop, and connects the two.  The third example shows the user connecting to the main browser process in ChromeOS running in a VM on the user's desktop.    For debugging the VM, you can use either</div><div>--remote=:vm: or --remote=localhost:9222  (":vm:" gets translated into "localhost:9222").<br />
<br />
<div>Example 1:<br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff"><br />
$ gdb-lumpy --remote=123.45.67.809 --attach=gpu-process</font></code><br /><br /></div><div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><div class="sites-codeblock sites-codesnippet-block" style="line-height:13px">14:50:07: INFO: RunCommand: ping -c 1 -w 20 123.45.67.809<br /><span style="font-size:10pt">14:50:09: INFO: RunCommand: file /build/lumpy/opt/google/chrome/chrome<br /></span><span style="font-size:10pt">14:50:10: INFO: RunCommand: x86_64-cros-linux-gnu-gdb --quiet '--eval-command=set</span><span style="font-size:10pt"> sysroot /build/lumpy' '--eval-command=set solib-absolute-prefix /build/lumpy' '-</span><span style="font-size:10pt">-eval-command=set solib-search-path /build/lumpy' '--eval-command=set debug-file-</span><span style="font-size:10pt">directory /build/lumpy/usr/lib/debug' '--eval-command=set prompt (lumpy-gdb) ' '-</span><span style="font-size:10pt">-eval-command=file /build/lumpy/opt/google/chrome/chrome' '--eval-command=target </span><span style="font-size:10pt">remote localhost:38080'<br /></span><span style="font-size:10pt">Reading symbols from /build/lumpy/opt/google/chrome/chrome...Reading symbols from</span><span style="font-size:10pt">/build/lumpy/usr/lib/debug/opt/google/chrome/chrome.debug...done.<br /></span><span style="font-size:10pt">(l</span><span style="font-size:10pt">umpy-gdb) bt <br /></span><span style="font-size:10pt">#0  0x00007f301fad56ad in poll () at ../sysdeps/unix/syscall-template.S:81<br /></span><span style="font-size:10pt">#1 </span><span style="font-size:10pt"> 0x00007f3020d5787c in g_main_context_poll (priority=2147483647, n_fds=3,   </span><span style="font-size:10pt">fds=0xdce10719840, timeout=-1, context=0xdce1070ddc0) at gmain.c:3584 <br /></span><span style="font-size:10pt">#2  g_main_context_iterate (context=context@entry=0xdce1070ddc0,</span><span style="font-size:10pt">block=block@entry=1, dispatch=dispatch@entry=1, self=&lt;optimized out&gt;)  </span><span style="font-size:10pt">at gmain.c:3285<br /></span><span style="font-size:10pt">#3  0x00007f3020d5798c in g_main_context_iteration (context=0xdce1070ddc0</span><span style="font-size:10pt">may_block=1) at gmain.c:3351<br /></span><span style="font-size:10pt">#4  0x00007f30226a4c1a in base::MessagePumpGlib::Run (this=0xdce10718580, </span><span style="font-size:10pt">delegate=&lt;optimized out&gt;) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/bas</span><span style="font-size:10pt">e/message_loop/message_pump_glib.cc:309<br /></span><span style="font-size:10pt">#5  0x00007f30226666ef in base::RunLoop::Run (this=this@entry=0x7fff72271af0) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/bas</span><span style="font-size:10pt">e/run_loop.cc:55<br /></span><span style="font-size:10pt">#6  0x00007f302264e165 in base::MessageLoop::Run (this=this@entry=0x7fff72271db0)</span><span style="font-size:10pt"> </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/bas</span><span style="font-size:10pt">e/message_loop/message_loop.cc:307<br /></span><span style="font-size:10pt">#7  0x00007f30266bc847 in content::GpuMain (parameters=...) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/con</span><span style="font-size:10pt">tent/gpu/gpu_main.cc:365<br /></span><span style="font-size:10pt">#8  0x00007f30225cedee in content::RunNamedProcessTypeMain (process_type=..., </span><span style="font-size:10pt">main_function_params=..., delegate=0x7fff72272380</span><span style="font-size:10pt"> </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/con</span><span style="font-size:10pt">tent/app/content_main_runner.cc:385<br /></span><span style="font-size:10pt">#9  0x00007f30225cef3a in content::ContentMainRunnerImpl::Run (this=0xdce106fef50</span><span style="font-size:10pt">) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/con</span><span style="font-size:10pt">tent/app/content_main_runner.cc:763<br /></span><span style="font-size:10pt">#10 0x00007f30225cd551 in content::ContentMain (params=...) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/con</span><span style="font-size:10pt">tent/app/content_main.cc:19<br /></span><span style="font-size:10pt">#11 0x00007f3021fef02a in ChromeMain (argc=21, argv=0x7fff722724b8) </span><span style="font-size:10pt">at ../../../../../chromeos-cache/distfiles/target/chrome-src-internal/src/chr</span><span style="font-size:10pt">ome/app/chrome_main.cc:66<br /></span><span style="font-size:10pt">#12 0x00007f301fa0bf40 in __libc_start_main (</span><span style="font-size:10pt">main=0x7f3021fee760 &lt;main(int, char const**)&gt;, argc=21, argv=0x7fff722724b8, </span><span style="font-size:10pt">init=&lt;optimized out&gt;, fini=&lt;optimized out&gt;, rtld_fini=&lt;optimized out&gt;,</span><span style="font-size:10pt">stack_end=0x7fff722724a8) at libc-start.c:292<br /></span><span style="font-size:10pt">#13 0x00007f3021feee95 in _start ()<br /></span><span style="font-size:10pt">(lumpy-gdb)</span></div><div><br />
</div>
<br />
</div>
</div>
<div><br />
Example 2:<br />
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><code style="color:rgb(0,96,0)"><font color="#9900ff"><br />
</font></code><code style="color:rgb(0,96,0)"><font color="#9900ff">$ gdb-daisy --pid=626 --remote=123.45.98.765<br /></font></code><span style="font-size:13.3333330154419px">14:50:07: INFO: RunCommand: ping -c 1 -w 20 123.45.98.765<br /></span><span style="font-size:10pt">14:50:09: INFO: RunCommand: file /build/daisy/usr/sbin/cryptohomed<br /></span><span style="font-size:10pt">14:50:10: INFO: RunCommand: armv7a-cros-linux-gnueabi-gdb --quiet '--eval-command=set</span><span style="font-size:10pt"> sysroot /build/daisy' '--eval-command=set solib-absolute-prefix /build/daisy' '-</span><span style="font-size:10pt">-eval-command=set solib-search-path /build/daisy' '--eval-command=set debug-file-</span><span style="font-size:10pt">directory /build/daisy/usr/lib/debug' '--eval-command=set prompt (daisy-gdb) ' '-</span><span style="font-size:10pt">-eval-command=file /build/daisy/usr/sbin/cryptohomed' '--eval-command=target </span><span style="font-size:10pt">remote localhost:38080'<br /></span><span style="font-size:10pt">Reading symbols from /build/daisy/usr/sbin/cryptohomed...Reading symbols from</span><span style="font-size:10pt">/build/daisy/usr/lib/debug/usr/bin/cryptohomed.debug...done.<br /></span><span style="font-size:13.3333330154419px">(daisy-gdb)</span></div>
<div>
</div>
<div><br />
</div><div><div style="font-size:13.3333330154419px"><br />Example 3:<br /><div class="sites-codeblock sites-codesnippet-block" style="line-height:13px"><code><font color="#9900ff"><br /></font></code><code><font color="#9900ff">$ gdb-lumpy --remote=:vm: --attach=browser<br /></font></code><span style="font-size:13.3333330154419px">15:18:28: INFO: RunCommand: ping -c 1 -w 20 localhost<br /></span><span style="font-size:13.3333330154419px">15:18:31: INFO: RunCommand: file /build/lumpy/opt/google/chrome/chrome<br /></span><span style="font-size:13.3333330154419px">15:18:33: INFO: RunCommand: x86_64-cros-linux-gnu-gdb --quiet '--eval-command=set</span><span style="font-size:13.3333330154419px">sysroot /build/lumpy' '--eval-command=set solib-absolute-prefix /build/lumpy' '-</span><span style="font-size:13.3333330154419px">-eval-command=set solib-search-path /build/lumpy' '--eval-command=set debug-file-</span><span style="font-size:13.3333330154419px">directory /build/lumpy/usr/lib/debug' '--eval-command=set prompt (lumpy-gdb) ' '-</span><span style="font-size:13.3333330154419px">-eval-command=file /build/lumpy/opt/google/chrome/chrome' '--eval-command=target </span><span style="font-size:13.3333330154419px">remote localhost:48062'<br /></span><span style="font-size:13.3333330154419px">Reading symbols from /build/lumpy/opt/google/chrome/chrome...Reading symbols from </span><span style="font-size:13.3333330154419px">/build/lumpy/usr/lib/debug/opt/google/chrome/chrome.debug...done.<br /></span><span style="font-size:13.3333330154419px">done.<br /></span><span style="font-size:13.3333330154419px">Remote debugging using localhost:48062<br /></span><span style="font-size:13.3333330154419px">...<br /></span><span style="font-size:13.3333330154419px">(lumpy-gdb)</span></div><div></div><div><br /></div><div>If you find problems with the board-specific gdb scripts, please file a bug (<a href="http://crosbug.com">crosbug.com</a>) and add 'build-toolchain' as one of the labels in the bug.</div></div><hr style="font-size:13.3333330154419px" /><br /></div>
</div>
</div>
<hr />
<h2><a name="TOC-Troubleshooting"></a>Troubleshooting</h2>
<div>
<div>
<hr />
</div>
<a name="TOC-My-build-is-failing-what-s-the-prob" style="color:rgb(0,102,204);outline-style:none"></a>
<h3><a name="TOC-I-lost-my-developer-tools-on-the-stateful-partition-can-I-get-them-back-"></a>I lost my developer tools on the stateful partition, can I get them back?</h3>
<div>
<div>This happens sometimes because the security system likes to wipe out the stateful partition and a lot of developer tools are in /usr/local/bin. But all is not lost because there is a tool for updating the stateful partition from an image created by the auto-update part of the dev_server. Sadly, it is normally found in /usr/local so will have been lost too and you need to copy it over manually. This works for me:<br />
</div>
<div><br />
</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)">$ cd /tmp</code></div>
<div><code style="color:rgb(0,96,0)">$ scp me@myworkstation:/path/to/chromiumos/chroot/build/x86-whatever/usr/bin/stateful_update .</code></div>
<div><code style="color:rgb(0,96,0)">$ sudo sh stateful_update</code></div>
<div><code style="color:rgb(0,96,0)">$ sudo reboot</code></div>
</div>
<div><br />
</div>
<div>Note you can clobber the stateful partition (remove user accounts etc and force OOBE) as part of this process by using a flag:</div>
<div><br />
</div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)"><span style="font-family:Arial,Verdana,sans-serif;color:rgb(0,0,0)">
<div><code style="color:rgb(0,96,0)">$ cd /tmp</code></div>
<div><code style="color:rgb(0,96,0)">$ scp me@myworkstation:/path/to/chromiumos/chroot/build/x86-whatever/usr/bin/stateful_update .</code></div>
<div><code style="color:rgb(0,96,0)">$ sudo sh stateful_update --stateful_change=clean</code></div>
<div><code style="color:rgb(0,96,0)">$ sudo reboot</code></div>
</span></code></div>
</div>
<div><br />
</div>
</div>
</div>
<div><br />
</div>
<div></div>
<hr />
<hr />
<h2><a name="TOC-Running-Tests"></a>Running Tests</h2>
<div>Many of the automated tests that are part of the Chromium OS project run using the autotest framework. See <a href="testing/autotest-user-doc.1.html">Autotest User Documentation</a> for details.</div>
<div><br />
</div>
<div><b>Various quick links:</b></div>
<div><a href="testing/autotest-user-doc.1.html#TOC-Writing-and-developing-tests" style="font-family:arial,sans-serif;font-size:small">Creating a new test</a></div>
<div>
<hr />
</div>
<div><a href="testing/running-smoke-suite-on-a-vm-image.html" style="color:rgb(0,102,204)">Running Smoke Suite On a VM Image</a></div>
<div>
<hr />
</div>
<div>
<h3><a name="TOC-Seeing-which-tests-are-implemented-by-an-ebuild"></a><span style="font-weight:normal"><font size="2"><a href="testing/autotest-user-doc.1.html#TOC-Q4:-I-have-an-ebuild-what-tests-does-it-build-">Seeing which tests are implemented by an ebuild</a></font></span></h3>
</div>
<div>
<hr />
</div>
<div><a href="testing/autotest-user-doc.1.html#TOC-W4.-Create-and-run-a-test-enabled-image-on-your-device" style="font-family:arial,sans-serif;font-size:small">Getting an image that has been modified for test</a><font size="2"> - </font><span style="color:rgb(255,0,0)">This doesn't work if you want to create a recovery image and boot a Cr48 with it, see below</span></div>
<div><br />
</div>
<div>If you wish to produce a VM image instead, you should omit the <font color="#9900ff">--test </font>flag to <font color="#9900ff">build_image </font>and let <font color="#9900ff">./image_to_vm.sh </font>produce the test image:</div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./image_to_vm.sh --board=${BOARD}</font></code><span style="font-family:monospace;color:rgb(153,0,255)"> --test_image </span></div>
</div>
<br />
</div>
<div><i>Note: this difference between `cros flash` and ./image_to_vm.sh arises because ./image_to_vm.sh does not yet support the --image_name flag and by default looks for chromiumos_image.bin.  We expect this to change in the future.</i></div>
<div><br />
</div>
<div>
<div> Note that creating a test image will change the root password of the image to <b>test0000.  </b>The <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">--test_image</span> flag causes the<span> </span><span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">image_to_xxx</span> commands to make a copy of your <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">chromiumos_image.bin</span> file called <span style="font-family:monospace;color:rgb(153,0,255);line-height:13px">chromiumos_test_image.bin</span> (if that file doesn't already exist), modify that image for test, and use the test image as the source of the command.<br />
</div>
<div>
</div>
<div><br />
</div>
<div><b>SIDE NOTES:<br />
</b>
<ul><li style="margin-top:0.5em"><span style="font-size:10pt;background-color:transparent">If the directory already has a file called </span><span style="font-size:10pt;font-family:monospace;color:rgb(153,0,255);line-height:13px;background-color:transparent">chromiumos_test_image.bin</span><span style="font-size:10pt;background-color:transparent">, that file is reused. That means that calling both </span><span style="font-size:10pt;font-family:monospace;color:rgb(153,0,255);line-height:13px;background-color:transparent">cros flash</span><span style="font-size:10pt;background-color:transparent"> and </span><span style="font-size:10pt;font-family:monospace;color:rgb(153,0,255);line-height:13px;background-color:transparent">image_to_vm.sh</span><span style="font-size:10pt;background-color:transparent"> doesn't waste time by creating the test image twice.</span></li></ul>
</div>
</div>
<div>
<div>
<hr />
</div>
<h3><a name="TOC-Getting-an-image-that-has-been-modi" style="color:rgb(0,102,204);outline-style:none"></a>Creating a recovery image that has been modified for test</h3>
<p>After building a test image using <font color="#9900ff">./build_image test </font>as described above, you may wish to encapsulate it within a recovery image:</p>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:13px"><span style="color:rgb(153,0,255);font-family:monospace"><span style="font-family:Arial,Verdana,sans-serif;color:rgb(0,0,0)">
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">./mod_image_for_recovery.sh \</font></code></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">    --board=${BOARD} \</font></code></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">    --nominimize_image \</font></code></div>
<div><code style="color:rgb(0,96,0)"><font color="#9900ff">    --image ~/trunk/src/build/images/${BOARD}/latest/chromiumos_test_image.bin \<br />
    --to ~/trunk/src/build/images/${BOARD}/latest/recovery_test_image.bin</font></code></div>
</span></span></div>
</div>
<p>If desired, you may specify a custom kernel with <span style="color:rgb(153,0,255);font-family:monospace;font-size:13.3333330154419px;line-height:13px;background-color:rgb(239,239,239)">--kernel_image ${RECOVERY_KERNEL}</span><span style="font-size:13.3333330154419px;background-color:transparent">.</span></p>
<p><span style="font-size:10pt;background-color:transparent">You can write this recovery image out to the USB device like so:</span></p>
</div>
<div>
<div>
<div>
<div class="sites-codeblock sites-codesnippet-block" style="border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;background-color:rgb(239,239,239)"><code style="line-height:13px;color:rgb(0,96,0)"><font color="#9900ff">cros flash usb:// ~/trunk/src</font></code><span style="background-color:transparent;line-height:13px"><font color="#9900ff" face="monospace">/build/images/${BOARD}/latest/recovery_test_image.bin</font></span></div>
</div>
</div>
</div>
<p>
Note that there are some <b>downsides</b> to this approach which you should keep in mind.</p>
</div>
<div>
<ul><li>Your USB image will be a recovery mode/test image, but the ordinary image in your directory will be a non-test image.</li>
<li>If you use devserver, this will serve the non-test image not the test-image.</li>
<li>This means a machine installed with a test-enabled USB image will update to a non-test-enabled one.</li></ul>
</div>
<div>
<hr size="2" width="100%" />
</div>
<div>
<div>
<hr />
</div>
<a name="TOC-Other-notes" style="color:rgb(0,102,204);outline-style:none"></a>
<h2><a name="TOC-Additional-information1"></a>Additional information</h2>
<h3><a name="TOC-Developer-mode"></a>Toolchain Compilers</h3>
<p><span style="font-size:10pt">At any given time in the chroot, to see what cross-compiler version is the current default one, do:</span></p>
<div>
<ul><li>For ARM: <font color="#9900ff">armv7a-cros-linux-gnueabi-gcc -v</font></li>
<li>For x86: <font color="#9900ff">i686-pc-linux-gnu-gcc -v</font></li>
<li><font color="#9900ff"><span style="color:rgb(0,0,0)">For amd64: </span><font color="#9900ff">x86_64-cros-linux-gnu-gcc -v</font></font></li></ul>
<h3><a name="TOC-Developer-mode1"></a><span style="background-color:transparent;font-size:10pt">Developer mode</span></h3>
</div>
</div>
<div>
<p>It can be confusing to figure out what "developer mode" means: Some parts of this document talk about switching your hardware to developer mode, while other parts talk about entering developer mode by running an image built with the <code style="color:rgb(0,96,0)"><font color="#9900ff">--withdev</font></code> flag. For the most part, the two actions enable the same set of things (like the shell command in crosh). Thus, you can think of either action as enabling developer mode.</p>
<div>
<p>To provide some details:</p>
<ul><li style="margin-top:0.5em">Putting your hardware into developer mode makes <code style="color:rgb(153,0,0)">/bin/cros_boot_mode</code> print <code style="color:rgb(153,0,0)">developer</code>. It also makes the file<span style="color:rgb(153,0,0)"> </span><code style="color:rgb(153,0,0)">/mnt/stateful_partition/.developer_mode</code> appear.
</li>
<li style="margin-top:0.5em">Building with the <code style="color:rgb(0,96,0)"><font color="#9900ff">--withdev</font></code> flag creates a file called <code style="color:rgb(153,0,0)">/root/.dev_mode</code> (in addition to adding a whole bunch of useful developer tools to your stateful partition). The presence of the<span style="color:rgb(153,0,0)"> </span><span style="font-family:monospace;color:rgb(153,0,0)">/root/.dev_mode</span> file enables developer mode and also prevents wiping of the stateful partition when you switch your hardware between developer mode and release mode.</li></ul>
</div>
<a name="TOC-1"></a>
<hr size="2" width="100%" />
<h3><a name="TOC-Attribution-requirements"></a>Attribution requirements</h3>
When you produce a Chromium OS image, you need to fulfill various attribution requirements of third party licenses. Currently, the images generated by a build don't do this for you automatically. You must modify <a href="http://src.chromium.org/svn/trunk/src/chrome/browser/resources/chromeos/about_os_credits.html" target="_blank">~/chromium/src/chrome/browser/resources/chromeos/about_os_credits.html</a>.
<br />
<br />
</div>
</div>
<div>
<div>
<hr />
<a name="TOC-More-reading"></a>
<h3><a name="TOC-Documentation-on-this-site"></a>Documentation on this site</h3>
<div>You now understand the basics of building, running, modifying, and testing Chromium OS, but you've still got a lot to learn. Here are links to a few other pages on the chromium.org site that you are likely to find helpful (somewhat ordered by relevance):</div>
<div>
<ul><li style="margin-top:0.3em">The <a href="tips-and-tricks-for-chromium-os-developers.html" name="TOC-Tips-and-Tricks" style="color:rgb(0,102,204);outline-style:none">Tips And Tricks for Chromium OS Developers</a> page has a lot of useful information to help you optimize your workflow.</li>
<li style="margin-top:0.3em">If you haven't read the page about the<span> </span><a href="how-tos-and-troubleshooting/using-the-dev-server.1.html" style="color:rgb(0,102,204);outline-style:none">devserver</a><span> </span>already, read it now.</li>
<li style="margin-top:0.3em">Learn about the Chromium OS <a href="developer-guide/directory-structure.html" style="color:rgb(0,102,204);outline-style:none">directory structure</a>.</li>
<li style="margin-top:0.3em"><a href="how-tos-and-troubleshooting/developer-faq.html" style="color:rgb(0,102,204);outline-style:none">The Chromium OS developer FAQ</a></li>
<li style="margin-top:0.3em"><a href="how-tos-and-troubleshooting/portage-build-faq.html" style="color:rgb(0,102,204);outline-style:none">Chromium OS Portage Build FAQ</a><span> is useful for portage-specific questions.</span></li>
<li style="margin-top:0.3em"> If you have questions about the <code style="color:rgb(0,96,0)"><font color="#9900ff">--noenable_rootfs_verification</font></code> option, you might find answers on this <a href="https://groups.google.com/a/chromium.org/group/chromium-os-dev/browse_thread/thread/967e783e27dd3a9d/0fa20a1547de2c77?lnk=gst" style="color:rgb(0,102,204);outline-style:none">thread on chromium-os-dev</a>.</li>
<li style="margin-top:0.3em"><a href="testing/running-smoke-suite-on-a-vm-image.html" style="color:rgb(0,102,204);outline-style:none">Running Smoke Suite on a VM Image</a> has good information about how to get up and running with autotest tests and VMs.</li>
<li style="margin-top:0.3em"><a href="how-tos-and-troubleshooting/debugging-tips.1.html" style="color:rgb(0,102,204);outline-style:none">Debugging Tips</a><span> </span>contains information about how to debug the Chromium browser on your Chromium OS device.</li>
<li style="margin-top:0.3em"><a name="TOC-Working-on-a-branch"></a><a href="how-tos-and-troubleshooting/working-on-a-branch.html">Working on a Branch</a> has tips for working on branches.<br />
</li>
<li style="margin-top:0.3em"><a href="how-tos-and-troubleshooting/git-server-side-information.html">Git server-side information</a> talks about adding new git repositories.</li>
<li style="margin-top:0.3em">The <a href="portage-package-status.html">Portage Package Upgrade Process</a> documents how our Portage packages can be upgraded when they fall out of date with respect to upstream.</li>
<li style="margin-top:0.3em">The <a href="developer-guide/chromium-os-sandboxing.html">Chromium OS Sandboxing</a> page describes the mechanisms and tools used to sandbox (or otherwise restrict the privileges of) Chromium OS system services.<br />
</li>
</ul>
</div>
<div><br />
<hr size="2" width="100%" />
<h3><a name="TOC-External-documentation"></a>External documentation</h3>
Below are a few links to external sites that you might also find helpful (somewhat ordered by relevance):</div>
<div>
<ul><li style="margin-top:0.3em"><b>Definitely</b> look at the <a href="http://groups.google.com/a/chromium.org/group/chromium-os-dev" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium OS dev group</a> to see what people are talking about.</li>
<li style="margin-top:0.3em">Check out the <a href="http://code.google.com/p/chromium-os/issues/list" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium OS bug tracker</a> to report bugs, look for known issues, or look for things to fix.</li>
<li style="margin-top:0.3em">Get an idea of what's actively happening by looking at the<span> </span><a href="http://codereview.chromium.org/" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium Code Reviews</a><span> </span>site. (Note that this is the combined site for both Chromium and Chromium OS.)</li>
<li style="margin-top:0.3em">Browse the source code on the <a href="https://chromium.googlesource.com/" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium OS gitweb</a>.</li>
<li style="margin-top:0.3em">Check the current status of the builds by looking at the<span> </span><a href="http://build.chromium.org/p/chromiumos/waterfall" style="color:rgb(0,102,204);outline-style:none" target="_blank">Chromium OS build waterfall</a>.</li>
<li style="margin-top:0.3em">Check out the<span> </span><a href="http://webchat.freenode.net/?channels=chromium-os" style="color:rgb(0,102,204);outline-style:none" target="_blank">#chromium-os channel</a> on freenode.net (this is the IRC channel that Chromium OS developers like to hang out on).</li>
<li style="margin-top:0.3em">If you're learning git, check out <a href="http://www.google.com/url?q=http%3A%2F%2Feagain.net%2Farticles%2Fgit-for-computer-scientists%2F&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzcOLmdu1_j4wvdnWaUkgTNwig-zxg" style="color:rgb(0,102,204);outline-style:none" target="_blank">Git for Computer Scientists</a>, <a href="http://www.google.com/url?q=http%3A%2F%2Fwww-cs-students.stanford.edu%2F%257Eblynn%2Fgitmagic%2F&amp;sa=D&amp;sntz=1&amp;usg=AFrqEzd0LcYKlFSHeWlQzalvRlf4sTBLiA" style="color:rgb(0,102,204);outline-style:none" target="_blank">Git Magic</a>, or the <a href="http://schacon.github.com/git/user-manual.html" style="color:rgb(0,102,204);outline-style:none" target="_blank">Git Manual</a>.</li>
<li style="margin-top:0.3em">Gentoo has several useful documentation resources</li>
<ul><li style="margin-top:0.3em"><a href="http://devmanual.gentoo.org/" style="color:rgb(0,102,204);outline-style:none" target="_blank">Gentoo Development Guide</a> is a useful resource for Portage, which is the underlying packaging system we use.</li>
<li style="margin-top:0.3em"><a href="http://www.gentoo.org/proj/en/base/embedded/handbook/" style="color:rgb(0,102,204);outline-style:none" target="_blank">Gentoo Embedded Handbook</a> </li>
<li style="margin-top:0.3em"><a href="http://www.gentoo.org/proj/en/base/embedded/handbook/" style="color:rgb(0,102,204);outline-style:none" target="_blank">Gentoo Cross Development Guide</a></li>
<li style="margin-top:0.3em"><a href="http://en.gentoo-wiki.com/wiki/Crossdev" style="color:rgb(0,102,204);outline-style:none" target="_blank">Gentoo Wiki on Cross-Compiling</a></li>
<li style="margin-top:0.3em"><a href="http://www.gentoo.org/proj/en/qa/pms.xml" style="color:rgb(0,102,204);outline-style:none" target="_blank">Gentoo Package Manager Specification</a> </li></ul>
<li style="margin-top:0.3em"><font color="#ff0000"><span style="color:rgb(0,0,0)">The</span><span style="color:rgb(0,0,0)"> </span><span style="color:rgb(0,0,0)"><a href="http://source.android.com/source/git-repo.html" style="color:rgb(0,102,204);outline-style:none" target="_blank">repo man page</a></span><span style="color:rgb(0,0,0)"> </span><span style="color:rgb(0,0,0)">might help you if you're curious about repo.</span></font></li>
<li style="margin-top:0.3em"><font color="#ff0000"><span style="color:rgb(0,0,0)">The<span> </span><a href="http://groups.google.com/group/repo-discuss?hl=en" style="color:rgb(0,102,204);outline-style:none" target="_blank">repo-discuss group</a><span> </span>is a good place to talk about repo.</span></font></li></ul>
</div>
</div>
</div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages" class="sites-canvas-bottom-panel-wrapper" style="">
<div class="sites-subpages">
            Subpages <span id="subpages-total-number">(9):</span>
<span>
<a href="developer-guide/beaglebone.html" dir="ltr">Building for Beaglebone</a>
</span>
<span>
<a href="developer-guide/chromium-os-sandboxing.html" dir="ltr">Chromium OS Sandboxing</a>
</span>
<span>
<a href="developer-guide/using-serial-tty.html" dir="ltr">Controlling Enabled Consoles</a>
</span>
<span>
<a href="developer-guide/directory-structure.html" dir="ltr">Directory Structure (Chromium OS)</a>
</span>
<span>
<a href="developer-guide/disk-layout-format.html" dir="ltr">Disk Layout Format</a>
</span>
<span>
<a href="developer-guide/gerrit-guide.1.html" dir="ltr">Gerrit credentials setup (for Chromium OS and Chrome OS)</a>
</span>
<span>
<a href="developer-guide/go-in-chromium-os.html" dir="ltr">Go in Chromium OS</a>
</span>
<span>
<a href="developer-guide/developer-workflow.html" dir="ltr">Simple developer workflow</a>
</span>
<span>
<a href="developer-guide/using-sdk-standalone.html" dir="ltr">Using Chromium OS SDK as standalone, DIY</a>
</span>
</div>
</div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/chromium-os/developer-guide">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9abBHImPhigIUgjLbfwu3L8CiOF1BHuzYLSLyUlsaD_4FBkONdMOECvROR8h8YPBzhcN7s1EhwN3u8K-EiDcsTDhOMuu2NXmjQdXXu1bfWQZ_Hm7e/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
