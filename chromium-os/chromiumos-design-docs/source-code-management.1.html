<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/chromiumos-design-docs","deleted":false,"title":"Design Documents","dir":"ltr"},{"path":"/chromium-os/chromiumos-design-docs/source-code-management","deleted":false,"title":"Source Code Management","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/source-code-management\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/chromiumos-design-docs","parentWuid":"wuid:gx:2eb69dd73ece341e","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Source Code Management","locale":"en","wuid":"wuid:gx:11393981b6d75dca","revision":8,"path":"/chromium-os/chromiumos-design-docs/source-code-management","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"source-code-management","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Source Code Management - The Chromium Projects" />
<meta itemprop="name" content="Source Code Management - The Chromium Projects" />
<meta property="og:title" content="Source Code Management - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Source Code Management - The Chromium Projects</title>
<meta itemprop="image" content="https://www.chromium.org/_/rsrc/1258650215944/chromium-os/chromiumos-design-docs/source-code-management/repo-archpng" />
<meta property="og:image" content="https://www.chromium.org/_/rsrc/1258650215944/chromium-os/chromiumos-design-docs/source-code-management/repo-archpng" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../developers/discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../../chromium-os.1.html" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="../chromiumos-design-docs.1.html" dir="ltr">Design Documents</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Source Code Management</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="source-code-management.1.html#TOC-Abstract"><strong>1 </strong>Abstract</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Background"><strong>2 </strong>Background</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Requirements"><strong>3 </strong>Requirements</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Design-objectives"><strong>4 </strong>Design objectives</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Detailed-design"><strong>5 </strong>Detailed design</a><ol class="goog-toc"><li class="goog-toc"><a href="source-code-management.1.html#TOC-Version-control-system"><strong>5.1 </strong>Version control system</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Package-database"><strong>5.2 </strong>Package database</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Sample-metadata.google-for-busybox"><strong>5.3 </strong>Sample README.chromium for busybox</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Commit-log-metadata"><strong>5.4 </strong>Commit log metadata</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Code-review"><strong>5.5 </strong>Code review</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Checkout-management"><strong>5.6 </strong>Checkout management</a></li></ol></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-References-and-links"><strong>6 </strong>References and links</a><ol class="goog-toc"><li class="goog-toc"><a href="source-code-management.1.html#TOC-Git-tutorial"><strong>6.1 </strong>Git tutorial</a></li><li class="goog-toc"><a href="source-code-management.1.html#TOC-Git-documentation"><strong>6.2 </strong>Git documentation</a></li></ol></li></ol></div></div></div></div>
<h2><a name="TOC-Abstract"></a>Abstract</h2>
<ul>
<li>Chromium OS is an open source project with the goal of keeping good relationships and communication with upstream sources. Chromium OS is thus structured to upstream code early and often.</li>
<li>Chromium OS will use Git as its version control system, Rietveld for code reviews and gclient for package checkout management.</li></ul>

This document outlines the Chromium OS process for managing the upstream bits that make up the Chromium OS Linux distribution.
<p>
</p>
<h2><a name="TOC-Background"></a>
    Background
  </h2>
<p>
</p>
<p>
</p>
<div>
Chromium OS is an open-source project, built for people who spend most of their time on the web. Chromium OS is currently made up of 190 or so open-source packages.</div>
<h2><a name="TOC-Requirements"></a>
    Requirements<br />
</h2>
<b>Sources hosted by us.</b>
Upstream mirrors can be rearranged: sources can be moved, removed, or modified. We also need the sources locally since we need
them in order to build.<br />
<br />
<b>One format.</b>
The upstream sources may be stored in any number of version control
systems (VCS). Or they may not even be stored in a VCS and instead be
available as a tarball, .deb, or .rpm. For our hosted sources, we'd
like to have them stored in one VCS format. This may require import from a VCS into our VCS. Alternatively, we could store sources in their native VCS but this would require our developers to work with multiple VCSs.<br />
<b><br />
  Avoid patch files.</b>
Patch files are difficult to maintain and difficult to keep in sync
with upstream. We plan to keep a copy of the entire upstream source tree
in a VCS.<br />
<br />
<div style="text-align:left">
<b>Simple upstreaming.</b> We want to upstream early
and often to minimize the set of changes we have to maintain. We
also want a good partnership with upstream. <br />
<br />
<b>Simple tracking.</b> It needs to
be easy to track what bits we've added to open-source components. It
should also be easy to track the upstream status of our changes: Has the patch been sent upstream? Has it been accepted, rejected, or accepted in modified form?</div>
<h2><a name="TOC-Design-objectives"></a>
    Design objectives<br />
</h2>
<p>
<b>Upstream package database.</b>
We need a database that stores metadata about each package we are
using: homepage, upstream repository information, upstream bugs
database location, mailing list, license, upstream submission process,
and so on. Examples: <a href="https://admin.fedoraproject.org/pkgdb/acls/name/acpid" title="fedora">fedora</a>, <a href="http://packages.debian.org/source/lenny/acpid" title="debian">debian</a>, <a href="https://launchpad.net/ubuntu/+source/acpid" title="ubuntu">ubuntu</a>, <a href="http://packages.gentoo.org/package/sys-power/acpid" title="gentoo">gentoo</a>.
  </p>
<p>
</p>
<p>
</p>
<p>
<b>Distributed Version Control System (DVCS).</b> Without a <a href="http://en.wikipedia.org/wiki/Distributed_revision_control" title="DVCS">DVCS</a>,
distributed development (working with upstream) is difficult. With a
DVCS, cloning, merging, and pulling in upstream changes are common
operations. For a traditional VCS, cloning an upstream repository
involves initially using rsync to copy the upstream repository
(assuming such access is given) and then special scripts to handle
future pulls.<br />
</p>
<p>
</p>
<p>
<b>Each package in its own repository.</b>
Pulling multiple upstream trees into one monolithic tree is difficult.
It would also make it nearly impossible to use a DVCS. We want to make
it easy to work with upstream, easy to track ancestry of our code, and
easy to track what patches we've applied.  This is hard to do with a
monolithic repository. With a repository per package, a simple
invocation of the VCS tool's diff will do.<br />
</p>
<p>
<b>One DVCS tool.</b>
We could mirror each upstream repository locally in its native VCS but
then we wouldn't be able to use a DVCS where upstream is not. Also, it
would force our developers to have to deal with many different VCS
tools. We could write our own wrapper library but that's extra
development effort we should be able to avoid.  Instead, we should just
mirror in our one DVCS format, sources which are managed upstream with
a different DVCS.<br />
</p>
<p>
<b>A DVCS with good import/export capability.</b>
Many of the most popular DVCS tools support import and export to other
backends. The DVCS will support checkin and checkout of code to and
from a different backend. Often the import/export is seamless enough
that the workflow for dealing with a different backend is not much
different from the normal workflow.<br />
</p>
<p><b>Commit log metadata.</b>
For some modules, we will be merging in patches from different sources.
For such patches, we will annotate the commit log with metadata which
documents the original source.<br style="color:rgb(0,0,0)" />
</p>
<p>
</p>
<p>
</p>
<h2><a name="TOC-Detailed-design"></a>
    Detailed design</h2>
<h3><a name="TOC-Version-control-system"></a>
    Version control system
  </h3>
<p>Out of all the available DVCS tools,
Git implements our design objectives best. Also, of the projects we use which use a
DVCS, most use Git.</p>
<p>Our process for managing source repositories will be as follows:<br />
</p>
<ol><li>
      We will host a Git repository for all source components which we are modifying.Whenever a new package or dependency is added, a new Git repository will be created.<br />
</li>
<li>
      For upstream Git sources, our repository will be a clone of upstream.<br />
</li>
<li>
      For upstream sources not stored in Git, we'll create an additional Git repository.</li>
<ul><li>
        The import repository will be named <i>&lt;project&gt;</i>-import.
      </li>
<ul><li>
          For example, project foo would be: foo-import
        </li></ul>
<li>
        Our Git repository will be "based" on the import.
      </li>
<li>
        We will automatically re-sync the import repository with upstream on a regular basis (for example, daily).</li></ul>
<li>
For sources which are not hosted in a VCS upstream, we'll create an
additional Git repository. Typically this will come from a tarball, deb
package, or rpm package. </li>
<ul><li>
        The repository will contain the unpackaged source tree.</li>
<li>
        Any patches held in the package will be applied as subsequent changes in Git.<br />
</li>
<li>
        Future upstream releases will be committed to this repository in the same way.
      </li>
<li>
        The repository will be named: <i>&lt;project&gt;</i>-import
      </li>
<ul><li>
          For example, project bar would be: bar-import
        </li></ul>
<li>
        Our repository will be "based" on the import.
      </li></ul>
<li>We will create a branch off of a recent stable upstream release and make our changes there.</li>
<li>To make future syncing easier, and to make it easier to separate out our bits from upstream, we will <a href="http://www.gitready.com/intermediate/2009/01/31/intro-to-rebase.html" title="rebase">rebase</a>.
Rebasing is a best-practice for managing upstream sources. For example,
the Ubuntu kernel is regularly rebased against
upstream. The alternative, merging commits from upstream, results in
local changes being interleaved with upstream. Rebasing creates a clean
history with local changes appearing after upstream commits. </li>
</ol>
The diagram below shows the flow of code between repositories.
Repositories above the top dashed-line are upstream-hosted, the
repositories between the dashed-lines are Google-hosted, and the
repositories below the lower dashed-line are the user's local checkout.<br />
<br />
Where upstream is non-Git, we'll create a local Git import tree: "bar
svn import" and "bash .deb import" above. The Google repository will be
a Git repository based on a particular upstream tag of the upstream Git
repository (or our Git import if upstream is not using Git).<br />
<br />
<div style="display:block;text-align:left"><a href="http://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/source-code-management/repo-arch.png?attredirects=0" imageanchor="1"><img border="0" src="../../_/rsrc/1258650215944/chromium-os/chromiumos-design-docs/source-code-management/repo-archpng" /></a></div>
<div style="text-align:left">
</div>
<div style="text-align:left">
</div>
<div style="text-align:left">
</div>
<h3><a name="TOC-Package-database"></a>
    Package database
  </h3>
  Initially, we will store a README.chromium file in the root directory of the package which will contain the following fields in shell parseable format:<br />
<ol><li>
      DESCRIPTION: one-line description of the package<br />
</li>
<li>
      HOMEPAGE: URL to upstream page (possibly a freshmeat.net page)<br />
</li>
<li>
      UPSTREAM_REPO: URL for upstream repository<br />
</li>
<li>
      LOCAL_GIT_REPO: git url for our Git repository<br />
</li>
<li>
      UPSTREAM_BUGSDB: URL for upstream bug database<br />
</li>
<li>
      LOCAL_BUGSDB: URL for our bug database for this package
    </li>
<li>
      LICENSE: name of license (we'll need a license database somewhere)<br />
</li>
</ol>
  
  
  Eventually, we may move to a more sophisticated web-hosted package database like <a href="https://launchpad.net/" title="Launchpad">Launchpad</a>.
In a web-hosted package database, we could also display derived
information like: current Chromium OS version, upstream latest version, and so on.<br />
<h3><a name="TOC-Sample-metadata.google-for-busybox"></a>
    Sample README.chromium for busybox<br />
</h3>
<span style="font-family:Courier New">DESCRIPTION="Utilities for embeddded systems"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">HOMEPAGE="http://www.busybox.net"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">UPSTREAM_REPO="git://git.busybox.net/busybox"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">LOCAL_GIT_REPO="https://chromium.googlesource.com/external/busybox"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">UPSTREAM_BUGSDB="https://bugs.busybox.net/"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">LOCAL_BUGSDB="http://tracker.chromium.org/busybox"</span><br style="font-family:Courier New" />
<span style="font-family:Courier New">LICENSE="GPL-2"</span><div><font face="'Courier New'">LICENSE_FILE="LICENSE"<br /></font>
<div><font face="&amp;apos;Courier New&amp;apos;"><br />
</font></div>
<div>
<h3><a name="TOC-Commit-log-metadata"></a>Commit log metadata
  </h3>
We want to track where our sources are coming from. The mechanism for
doing this will be to recommend that the following metadata be included
as part of the commit log:<br />
<ul><li>
      Source: Where did this change come from? Google? Ubuntu? kernel.org?
    </li>
<li>
      Commit ID: Git commit id / SVN log number / patch number in package
    </li>
<li>
Tested status: Leaning on people to describe how they tested a checkin
has proved to be extremely effective "social engineering" in other
projects </li>
<li> Upstream status: Tracking upstream status is more
difficult as the status will evolve over time. This data may need to
be in a separate database, but tying the database into the DVCS will
not be simple to keep consistent over Git rebases (which change Git
commit IDs).<br />
</li></ul>
<div style="text-align:left">
<h3><a name="TOC-Code-review"></a>
      Code review
    </h3>
    Our current code review tool, <a href="http://code.google.com/appengine/articles/rietveld.html" title="Rietveld">Rietveld</a>, already supports Git change uploads via <a href="http://code.google.com/p/rietveld/source/browse/trunk/static/upload.py" title="update.py">update.py</a>. For making it easier to do Git code reviews with Rietveld, we will be using <a href="http://groups.google.com/group/codereview-discuss/browse_thread/thread/d9f65d04165e274f/b8740b9beab78e4c" title="git-cl">git-cl</a>, . There is
also an open-source tool designed specifically for Git code reviews: <a href="http://source.android.com/submit-patches/workflow" title="gerrit">gerrit</a>. It is a <a href="http://code.google.com/p/gerrit/wiki/Background" title="fork of reitveld">fork of reitveld</a>.<br />
<h3><a name="TOC-Checkout-management"></a>
      Checkout management<br />
</h3>
    We are using <a href="http://code.google.com/p/gclient/" title="gclient">gclient</a>
for package checkout management.<br />
</div>
<h2><a name="TOC-References-and-links"></a> References and links<br />
</h2>
<h3><a name="TOC-Git-tutorial"></a>
    Git tutorial<br />
</h3>
<a href="http://www-cs-students.stanford.edu/%7Eblynn/gitmagic/" target="_blank">http://www-cs-students.stanford.edu/~blynn/gitmagic/</a><br />
<h3><a name="TOC-Git-documentation"></a>
    Git documentation
  </h3>
<a href="http://git-scm.com/documentation" target="_blank">http://git-scm.com/documentation</a></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-attachments">
<div class="sites-attachments-row"><div class="sites-attachments-icon" style="left:0px;"><span aria-label="Attachments" title="Attachments"><div class="sites-translucent sites-symbol" aria-hidden="true">Č</div></span></div><div id="sites-attachments-update-div" class="sites-attachments-inner-div" style="display:none;"><span class="sites-attachments-update-icon"><img src="https://ssl.gstatic.com/sites/p/56e332/system/app/images/spinner.gif" /></span><div class="sites-attachments-update-text">Updating...</div></div></div><div class="sites-attachments-separator"></div>
<div id="attachment-wuid:gx:519fde29a34d73fb"><div class="sites-attachments-row"><div class="sites-attachments-icon sites-attachments-icon-accessible" style="left:5px"><div class="sites-translucent sites-symbol" aria-label="File" title="File">ċ</div></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name">repo-archpng <div class="sites-translucent">(70k)</div></div><div class="sites-attachments-author">Jed Hartman, <div class="sites-translucent">Nov 19, 2009, 9:03 AM</div></div></div><div class="sites-attachments-version sites-attachments-version-accessible"><a href="https://www.chromium.org/system/app/pages/admin/revisions?wuid=wuid:gx:519fde29a34d73fb">v.1</a></div><div id="attachment-download-wuid:gx:519fde29a34d73fb" class="sites-attachments-icon sites-attachments-icon-accessible" style="right:0px"><a href="source-code-management/repo-archpng%3Fattredirects=0&amp;d=1" aria-label="Download repo-archpng" title="Download" role="button"><span class="sites-symbol" aria-hidden="true">ď</span></a></div></div><div class="sites-attachments-separator"></div></div>
<div style="height: 10px"></div>
</div>
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/source-code-management">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9Jj-HXyqvZxH9cEGMLVlsqy558swF7c9Lo3LOTuv0UvA1MRFPUDBMQVZznez-9Ma_ZdjEafAsusNavVb52ASRatMwYenZdELoUzxzyOS_xYJJ6vOa/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
