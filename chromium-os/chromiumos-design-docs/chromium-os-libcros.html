<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/chromiumos-design-docs","deleted":false,"title":"Design Documents","dir":"ltr"},{"path":"/chromium-os/chromiumos-design-docs/chromium-os-libcros","deleted":false,"title":"Cros - How Chromium talks to Chromium OS","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/chromium-os-libcros\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/chromiumos-design-docs","parentWuid":"wuid:gx:2eb69dd73ece341e","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Cros - How Chromium talks to Chromium OS","locale":"en","wuid":"wuid:gx:358a502a98ae863a","revision":34,"path":"/chromium-os/chromiumos-design-docs/chromium-os-libcros","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"chromium-os-libcros","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Cros - How Chromium talks to Chromium OS - The Chromium Projects" />
<meta itemprop="name" content="Cros - How Chromium talks to Chromium OS - The Chromium Projects" />
<meta property="og:title" content="Cros - How Chromium talks to Chromium OS - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Cros - How Chromium talks to Chromium OS - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../developers/discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:571d8fbd499df20e" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../../chromium-os.1.html" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="../chromiumos-design-docs.1.html" dir="ltr">Design Documents</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Cros - How Chromium talks to Chromium OS</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Abstract"><strong>1 </strong>Abstract</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Objective"><strong>2 </strong>Objective</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Detailed-Description"><strong>3 </strong>Detailed Description</a><ol class="goog-toc"><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Cros-Files"><strong>3.1 </strong>Cros Files</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Workflow"><strong>3.2 </strong>Workflow</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Cros-DEPS"><strong>3.3 </strong>Cros DEPS</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Version-Checking"><strong>3.4 </strong>Version Checking</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Binding-libcros.so"><strong>3.5 </strong>Binding libcros.so</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Modifying-method-implementation"><strong>3.6 </strong>Modifying method implementation</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Adding-methods-to-Cros-API"><strong>3.7 </strong>Adding methods to Cros API</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Deleting-methods-from-Cros-API"><strong>3.8 </strong>Deleting methods from Cros API</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Modifying-method-signatures"><strong>3.9 </strong>Modifying method signatures</a></li></ol></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-FAQ"><strong>4 </strong>FAQ</a><ol class="goog-toc"><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-How-do-I-locally-test-a-Cros-and-corresponding-Chromium-change-before-I-check-anything-in-"><strong>4.1 </strong>How do I locally test a Cros and corresponding Chromium change before I check anything in?</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Why-does-Cros-fail-to-load-with-message-Incompatible-libcros-version.-Client:x-Min:y-Max:-z-where-x-z-"><strong>4.2 </strong>Why does Cros fail to load with message "Incompatible libcros version. Client:x Min:y Max: z" where x &gt; z?</a></li><li class="goog-toc"><a href="chromium-os-libcros.html#TOC-Why-does-Cros-fail-to-load-with-message-Incompatible-libcros-version.-Client:x-Min:y-Max:-z-where-x-y-"><strong>4.3 </strong>Why does Cros fail to load with message "Incompatible libcros version. Client:x Min:y Max: z" where x &lt; y?</a></li></ol></li></ol></div></div></div></div><font color="#ff0000" size="4"><b>DEPRECATED</b></font><div><font color="#ff0000"><b><br /></b></font>As of October 2011, the Cros library (libcros.so) is now in the process of phasing out. The chromium browser talks to the background servers of Chromium OS via IPC mechanism called D-Bus. The browser has ability to issue D-Bus method calls and handle D-Bus signals hence no longer needs the Cros library layer.<br /><h2><a name="TOC-Abstract"></a>Abstract</h2><span style="font-family:arial,sans-serif"><span style="font-size:small">Cros came about because we needed a way for Chromium UI code to talk to Chromium OS code. For example, the Chromium networking UI needs to talk to Chromium OS flimflam to get network status and to make connections to wifi/cellular networks. Cros is set of APIs that is implemented on the Chromium OS side and exposed to Chromium via a dynamically linked <i>libcros.so</i> file. We designed a versioning system to make sure that Chromium OS will only boot up if we have the correct version of <i>libcros.so</i>. If either the <i>libcros.so </i>version or the Chromium version is too old, we catch that and disable login.</span></span><h2><a name="TOC-Objective" style="color:rgb(0,102,204);outline-style:none"></a>Objective</h2><span style="font-family:arial,sans-serif;font-size:medium"><div style="color:rgb(0,0,0)"><span style="font-size:small">The design behind Cros is based on these requirements:</span></div><div style="color:rgb(0,0,0)"><ul><li><span style="font-size:small">Chromium OS code and Chromium code are in 2 different source trees. When we do release builds, we may use different snapshots of these 2 trees depending on how stable they are. From past experience, we would release Chromium OS with a slightly older but stable version of Chromium. So Chromium should be able to talk to Chromium OS even if the <i>libcros.so</i> file in Chromium OS is slightly newer.</span></li><li><span style="font-size:small">We should be able to modify Cros implementation without having to recompile Chromium.</span></li><li><span style="font-size:small">We should be able to add new Cros API methods without having to recompile Chromium.</span></li><li><span style="font-size:small">When new Cros API methods are needed by Chromium, we should be able to tell Chromium to bind to these new methods and use them in Chromium.</span></li><li><span style="font-size:small">The LKGR build of Chromium OS should always work with the LKGR build of Chromium.</span></li><li><span style="font-size:small">When Cros in Chromium OS is incompatible with that of Chromium, we need fail fast and let the user know why.</span></li></ul></div></span><h2><a name="TOC-Detailed-Description"></a>Detailed Description</h2><h3><a name="TOC-Cros-Files"></a>Cros Files</h3><div><span style="font-size:small"><span style="font-family:arial,sans-serif;font-size:medium"><table border="1" bordercolor="#888888" cellspacing="0" style="margin:0px;border-collapse:collapse;border-color:rgb(136,136,136);border-width:1px"><tbody><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> </span><b><span style="font-size:small">File</span></b></td><td style="vertical-align:top;width:562px;height:14px"><b><span style="font-size:small">Description</span></b></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> </span><b><span style="font-size:small">Used by Chromium OS</span></b></td><td style="vertical-align:top;width:180px;height:14px"><span style="font-size:small"> </span><b><span style="font-size:small">Used by Chromium</span></b></td></tr><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> <i>platform/cros/chromeos_cros_api.h</i></span></td><td style="vertical-align:top;width:562px;height:14px"><span style="font-size:small"> Defines version number of Cros: <span style="border-collapse:separate"><code style="color:rgb(0,96,0)">kCrosAPIMinVersion</code> and <code style="color:rgb(0,96,0)">kCrosAPIVersion</code></span></span></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> Yes</span></td><td style="vertical-align:top;width:180px;height:14px"><span style="font-size:small"> Yes (only <span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span>)</span></td></tr><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> <i>platform/cros/load.cc</i></span></td><td style="vertical-align:top;width:562px;height:14px"><span style="font-size:small"> This is the code that Chromium uses to bind methods to <i>libcros.so</i></span></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> </span></td><td style="vertical-align:top;width:180px;height:14px"><span style="font-size:small"> Yes</span></td></tr><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> <i>platform/cros/version_check.cc</i></span></td><td style="vertical-align:top;width:562px;height:14px"><span style="font-size:small"> Version checking code to make sure that version of <i>libcros.so</i> is compatible with Chromium</span></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> </span></td><td style="vertical-align:top;width:180px;height:14px"><span style="font-size:small"> Yes</span></td></tr><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> <i>platform/cros/chromeos_*.h</i></span></td><td style="vertical-align:top;width:562px;height:14px"><span style="font-size:small"> Defines the Cros API</span></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> Yes</span></td><td style="vertical-align:top;width:180px;height:14px"><span style="font-size:small"> Yes</span></td></tr><tr><td style="vertical-align:top;width:191px;height:14px"><span style="font-size:small"> <i>platform/cros/chromeos_*.cc</i></span></td><td style="vertical-align:top;width:562px;height:14px"><span style="font-size:small"> Cros Implementation</span></td><td style="vertical-align:top;width:159px;height:14px"><span style="font-size:small"> Yes</span></td><td style="vertical-align:top;width:180px;height:14px"><font face="Arial, Verdana, sans-serif"><span style="border-collapse:separate"><font face="arial, sans-serif"><span style="border-collapse:collapse"><span style="font-size:small"><br /></span></span></font></span></font></td></tr></tbody></table></span></span></div><h3><a name="TOC-Workflow"></a>Workflow</h3><div><span style="font-size:small">This is the workflow of how <span style="font-family:arial,sans-serif">Cros</span> is used in Chromium OS:</span></div><div><ol><li><span style="font-size:small">Chromium OS is built and the Cros files listed above are built into the <i>libcros.so</i> file.</span></li><li><span style="font-size:small">Chromium build uses a DEPS file to fetch a specific version of Cros to build against.</span></li><li><span style="font-size:small">Chromium is built against this specific version of Cros API.</span></li><li><span style="font-size:small">When Chromium OS starts up Chromium, we make sure that the version of Cros that Chromium is built against is compatible with the version of <i>libcros.so</i>.</span></li><li><span style="font-size:small">If it's compatible, we binds the method calls from Chromium to the implementation in <i>libcros.so</i>.</span></li><li><span style="font-size:small">All Cros method calls from Chromium will now execute the corresponding method in Chromium OS's <i>libcros.so</i>.</span></li></ol></div><h3><a name="TOC-Cros-DEPS"></a>Cros DEPS</h3><div><span style="font-family:arial,sans-serif;font-size:small">In order to have Chromium build against a specific version of Cros, we use this DEPS file: <a href="http://src.chromium.org/viewvc/chrome/trunk/src/tools/cros.DEPS/DEPS?view=markup">http://src.chromium.org/viewvc/chrome/trunk/src/tools/cros.DEPS/DEPS?view=markup</a></span></div><div><span style="font-size:small"><span style="font-family:arial,sans-serif"><div style="color:rgb(0,0,0)"><br /></div><div><div style="color:rgb(0,0,0)"></div><div class="sites-codeblock sites-codesnippet-block" style="background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:16px"><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">vars = {</code></div><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">  "chromium_git": "http://src.chromium.org/git",</code></div><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">}</code></div><div style="color:rgb(0,0,0)"><br /></div><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">deps = {</code></div><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">  "src/third_party/cros":</code></div><div><code>    Var("chromium_git") + "/cros.git@<span style="line-height:normal;font-size:medium;white-space:pre"><font color="#38761d">e9730f8a</font></span><br /></code><span style="font-family:monospace;color:rgb(0,96,0)">",</span></div><div style="color:rgb(0,0,0)"><code style="color:rgb(0,96,0)">}</code></div></div></div><div style="color:rgb(0,0,0)"><br /></div><div style="color:rgb(0,0,0)">The 7 characters after the @ is the first 7 characters of the git commit hash for the last Cros change that we want to build Chromium against.</div><div style="color:rgb(0,0,0)">For this example in this specific case, this is the change: <a href="http://git.chromium.org/gitweb/?p=cros.git;a=commit;h=e9730f8a8a689ae3e506d1e400c4799190d302d0">http://git.chromium.org/gitweb/?p=cros.git;a=commit;h=e9730f8a8a689ae3e506d1e400c4799190d302d0</a></div><div style="color:rgb(0,0,0)">This DEPS file will need to be updated when there are new Cros APIs that are needed by Chromium.</div><h3><a name="TOC-Version-Checking"></a>Version Checking</h3><div style="color:rgb(0,0,0)"><div style="color:rgb(0,0,0)">The version checking code is in <i>version_check.cc</i>, and it gets run by Chromium when it is started by Chromium OS.</div><div style="color:rgb(0,0,0)"><br /></div><div style="color:rgb(0,0,0)">In chromeos-api.h, we define 2 version numbers: <code>kCrosAPIMinVersion</code> and <code>kCrosAPIVersion</code><span style="font-family:Arial,Verdana,sans-serif">. We use these version numbers to decide if the version of Cros in Chromium is compatible with the version of Cros in Chromium OS. </span><span style="font-family:Arial,Verdana,sans-serif">Since both Chromium and Chromium OS have their own copy of chromeos-api.h, we have 2 sets of these 2 <span style="font-family:arial,sans-serif">version numbers</span>. </span><span style="font-family:Arial,Verdana,sans-serif">Chromium OS's <span style="font-family:arial,sans-serif"><code style="color:rgb(0,96,0)">kCrosAPIMinVersion</code> and <code style="color:rgb(0,96,0)">kCrosAPIVersion</code></span> specify the min and max version of the Cros API that the <i>libcros.so</i> supports. In other words, it is only compatible if <span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span> in Chromium is within the range [</span><code style="color:rgb(0,96,0)">kCrosAPIMinVersion,</code> <code style="color:rgb(0,96,0)">kCrosAPIVersion</code><span style="font-family:Arial,Verdana,sans-serif">] of Chromium OS.</span></div><div style="color:rgb(0,0,0)"><span style="font-family:Arial,Verdana,sans-serif"><br /></span></div><div style="color:rgb(0,0,0)"><span style="font-family:Arial,Verdana,sans-serif">This means that the version of Cros in Chromium OS can be newer than the version of Cros in Chromium. In other words, <i>libcros.so</i> can have new methods that are not used by an older version of Cros in Chromium, but not the other way around. If Chromium's <span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span> is greater than Chromium OS's <span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span>, then Chromium is likely depending on a new Cros API that's not implemented in <i>libcros.so</i>. In this case, the version check fails, and we prevent user from logging in and display an error like: </span><span style="font-family:monospace;color:rgb(0,96,0)">Incompatible libcros version. Client: 51 Min: 29 Max: 50</span></div><div style="color:rgb(0,0,0)"><span style="font-family:Arial,Verdana,sans-serif"><br /></span></div><div style="color:rgb(0,0,0)"><span style="font-family:Arial,Verdana,sans-serif">The </span><span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIMinVersion</span><span style="font-family:Arial,Verdana,sans-serif"> version in <i>libcros.so</i> is used to specify the minimum version of the Cros API that's supported. This number gets increased when we remove methods from the Cros API. So if Chromium's </span><span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span><span style="font-family:Arial,Verdana,sans-serif"> is less than Chromium OS's </span><span style="font-family:monospace;color:rgb(0,96,0)">kCrosAPIMinVersion</span><span style="font-family:Arial,Verdana,sans-serif">, then that means Chromium is likely using a Cros API method that's no longer there. In this case, the version check fails, and we prevent user from logging in</span><span style="font-family:Arial,Verdana,sans-serif"> and display an error like: <code>Incompatible libcros version. Client: 28 Min: 29 Max: 50</code></span></div><h3><a name="TOC-Binding-libcros.so"></a>Binding <i>libcros.so</i></h3></div><div style="color:rgb(0,0,0)">After version check passes, the code in <i>load.cc</i> runs to bind the Chromium method calls to the implementation in <i>libcros.so</i>. If binding fails for any reason, we prevent the user from logging and display an error like: <code>Couldn't load: MethodName</code></div><div style="color:rgb(0,0,0)"><br /></div><div style="color:rgb(0,0,0)"><span style="font-family:Arial,Verdana,sans-serif;font-size:20px;font-weight:bold">Common Developer Workflows</span></div></span></span></div><div><span style="font-size:small"><span style="font-size:13px"><div><h3><a name="TOC-Modifying-method-implementation"></a>Modifying method implementation</h3>To change a Cros method implementation, you just need to change the code on the Chromium OS side and you don't need to do anything on the Chromium side. Chromium will bind with the unchanged Cros API on the new libcros.so and exercise your new code without any problems.<br /><h3><a name="TOC-Adding-methods-to-Cros-API"></a>Adding methods to Cros API</h3><div><span style="font-size:small">This is best described by a table showing what you need to do on the Chromium OS side and on Chromium side:</span></div><div><span style="font-size:small"><br /></span></div><div><span style="font-size:small"><table border="1" bordercolor="#888888" cellspacing="0" style="border-collapse:collapse;border-color:rgb(136,136,136);border-width:1px"><tbody><tr><td style="width:516px;height:14px"> <b>Chromium OS</b></td><td style="width:508px;height:14px"> <b>Chromium</b></td></tr><tr><td style="width:516px;height:14px"> Check in new code:<br /><span>    - </span>Add new API to <i>chromeos_*.h<br /><span style="font-style:normal"><span>    - </span>Add implementation to <i>chromeos_*.cc<br /></i></span><span style="font-style:normal"><span>    - </span>Add code to <i>load.cc</i> to declare and initialize new API<br /><span>    </span>- </span><span style="font-style:normal">Increment <span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span> in <i>chromeos_cros_api.h</i></span><br /></i></td><td style="width:508px;height:14px"> </td></tr><tr><td style="width:516px;height:14px"> Get your change's commit hash from:<br /><span>    <a href="http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD">http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD</a></span><br /></td><td style="width:508px;height:14px"> <span style="border-collapse:separate"> </span></td></tr><tr><td> </td><td> Update DEPS:<br /><span>    - </span>Put your commit hash in cros_deps/DEPS<br /><span>    - Run "gclient sync"<br /><span>    - Confirm third-party/cros includes your change</span><br /><span>    - Make sure build compiles<br />    - Copy cros_DEPS/DEPS to tools/cros.DEPS/DEPS <br /></span>    - Check in tools/cros.DEPS/DEPS</span></td></tr><tr><td> </td><td> Check in new code that utilizes the new API</td></tr></tbody></table></span></div></div><h3><a name="TOC-Deleting-methods-from-Cros-API"></a>Deleting methods from Cros API</h3><div><span style="font-size:small"><span style="font-size:13px"><div><span style="font-size:small">Deleting a method from the API is a complicated process that's prone to error. </span><span style="font-size:small">So make sure you know what you are doing.</span></div><div><span style="font-size:small">It is recommended that you wait at least a week after removing the usage and binding of the method before you actually remove the implementation. This is because deleting a method will make things backwards incompatible. So we need to make sure that all possible versions of Chromium that was use with Chromium OS will have this new Cros that does not bind with the deprecated method.</span></div><div><span style="font-size:small"><br /></span></div><div><span style="font-size:small"><table border="1" bordercolor="#888888" cellspacing="0" style="margin:0px;border-collapse:collapse;border-color:rgb(136,136,136);border-width:1px"><tbody><tr><td style="vertical-align:top;width:516px;height:14px"> <b>Chromium OS</b></td><td style="vertical-align:top;width:508px;height:14px"> <b>Chromium</b></td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> </td><td style="vertical-align:top;width:508px;height:14px"> Remove calls to deprecated API</td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> Deprecate method:<br /><span>    -</span> Keep the method implementation<br /><span>    - </span>Remove binding of method in <i>load.cc</i><br /><span>    - Increment <i><span style="font-style:normal"><span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span></span></i> in <i>chromeos-api.h</i></span></td><td style="vertical-align:top;width:508px;height:14px"> </td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> Get your change's commit hash from:<br /><span>  </span><a href="http://git.chromium.org/gitweb/?p=cros.git;a=commit;h=HEAD"><span style="font-size:small"><span style="font-size:13px"><span style="font-size:small"><span> </span></span></span></span></a><a href="http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD">http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD</a> <br /></td><td style="vertical-align:top;width:508px;height:14px"> </td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> </td><td style="vertical-align:top;width:508px;height:14px"> Update DEPS:<br /><span>    - </span>Put your commit hash in cros_deps/DEPS<br /><span>    - Run "gclient sync"<br /><span>    - Confirm third-party/cros includes your change</span><br /><span>    - Make sure build compiles<br />    - Copy cros_DEPS/DEPS to tools/cros.DEPS/DEPS<br />    - Check in tools/cros.DEPS/DEPS</span></span></td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> Delete method:<br /><span>    - Delete implementation<br /><span>    - Set <span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIMinVersion</span> to <i><span style="font-style:normal"><span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span></span></i><br /></span></span><span>    - Increment <i><span style="font-style:normal"><span style="border-collapse:separate;font-family:monospace;color:rgb(0,96,0)">kCrosAPIVersion</span></span></i> in <i>chromeos-api.h</i><br /></span></td><td style="vertical-align:top;width:508px;height:14px"> </td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> Get your change's commit hash from:<br />  <span style="font-size:small"><span style="font-size:13px"><span style="font-size:small"><span> <a href="http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD">http://git.chromium.org/gitweb/?p=chromiumos/platform/cros.git;a=commit;h=HEAD</a></span></span></span></span><a href="http://git.chromium.org/gitweb/?p=cros.git;a=commit;h=HEAD"></a></td><td style="vertical-align:top;width:508px;height:14px"> </td></tr><tr><td style="vertical-align:top;width:516px;height:14px"> </td><td style="vertical-align:top;width:508px;height:14px"> Update DEPS:<br /><span>    - </span>Put your commit hash in cros_deps/DEPS<br /><span>    - Run "gclient sync"<br /><span>    - Confirm third-party/cros includes your change</span><br /><span>    - Make sure build compiles<br />    - Copy cros_DEPS/DEPS to tools/cros.DEPS/DEPS<br />    - Check in tools/cros.DEPS/DEPS</span></span></td></tr></tbody></table></span></div></span></span></div><h3><a name="TOC-Modifying-method-signatures"></a>Modifying method signatures</h3><div><span style="font-size:small">It is highly recommend against modifying method signatures. This is because if you modify a method signature, you would need to check in a backwards incompatible change. In other words, in order for Chromium to talk to Chromium OS, it would need this exact version of Cros. So you would have to check in code to both Chromium OS and Chromium at the same time. And i</span><span style="font-size:small">f anyone tries to use Chromium OS with a slightly older version of Chromium, they will be blocked from logging in.</span></div><div><span style="font-size:small"><br /></span></div><div><span style="font-size:small">Instead of modifying a method signature, it is better to just add a new method in Cros, change it so that Chromium calls this new method. And after a while, delete the old deprecated method.</span></div><div><span style="font-size:small"><span style="font-size:13px"><div><h2><a name="TOC-FAQ"></a>FAQ</h2><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><h3><a name="TOC-How-do-I-locally-test-a-Cros-and-corresponding-Chromium-change-before-I-check-anything-in-"></a>How do I locally test a Cros and corresponding Chromium change before I check anything in?</h3><font face="Arial, Verdana, sans-serif">After you have "git commit" the Cros code, you can use "git pull" to pull that code to Chromium:</font></span></span></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><code>cd ~/chrome/src/third_party/cros</code></font></span></span></div><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><code>git pull ~/chromeos/src/platform/cros</code></font></span></span></div><div></div></div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><br /></font></span></span><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif">And if you want to test Chromium with the new <i>libcros.so</i>, you need to copy it to the chromeos directory:</font></span></span></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><code>emerge-x86-generic libcros <i>(in Chromium OS chroot)</i></code></font></span></span></div><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><code>mkdir ~/chrome/src/out/Debug/chromeos</code></font></span></span></div><div><span style="font-size:small"><span style="font-family:Arial;font-size:13px"><font face="Arial, Verdana, sans-serif"><code>cp ~/chromeos/chroot/build/x86-generic/opt/google/chrome/chromeos/* ~/chrome/src/out/Debug/chromeos</code></font></span></span></div></div><h3><a name="TOC-Why-does-Cros-fail-to-load-with-message-Incompatible-libcros-version.-Client:x-Min:y-Max:-z-where-x-z-"></a>Why does Cros fail to load with message "Incompatible libcros version. Client:x Min:y Max: z" where x &gt; z?</h3><div>This happens when the version of Cros in Chromium is newer than the version of Cros in Chromium OS. To fix this, make sure you fetch the latest code from <i>platform/cros</i> and then emerge libcros.</div><div><h3><a name="TOC-Why-does-Cros-fail-to-load-with-message-Incompatible-libcros-version.-Client:x-Min:y-Max:-z-where-x-y-"></a>Why does Cros fail to load with message "Incompatible libcros version. Client:x Min:y Max: z" where x &lt; y?</h3>This happens when the version of Cros in Chromium is too old for the version of Cros in Chromium OS. To fix this, make sure you build the latest Chromium.</div><div><br /></div></div><div><span style="font-size:small"><br /></span></div></span></span></div></span></span></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/chromium-os/chromiumos-design-docs/chromium-os-libcros">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9FyQ488IinEaJ1LS5V3twOlml-wRl2JdDuX5yYL0Z-WHLbkac4G6u4s9xFskn3DssZNXQEBicGnHBy1c7O0puHgv-qosSI--uw5cMYIHD5WIacBbx/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
