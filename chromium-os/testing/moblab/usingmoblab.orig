<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/testing","deleted":false,"title":"Testing Home","dir":"ltr"},{"path":"/chromium-os/testing/moblab","deleted":false,"title":"MobLab","dir":"ltr"},{"path":"/chromium-os/testing/moblab/usingmoblab","deleted":false,"title":"Using MobLab","dir":"ltr"}];
  var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttp://sites.google.com/a/chromium.org/dev/chromium-os/testing/moblab/usingmoblab\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"http://csi.gstatic.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["http://www.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["http://www.gstatic.com/sites/p/56e332/system/js/codemirror.js","http://www.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","http://www.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","http://www.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","http://www.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/testing/moblab","parentWuid":"wuid:gx:5588e293ccd896e3","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Using MobLab","locale":"en","wuid":"wuid:gx:6fbcf519a1a00e2f","revision":27,"path":"/chromium-os/testing/moblab/usingmoblab","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"usingmoblab","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Using MobLab - The Chromium Projects" />
<meta itemprop="name" content="Using MobLab - The Chromium Projects" />
<meta property="og:title" content="Using MobLab - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Using MobLab - The Chromium Projects</title>
<meta itemprop="image" content="http://www.chromium.org/_/rsrc/1406586416436/chromium-os/testing/moblab/usingmoblab/image03.png" />
<meta property="og:image" content="http://www.chromium.org/_/rsrc/1406586416436/chromium-os/testing/moblab/usingmoblab/image03.png" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="http://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="http://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/chromium-os" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="/chromium-os/testing" dir="ltr">Testing Home</A>‎ &gt; ‎<A href="/chromium-os/testing/moblab" dir="ltr">MobLab</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Using MobLab</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div>This section describes how to perform basic MobLab tasks. Full, detailed AFE documentation is available <a href="http://autotest.readthedocs.org/en/latest/main/frontend/Web/WebFrontendHowTo.html">here</a>.</div>
<div>
<div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Accessing-the-Moblab-Autotest-Frontend-AFE-"><strong>1 </strong>Accessing the Moblab Autotest Frontend (AFE)</a></li><li class="goog-toc"><a href="#TOC-Register-hosts"><strong>2 </strong>Register hosts</a></li><li class="goog-toc"><a href="#TOC-Running-Tests-from-the-AFE"><strong>3 </strong>Running Tests from the AFE</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Running-your-first-test-from-the-AFE"><strong>3.1 </strong>Running your first test from the AFE</a></li><li class="goog-toc"><a href="#TOC-Run-a-suite-of-tests-from-the-AFE"><strong>3.2 </strong>Run a suite of tests from the AFE</a></li><li class="goog-toc"><a href="#TOC-Setting-up-recurring-tests"><strong>3.3 </strong>Setting up recurring tests</a></li><li class="goog-toc"><a href="#TOC-Viewing-running-jobs-using-the-AFE"><strong>3.4 </strong>Viewing running jobs using the AFE</a></li><li class="goog-toc"><a href="#TOC-Viewing-results-from-the-AFE"><strong>3.5 </strong>Viewing results from the AFE</a></li></ol></li><li class="goog-toc"><a href="#TOC-Staging-Custom-Images-Client-side-Tests-on-MobLab"><strong>4 </strong>Staging Custom Images &amp; Client-side Tests on MobLab</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Overview"><strong>4.1 </strong>Overview</a></li><li class="goog-toc"><a href="#TOC-Requirements"><strong>4.2 </strong>Requirements</a></li><li class="goog-toc"><a href="#TOC-Usage"><strong>4.3 </strong>Usage</a></li><li class="goog-toc"><a href="#TOC-Building-a-custom-test-image"><strong>4.4 </strong>Building a custom test image</a></li><li class="goog-toc"><a href="#TOC-Staging-a-custom-image-on-a-local-MobLab"><strong>4.5 </strong>Staging a custom image on a local MobLab</a></li><li class="goog-toc"><a href="#TOC-Staging-an-official-image-with-custom-tests-on-a-local-MobLab"><strong>4.6 </strong>Staging an official image with custom tests on a local MobLab</a></li><li class="goog-toc"><a href="#TOC-Staging-a-custom-image-to-Google-Storage"><strong>4.7 </strong>Staging a custom image to Google Storage</a></li><li class="goog-toc"><a href="#TOC-Testing-the-custom-image"><strong>4.8 </strong>Testing the custom image</a></li></ol></li><li class="goog-toc"><a href="#TOC-Advanced:-Custom-Client-Side-Tests-Support"><strong>5 </strong>Advanced: Custom Client-Side Tests Support</a></li><li class="goog-toc"><a href="#TOC-Advanced-Tasks"><strong>6 </strong>Advanced Tasks</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Using-command-line-tools-to-run-tests"><strong>6.1 </strong>Using command line tools to run tests</a></li><li class="goog-toc"><a href="#TOC-Writing-Custom-Tests"><strong>6.2 </strong>Writing Custom Tests</a></li><li class="goog-toc"><a href="#TOC-Booting-from-a-Recovery-Image"><strong>6.3 </strong>Booting from a Recovery Image</a></li></ol></li><li class="goog-toc"><a href="#TOC-Advanced-Commands"><strong>7 </strong>Advanced Commands</a></li><li class="goog-toc"><a href="#TOC-Information-on-how-MobLab-works"><strong>8 </strong>Information on how MobLab works</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Bringing-up-the-test-environment"><strong>8.1 </strong>Bringing up the test environment</a></li><li class="goog-toc"><a href="#TOC-Automatic-updates"><strong>8.2 </strong>Automatic updates</a></li><li class="goog-toc"><a href="#TOC-Automatic-disk-space-management"><strong>8.3 </strong>Automatic disk space management</a></li></ol></li></ol></div></div></div></div></div>
<br />
</div>
<h2><a name="TOC-Accessing-the-Moblab-Autotest-Frontend-AFE-"></a>Accessing the Moblab Autotest Frontend (AFE)</h2>
<div>
<ol><li><span style="font-size:10pt;background-color:transparent">To access the AFE from the MobLab itself, go to http://localhost/ in a web browser.</span></li>
<li><span style="font-size:10pt;background-color:transparent">To access the AFE from any networked machine, go to http://&lt;moblab_server_IPaddress&gt; in a web browser, where moblab_server_IPaddress is the external IP address of the MobLab server (assigned by your ISP).</span></li>
<li><span style="font-size:10pt;background-color:transparent">SNAX directions for internal users at Google:  You may not be able to access the AFE from another machine using the directions above unless your machine is on the hub.</span></li>
</ol>
</div>
<h2><a name="TOC-Register-hosts"></a>Register hosts</h2>
<div>To enable viewing hosts and running tests on them in the AFE, you register each host to the application. To enable running test suites on a group of machines, you also assign a pool: label.</div>
<div>
<ol><li><span style="font-size:10pt;background-color:transparent">Check the IP address of each host (DUT) by running ifconfig at a bash command prompt on the host.  The IP address is assigned from a IP address pool of 192.168.231.100-199.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Open the AFE from a remote machine in a browser window.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Click the <i>Admin Interface</i> link at the top right of the page.
<div style="display:block;text-align:left"><a href="http://www.chromium.org/chromium-os/testing/moblab/usingmoblab/image03.png?attredirects=0" imageanchor="1"><img border="0" src="http://www.chromium.org/_/rsrc/1406586416436/chromium-os/testing/moblab/usingmoblab/image03.png" /></a></div>
</span></li>
<li><span style="font-size:10pt;background-color:transparent">In the Hosts row, click <i>Add</i>.
<div style="display:block;text-align:left"><a href="http://www.chromium.org/chromium-os/testing/moblab/usingmoblab/image00.png?attredirects=0" imageanchor="1"><img border="0" src="http://www.chromium.org/_/rsrc/1406586491644/chromium-os/testing/moblab/usingmoblab/image00.png" /></a></div>
</span></li>
<li><span style="font-size:10pt;background-color:transparent">Type the IP address of a host on the test subnet in the Hostname field.  Make sure that “Labels autodetection” is checked”.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Click <i>Save</i>.</span></li>
</ol>
</div>
<h2><a name="TOC-Running-Tests-from-the-AFE"></a>Running Tests from the AFE</h2>
<div><p>With Autotest, tests can run according to a schedule (recurring), or manually. Recurring tests are configured once and always use the latest Chrome OS Tip-of-Tree (ToT) test image.  Typically, you create and run a test manually before running it on a schedule.<br /> <br />(Advanced User) Additional information on Autotest:  For descriptions of each parameter in the Create Job view or details of how the Autotest scheduler runs jobs, click <a href="https://github.com/autotest/autotest#create-job-parameters">here</a>. </p><h3><a name="TOC-Running-your-first-test-from-the-AFE"></a>Running your first test from the AFE</h3></div>
<ol><li><span style="font-size:10pt;background-color:transparent">Click the tab to open the Create Job view. </span></li></ol><div><img height="217px;" src="https://lh6.googleusercontent.com/uzvjSG93eLzPxyVhvUfR5B7uMmrPHBfzqcMTkM7CCCXYbtxeUgkz--Ljjj66h57_IGjWRXJdmhu8OHITt7iEo-B5RXu_pg9So4mz1ozHgAUNLHmVzoLHrHLRzH012nr8FcsBj98" style="font-family:Arial;font-size:14.6666666666667px;white-space:pre-wrap;border:none;background-color:transparent" width="630px;" /><br />
<ol start="2"><li><span style="font-size:10pt;background-color:transparent">Type a name for the job. The string should be meaningful when viewing a list of jobs.</span></li>
</ol>
<span><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="215px;" src="https://lh5.googleusercontent.com/AvcqOIGQX9fPInMz9OqyWxLdYWui4sBGWhMNuRNl_YPhmdV6EW8YuaXIPMeGth6FZ-zuEMtLDMIdNDxfwUXsJByIpSdHBz8r2KV34ReBVCZRGuCjhajFfOXdhG6xhYHNWbEWE1A" style="border:none" width="624px;" /></span></span></div>
<div>
<ol start="3">
<li><span style="background-color:transparent">Type the name of the test image to use in the Image URL/Build field.  If no image is specified and you are not running a suite job, the latest ToT image is used. For some  tests Image URL/Build is a required field. In such cases add the release name here in the following format: &lt;board&gt;-release/RXX-YYYY.ZZ.0 eg. samus-release/R42-6812.88.0.<span style="font-size:10pt"> </span></span></li>
</ol>
<span><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="205px;" src="https://lh3.googleusercontent.com/yfgodZ-9F1DspaqoeRN2VsrDDtvwDo0b4ywnuTcTl0X7JAqwy4SvN-_s6U_Bc6m5LyihFrfReR-Hyy_VZwYvPgCfxBkDzyGzTNeIhftPKOKNCQ4_c0VjBvFX0IUARSPzJts7qYA" style="border:none" width="624px;" /></span></span><br />
<ol start="4"><li><span style="font-size:10pt;background-color:transparent">Select the tests to run. A good visual first test to try is <i>graphics_WebGLManyPlanetsDeep</i></span></li>
</ol>
<span><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="284px;" src="https://lh5.googleusercontent.com/5piJvpppXmCes1RUfBG6_X8qpcrMiLBjQxoBqqT5n8XIWXCXUqTYYstoaN1dltKz-8eBcCnsTS5-CpQL7A1iFf8TBAQcNawF1vpjSLaH4GZw6yH3Wu9hJV9h8kzISm5D4z73M3Y" style="border:none" width="624px;" /></span></span><i><br />
</i>
<ol start="5">
<li><span style="font-size:10pt;background-color:transparent">Click the names of registered hosts for running the tests.</span></li>
</ol>
<span><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="359px;" src="https://lh6.googleusercontent.com/xg9cGvVKztPKI1aJ3gBU94qeqxDlaPGxfHUGEZF5bQjqSLJoV__wb9syGp0OTzavWxr21ixi7FHROHC6e8-Be1vc2XjFAlYrIOdnL7gclsbTnHFEheikUoJvENSEWYI8KxfrTMQ" style="border:none" width="624px;" /></span></span><br />
<ol start="6">
<li><span style="font-size:10pt;background-color:transparent">Click <i>Submit Job</i>.</span></li>
</ol>
<span><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="273px;" src="https://lh5.googleusercontent.com/l6pWDLZGt-KUto8yDuoocnduuvJu76fg-jzEiAw32f0-kucgNZRTuNtUciQk0sNJUL-O3uvzQDfT_veKC3DZpZC7TW3xxA-em7Kn8nqSpfyAOjc_cAW8e3_eXDiv-dGu3JWr7rM" style="border:none" width="624px;" /></span></span></div><h3><a name="TOC-Run-a-suite-of-tests-from-the-AFE"></a>Run a suite of tests from the AFE</h3><span style="font-size:10pt;background-color:transparent"><ol><li><span style="font-size:10pt;background-color:transparent">Click the tab to open the Create Job view.</span></li><li><span style="font-size:13.3333330154419px;background-color:transparent">Type a name for the job. The string should be meaningful when viewing a list of jobs.</span></li><li><span style="font-size:13.3333330154419px;background-color:transparent">(Optional) Type the name of the test image to use in the Image URL/Build field . For example, mario-release/R45-7141.0.0</span></li><li><span style="font-size:10pt;background-color:transparent">Select Server from the Test type dropdown list.</span></li></ol><span style="font-weight:normal"><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="253px;" src="https://lh6.googleusercontent.com/1HhqN4WboYRqgPM8AwuLJaEjE09PRQmMlsZ49b98Iz273o6zkQwx5RVk2w-hCofSWImWwr8sV7N4ArNvZCd3Nk0NfKMLycMuwzUybMOac8fnd0gJDZk12-95oJt5MDfAS4H80Uo" style="border:none" width="624px;" /></span></span><ol start="5"><li style="font-size:13.3333330154419px;font-weight:normal"><span style="font-size:10pt;background-color:transparent">Select test suites to run.</span></li></ol><span style="font-weight:normal"><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="425px;" src="https://lh5.googleusercontent.com/UTsRyMqB9qV9ZrX9H1ShcshoNLNW4Y31vw4Yoq8u5x5ZEXr59n8SF-09TY6E0-cZerDgpapoadyr6npqM5S4qWsvMVK1IkMvW2oCEv6M8gnt8joQ_2O_SdbXnoX6Sxpym84eGtA" style="border:none" width="624px;" /><br /></span></span><span style="font-size:10pt;font-weight:normal;background-color:transparent"> </span><ol start="6"><li style="font-size:13.3333330154419px;font-weight:normal"><span style="font-size:13.3333330154419px;background-color:transparent">If you select a suite, the hostless (suite job) attribute will automatically be selected in the “Advanced Options” section.</span></li></ol><span style="font-weight:normal"><span style="font-size:14.6666666666667px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="284px;" src="https://lh4.googleusercontent.com/LfSmXmxS30xuQWtvx_Hcbr1xjCkOLwjCO3nbm_maaredwub081qrZS8GgrvPV59cQURIiRpyjirdKnWrujR6Ly_s3-sQFhwsrIAIIcvphKTD0v0wo3T1eRhC4Ee4MShzZGIuK9o" style="border:none" width="624px;" /></span></span><ol start="7"><li style="font-size:13.3333330154419px;font-weight:normal"><span style="font-size:10pt;background-color:transparent">Click <i>Submit Job</i>.</span></li></ol></span><h3><a name="TOC-1"></a>
</h3>
<h3><a name="TOC-Setting-up-recurring-tests"></a>Setting up recurring tests</h3>
<div>
<ol><li><span style="font-size:10pt;background-color:transparent">Configure the job in the Create Job view and click Submit Job.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Click the job in the Job List view.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Click the <i>Create recurring job</i> button.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Specify a start time, a delay between each run, and the number of times to run the test.</span></li>
<li><span style="font-size:10pt;background-color:transparent">Click <i>Create recurring job</i>.</span></li>
</ol>
</div>
<div>
<ol>
</ol>
</div>
<h3><a name="TOC-Viewing-running-jobs-using-the-AFE"></a>Viewing running jobs using the AFE</h3>
<div><span style="font-size:10pt;background-color:transparent">
<div style="display:block;text-align:left"><a href="http://www.chromium.org/chromium-os/testing/moblab/usingmoblab/image02.png?attredirects=0" imageanchor="1"><img border="0" src="http://www.chromium.org/_/rsrc/1406590560196/chromium-os/testing/moblab/usingmoblab/image02.png" /></a></div>
When you access the AFE, the default view is Job List. It provides a list of jobs on the MobLab server owned by the current user. Other available views are tabs in the horizontal navigation bar.</span></div>
<div>
<ul><li><span style="font-size:10pt;background-color:transparent">To see jobs owned by all users, click the <i>All users</i> option for Owner.</span></li>
<li><span style="font-size:10pt;background-color:transparent">To see jobs with a specific status, select Queued Jobs, Running Jobs, or Finished Jobs below the horizontal navigation bar.</span></li></ul>
</div>
<div>The following table lists views and gives a description of each:</div>
<div>
<table border="1" bordercolor="#888" cellspacing="0" style="border-collapse:collapse;border-color:rgb(136,136,136);border-width:1px">
<tbody>
<tr>
<td style="width:132px;height:20px">View Name</td>
<td style="width:376px;height:20px">Description</td>
</tr>
<tr>
<td style="width:132px;height:31px">Job List</td>
<td style="width:376px;height:31px">List of all jobs on the MobLab server, including job ID, name, status.</td>
</tr>
<tr>
<td style="width:132px;height:14px"> View Job</td>
<td style="width:376px;height:14px"> Detailed view of the selected job.</td>
</tr>
<tr>
<td style="width:132px;height:14px"> Recurring Job</td>
<td style="width:376px;height:14px">Form for scheduling and cancelling recurring tests. </td>
</tr>
<tr>
<td style="width:132px;height:14px">Create Job </td>
<td style="width:376px;height:14px"> Form for configuring and running manual tests.</td>
</tr>
<tr>
<td style="width:132px;height:14px">Host List </td>
<td style="width:376px;height:14px">List of all host currently on the test subnet. </td>
</tr>
<tr>
<td style="width:132px;height:14px">View Host </td>
<td style="width:376px;height:14px">List of all test jobs run on the selected host. </td>
</tr>
<tr>
<td style="width:132px;height:14px"> User Preferences</td>
<td style="width:376px;height:14px"> </td>
</tr>
</tbody>
</table>
</div>
<div><br />
</div>
<h3><a name="TOC-Viewing-results-from-the-AFE"></a>Viewing results from the AFE</h3>
<div>Click the line for the job in the Job List view.  The detail record contains the results of the test run.</div>
<div><br />
</div>
<div>To view a full test report, with details and a test matrix, click the <i>Open in new window</i> link.</div>
<div><br />
<div style="display:block;text-align:left"><a href="http://www.chromium.org/chromium-os/testing/moblab/usingmoblab/image01.png?attredirects=0" imageanchor="1"><img border="0" src="http://www.chromium.org/_/rsrc/1406590590432/chromium-os/testing/moblab/usingmoblab/image01.png" /></a></div>
</div>
<div><br />
</div><div><br /></div><div><h2><a name="TOC-Staging-Custom-Images-Client-side-Tests-on-MobLab"></a><span>Staging Custom Images &amp; Client-side Tests on MobLab</span></h2><div><table cellspacing="0" style="width:1076px"><tbody><tr><td><div dir="ltr"><h3><a name="TOC-Overview"></a>Overview</h3><h2><a name="TOC-Overview"></a></h2><div>MobLabs allow Chrome OS partners to do the same testing Google does in-house at their locations. Previously MobLab only supported testing on Chrome OS images built by Google.</div><div><br /></div><div>Now with a new <code>cros stage</code> tool, MobLab users can test their own locally built (or other custom images), eliminating the need for changes to be submitted to the main ChromeOS tree prior to testing. </div><div><br /></div><div>Users will be able to push custom images directly to a local MobLab or to Google Storage for remote MobLabs to access.</div><div><br /></div><div>A key feature of <code>cros stage</code> is that client side tests will always from the chroot from where <code>cros stage</code> is being called.  This allows users to run locally written tests on both locally-built builds as well as official CrOS builds stored in their Google Cloud bucket.</div><h3><a name="TOC-Requirements"></a>Requirements</h3><h2><a name="TOC-Requirements"></a></h2><div><ul><li><span style="font-size:10pt;background-color:transparent">A MobLab running version R42-6715.0.0 or newer. Your MobLab should autoupdate to this version or a newer one automatically.</span></li><ul><li><span style="font-size:10pt;background-color:transparent">To check your MobLab version:</span></li><ul><li><span style="font-size:10pt;background-color:transparent">Log in via the UI and navigate to ‘chrome://chrome’ in the browser.</span></li><li><span style="font-size:10pt;background-color:transparent">SSH in and run `cat /etc/lsb-release | grep CHROMEOS_RELEASE_DESCRIPTION’</span></li></ul></ul><li><span style="font-size:10pt;background-color:transparent">An up-to-date chroot that has access to the ‘cros stage’ tool. Repo sync’ing the whole tree or the chromite/ directory to tip of tree will provide the tool.</span></li><li><span style="font-size:10pt;background-color:transparent">For uploading to Google Storage, a private Google Storage Bucket and a corresponding boto key are required. Partners should have received this from their Google Partner Engineering Representative.</span></li></ul></div><h3><a name="TOC-Usage"></a>Usage</h3><h2><a name="TOC-Usage"></a></h2><h3><a name="TOC-Building-a-custom-test-image"></a>Building a custom test image</h3><div>In order to test a locally built test image you must first build one in the chroot. Instructions for this can be found in the <a href="http://www.chromium.org/chromium-os/developer-guide">Chromium OS developer guide</a>.</div><p><span style="font-size:10pt;background-color:transparent"><b>Notes</b></span></p><h4><a name="TOC-Notes"></a></h4><div><ul><li><span style="font-size:10pt;background-color:transparent">Only test images are supported, using a Non-Test image will make your DUT unable to be tested in the future and will require manual reformatting.</span></li><li><span style="font-size:10pt;background-color:transparent">The autotest bits used to test this image will be the latest in your build sysroot! I.E. if you emerge new autotest changes after producing the image you wish to stage, these changes will not match.</span></li></ul></div><h3><a name="TOC-Staging-a-custom-image-on-a-local-MobLab"></a>Staging a custom image on a local MobLab</h3><div>To stage on a local MobLab that is accessible by your chroot you simply use the ‘cros stage’ command:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>cros stage &lt;/path/to/board/build/chromiumos-test-image.bin&gt; &lt;MobLab IP address&gt;</code></div></div><p><b>Example:</b></p><h4><a name="TOC-Example:"></a></h4><div>In this example I am pushing an image I built in my chroot to the MobLab device.</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>~/trunk/src/scripts $ cros stage ../build/images/peppy/R41-6576.0.2014_12_12_1535-a1/chromiumos_test_image.bin 100.XX.XX.XX</code></div></div><div><br /></div><div>The path requires the format of <code>/board/build/chromiumos-test-image.bin</code>.</div><div><br /></div><div>Once completed ‘cros stage’ will output the name of the image to use when kicking off tests via the run_suite command or the AFE. For this example: <code>peppy-custom/R41-6576.0.2014_12_12_1535</code></div><p><b>Notes:</b></p><h4><a name="TOC-Notes:"></a></h4><div><ul><li><span style="font-size:10pt;background-color:transparent">The custom image will only stay on the Moblab device for 24 hours at which point it will be automatically wiped.</span></li></ul></div><h3><a name="TOC-Staging-an-official-image-with-custom-tests-on-a-local-MobLab"></a>Staging an official image with custom tests on a local MobLab</h3><div>You can also stage official images from Google Storage with test packages from your chroot onto a local Moblab.  The command, <code>cros stage</code> always pulls test packages from the chroot regardless of the image source.</div><div><br /></div><div>For this work flow, <b>you must have previously built an image for this board at some point</b>. For information about doing custom test development please refer to the Advanced:  Custom Client-Side Tests Support.</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>cros stage gs://&lt;bucket-name&gt;/&lt;board&gt;-&lt;builder type&gt;/&lt;build name&gt;/ &lt;MobLab IP address&gt;</code></div></div><div><br /></div><p><b>Example:</b></p><h4><a name="TOC-Example:1"></a></h4><div>In this example I am pushing an official image with test packages built in my chroot to the MobLab device.  I would have already built a squawks test image at some point.</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>~/trunk/src/scripts $ cros stage gs://chromeos-image-archive/squawks-release/R42-6750.0.0 100.XX.XX.XX</code></div></div><div><br /></div><div>Once completed <code>cros stage</code> will output the name of the image to use when kicking off tests. For this example: squawks-custom/R42-6570.0.0</div><div><br /></div><h3><a name="TOC-Staging-a-custom-image-to-Google-Storage"></a>Staging a custom image to Google Storage</h3><div>You can also push images to Google Storage. The advantages to this is that the image will not be deleted for 24 hours, and that remote MobLab’s not in the same local network can access the image as well.</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>cros stage  &lt;/path/to/board/build/chromiumos-test-image.bin&gt; &lt;gs_base_path&gt;    --boto_file=&lt;boto_file_path&gt;</code></div></div><div><br /></div><p><b>Example:</b></p><h4><a name="TOC-Example:2"></a></h4><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>cros stage ../build/images/peppy/R41-6576.0.2014_12_12_1535-a1/chromiumos_test_image.bin gs://chromeos-moblab-peppy --boto_file=~/peppy.boto</code></div><div></div></div><br /><div>Once completed ‘cros stage’ will output the name of the image to use when kicking off tests just like when staging on a local MobLab.</div><div><br /></div><h3><a name="TOC-Testing-the-custom-image"></a>Testing the custom image</h3><div>Simply <a href="http://www.chromium.org/chromium-os/testing/moblab/usingmoblab">run a test like you would do before</a> but specify the outputted image name when launching the test:</div><div><br /></div><div><br /></div><div><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap;background-color:transparent"><img height="400" src="https://lh6.googleusercontent.com/xPeyqBJyhVqwSAUZVVYlXOKhitvCQdP_C99VsLOvck1JvVuDjp1-5ECMgw96irxNX5v6BZkzMFaBlzPtIZUJDASOtEdP4JGzlPW1elNd_aHNdkdfiEkW-hrB-c5NC-UgJ1E" style="border:none" width="392" /></span></div><h2><a name="TOC-Advanced:-Custom-Client-Side-Tests-Support"></a>Advanced: Custom Client-Side Tests Support</h2><div><i>NOTE: Custom Client-Side Tests Workflow is only supported when using cros stage with a Moblab address and NOT when using an Google Storage URL as the staging destination.</i></div><div><br /></div><div>Cros Stage also enables developer to run Custom Client Side Tests on their MobLab. It does this by packaging up the tests that are built and stored in the board’s buildroot (/build/&lt;board&gt;/) of the chroot.</div><div><br /></div><div><ol><li><span style="font-size:10pt;background-color:transparent">First make your test changes in the autotest repo (src/third_party/autotest/files).</span></li><li><span style="font-size:10pt;background-color:transparent">If this is a new test, add it to an ebuild to ensure it is built at build time.</span></li><ul><li><span style="font-size:10pt;background-color:transparent">Look at <code>src/third_party/chromiumos-overlays/chromeos-base/autotest-tests*</code> ebuilds for examples.</span></li></ul><li><span style="font-size:10pt;background-color:transparent">If this is an existing test, note the ebuild it belongs to.</span></li><ul><li><span style="font-size:10pt;background-color:transparent"><code>grep -r *&lt;test_name&gt;* src/third_party/chromiumos-overlays/chromeos-base</code></span></li></ul><li><span style="font-size:10pt;background-color:transparent">Build your test changes. From a chroot:</span></li><ul><li><span style="font-size:10pt;background-color:transparent"><code>cros_workon start --board=&lt;board&gt; &lt;ebuild-name&gt;</code></span></li><li><span style="font-size:10pt;background-color:transparent"><code>emerge-&lt;board&gt; &lt;ebuild-name&gt;</code></span></li></ul><li><span style="font-size:10pt;background-color:transparent">Run cros stage from the chroot to stage your image and test packages.</span></li><ul><li><span style="font-size:10pt;background-color:transparent"><code>cros stage ../build/images/peppy/R41-6576.0.2014_12_12_1535-a1/chromiumos_test_image.bin 100.XX.XX.XX</code></span></li></ul></ol></div><div>Note you do not need to build a new image. Therefore you can use the same image repeatedly while doing test development.</div><div><br /></div><div>For more information:</div><div><ul><li><span style="font-size:10pt;background-color:transparent"><a href="http://www.chromium.org/chromium-os/testing/autotest-developer-faq" target="_blank">Autotest Developer Guide</a></span></li><li><span style="font-size:10pt;background-color:transparent"><a href="http://www.chromium.org/chromium-os/testing/test-code-labs/autotest-client-tests" target="_blank">Autotest Client Side Tests Codelab</a></span></li></ul><div><br /></div></div><div><h2><a name="TOC-Advanced-Tasks"></a>Advanced Tasks</h2><h3><a name="TOC-Using-command-line-tools-to-run-tests"></a>Using command line tools to run tests</h3><div style="font-size:13.3333px">You can also use the Autotest command line interface (CLI) to run manual tests. The following Python utilities are available to MobLab users for running tests:</div><div style="font-size:13.3333px"><ul><li><span style="font-size:10pt;background-color:transparent">atest</span></li><li><span style="font-size:10pt;background-color:transparent">run_suite</span></li></ul></div><div style="font-size:13.3333px">For a more extensive list, click <a href="http://www.chromium.org/chromium-os/testing/moblab/additional.1442602102764#TOC-Advanced-Commands">here</a>.</div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">To run a test or test suite from the command line, use the following syntax:</div><div style="font-size:13.3333px"><code>run_suite.py --board=&lt;board_name&gt; --build=&lt;build_name&gt; --suite_name=&lt;suite_name&gt; --pool=””</code></div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">For example:</div><div style="font-size:13.3333px"><code>run_suite.py --board=peppy --build=peppy-release/R37.5847.0.0 --suite_name=smoke --pool=””</code></div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">To obtain the names of test builds, use gsutil to browse your Google Cloud Storage bucket.</div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">You can check job status and results through the AFE. <a href="https://www.google.com/url?q=https%3A%2F%2Fgithub.com%2Fautotest%2Fautotest&amp;sa=D&amp;sntz=1&amp;usg=AFQjCNFXufMJzgj2QOPHmf0jMptdnvEaww" target="_blank">This page</a> describes the status values for hosts and jobs.</div><h3><a name="TOC-Writing-Custom-Tests"></a>Writing Custom Tests</h3><div style="font-size:13.3333px">The MobLab server runs the <a href="https://chromium.googlesource.com/chromiumos/third_party/autotest/" target="_blank">open source git Autotest framework</a>. The framework supports writing custom tests in Python using the Autotest APIs.</div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">For details and examples of coding to the Autotest APIs, view the <a href="http://autotest.readthedocs.org/en/latest/" rel="nofollow" target="_blank">general user documentation</a>.  Please note that although MobLab uses the Autotest framework, code refactoring has made it so that many examples do not work with our code base. However, many of these documents are still helpful at a high level.  </div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">Chromium OS-specific information can be found <a href="http://www.chromium.org/chromium-os/testing/autotest-user-doc" target="_blank">here</a> and our repo is located <a href="https://chromium.googlesource.com/chromiumos/third_party/autotest/" target="_blank">here</a>.</div><h3><a name="TOC-Booting-from-a-Recovery-Image"></a>Booting from a Recovery Image</h3><div style="font-size:13.3333px">If the MobLab server hangs and the device can’t be manually rebooted, it is possible to boot from a recovery image. For Chrome OS partners who have deployed MobLab, the recovery image is located in a folder in Google Cloud Storage. It is not generally available on the Chrome OS image release site.  </div><div style="font-size:13.3333px"><span style="font-size:10pt;background-color:transparent"><br /></span></div><div style="font-size:13.3333px"><span style="font-size:10pt;background-color:transparent">To boot MobLab from a recovery image:</span></div><div style="font-size:13.3333px"><ol><li><span style="font-size:10pt;background-color:transparent">Copy the MobLab recovery image to a USB memory stick using cros flash:  </span><span style="font-size:10pt;background-color:transparent"><code>cros flash usb:// remote/stumpy_moblab/latest-dev/recovery</code></span></li><li><span style="font-size:10pt;background-color:transparent">This example copies the latest recovery image in the dev channel to a USB drive.</span></li><li><span style="font-size:10pt;background-color:transparent">From the MobLab device (in Developer Mode), press <code>Ctrl-Alt-F2</code> to switch to the second virtual terminal.</span></li><li><span style="font-size:10pt;background-color:transparent">Run <code>crossystem dev_boot_usb=1</code>.</span></li><li><span style="font-size:10pt;background-color:transparent">Reboot the MobLab device.</span></li><li><span style="font-size:10pt;background-color:transparent">Insert the USB memory stick with the recovery image into an open USB port on the MobLab device.</span></li><li><span style="font-size:10pt;background-color:transparent">When Chrome OS displays the Developer Mode screen, press Ctrl-U to boot from a USB device</span></li></ol></div><h2><a name="TOC-Advanced-Commands"></a>Advanced Commands</h2><p style="font-size:13.3333px">These commands have been added to the MobLab user profile so you can run them anywhere on the system. Please note that this list is valid as of version 6343.</p><ul style="font-size:13.3333px"><li><strong>run_suite.py </strong>- Command line tool for creating suite jobs.<ul><li>Example: <code>run_suite.py --board=peppy --build=peppy-release/R37.5847.0.0 --suite_name=smoke --pool=””</code></li></ul></li><li><strong>atest </strong>- Autotest command line tool able to add and edit hosts, labels and jobs in the database directly. For more information use --help option. Help is available for all the possible subcommands.</li><li><strong>host_add </strong>- Add a test device. Shortcut for <strong>atest host create</strong><ul><li>example: <code>host_add 192.168.231.100</code></li></ul></li><li><strong>host_delete </strong>- Delete a test device. Shortcut for <strong>atest host delete</strong><ul><li>exam&lt;/li&gt;&lt;/ul&gt;ple: <code>host_delete 192.168.231.100</code></li></ul></li><li><strong>label_create </strong>- Create a new label. Shortcut for <strong>atest label create</strong><ul><li>example: <code>label_create board:peppy</code></li></ul></li><li><strong>label_delete </strong>- Delete a label. Shortcut for <strong>atest label delete</strong><ul><li>example: <code>label_delete board:peppy</code></li></ul></li><li><strong>label_add </strong>- Add a label to a machine. Shortcut for <strong>atest label add</strong><ul><li>example: <code>label_add board:peppy -m 192.168.231.100</code></li></ul></li><li><strong>abort_jobs </strong>- Abort queued or running jobs. Shortcut for <strong>atest job abort</strong><ul><li>example: <code>abort_jobs 50 51 52</code></li></ul></li><li><strong>edit_moblab_config </strong>- Open vi to edit moblab’s shadow_config.</li><li><strong>import_tests - </strong>Import any new tests located in /usr/local/autotest/{client,server}/site_tests so that they can be run from the AFE. Note: These custom tests in these directories will be overwritten if MobLab is powerwashed or if a new test with the same name is checked into the source.</li></ul><h2><a name="TOC-Information-on-how-MobLab-works"></a>Information on how MobLab works</h2><h3><a name="TOC-Bringing-up-the-test-environment"></a>Bringing up the test environment</h3><div style="font-size:13.3333px">After MobLab is connected to a network and booted, the MobLab server performs the following network configuration tasks:</div><div style="font-size:13.3333px"><a href="http://www.chromium.org/chromium-os/testing/moblab/additional.1442602102764/image00.png.1442602102750?attredirects=0" imageanchor="1"><img border="0" src="https://sites.google.com/a/chromium.org/dev/_/rsrc/1406586098467/chromium-os/testing/moblab/additional/image00.png" /></a></div><div style="font-size:13.3333px"><ol><li><span style="font-size:10pt;background-color:transparent">Connects to the test subnet through a USB Ethernet adapter.</span></li><li><span style="font-size:10pt;background-color:transparent">Requests subnet addresses 192.168.231.x from the DHCP server.</span></li><li><span style="font-size:10pt;background-color:transparent">Configures a static IP address for the MobLab server of 192.168.231.1 through the USB Ethernet adapter.</span></li><li><span style="font-size:10pt;background-color:transparent">Connects to the corporate network through the on-device Ethernet port.</span></li><li><span style="font-size:10pt;background-color:transparent">Obtains an IP address from the DHCP server on the corporate network. This is the external IP address of the MobLab server.</span></li><li><span style="font-size:10pt;background-color:transparent">Configures a gateway service for host Internet access.</span></li><li><span style="font-size:10pt;background-color:transparent">Enables IP forwarding.</span></li><li><span style="font-size:10pt;background-color:transparent">Adds a NAT module to the Chrome OS kernel.</span></li><li><span style="font-size:10pt;background-color:transparent">Enables automatic updates of Chrome OS and the test suite.</span></li><li><span style="font-size:10pt;background-color:transparent">Uses SSH to configure the server settings.</span></li></ol></div><div style="font-size:13.3333px">One or more hosts are connected to the test subnet by either a switch or a hub. MobLab communicates with the test subnet using the USB Ethernet adapter. When the MobLab server boots up, it waits up to 5 minutes to establish an SSH connection through the USB adapter and subnet. Then it assigns dynamic IP addresses to all hosts, ranging from 192.168.231.100 to 192.168.231.199.</div><div style="font-size:13.3333px"><br /></div><div style="font-size:13.3333px">Access to the partner’s corporate network enables automatic software updates for the MobLab server. It also enables access to Google Cloud Storage for downloading test images and server updates, and uploading logs. The corporate network should provide security features (firewall, VPN, etc.) to protect MobLab and the test subnet from potential attacks from outside the lab.</div><h3><a name="TOC-Automatic-updates"></a>Automatic updates</h3><div style="font-size:13.3333px">The Autotest scheduler manages and coordinates build updates. On each MobLab device, it manages two separate types of build images:</div><div style="font-size:13.3333px"><ul><li><span style="font-size:10pt;background-color:transparent">The MobLab server image</span></li><li><span style="font-size:10pt;background-color:transparent">Test images, for pushing to hosts</span></li></ul></div><div style="font-size:13.3333px">The scheduler waits for a time of low or no activity on the MobLab server to update the test image. If tests are running when an image is updated, they continue to run.</div><h3><a name="TOC-Automatic-disk-space-management"></a>Automatic disk space management</h3><div style="font-size:13.3333px">After tests run, the Autotest logs are archived in your private Google Cloud Storage bucket. MobLab runs a log cleanup script as a background process and every 12 hours the script removes log files, making space for more test results.</div><br style="font-size:13.3333px" /><div style="font-size:13.3333px">By default, test logs are visible to the Chrome OS team at Google. If specific tests contain confidential data, you can control access to those test logs.</div></div></div></td></tr></tbody></table></div><div><div></div><div><div><div></div></div></div></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/chromium.org/dev/chromium-os/testing/moblab/usingmoblab">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9PzATIW9PI-w7BLWQidzDruandSHjuOdoM_nxXuU6vq3CpEI3l2dKgDzAaCBnORgaGVzZPHYTdDOP-jewUabCCbQA-MWrxHFMD98DYr6LiMRzF_uX/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
