<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="http://www.chromium.org/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/testing","deleted":false,"title":"Testing Home","dir":"ltr"},{"path":"/chromium-os/testing/test-code-labs","deleted":false,"title":"Test Code Labs","dir":"ltr"},{"path":"/chromium-os/testing/test-code-labs/server-side-test","deleted":false,"title":"Server Side Test for Chromium OS Autotest Codelab","dir":"ltr"}];
  var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttp://sites.google.com/a/chromium.org/dev/chromium-os/testing/test-code-labs/server-side-test\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"http://csi.gstatic.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["http://www.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["http://www.gstatic.com/sites/p/56e332/system/js/codemirror.js","http://www.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","http://www.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","http://www.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","http://www.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/testing/test-code-labs","parentWuid":"wuid:gx:80a620e4fb3984","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Server Side Test for Chromium OS Autotest Codelab","locale":"en","wuid":"wuid:gx:153ab4e4d064ed7b","revision":15,"path":"/chromium-os/testing/test-code-labs/server-side-test","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"server-side-test","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Server Side Test for Chromium OS Autotest Codelab - The Chromium Projects" />
<meta itemprop="name" content="Server Side Test for Chromium OS Autotest Codelab - The Chromium Projects" />
<meta property="og:title" content="Server Side Test for Chromium OS Autotest Codelab - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="http://www.chromium.org/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="http://www.chromium.org/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Server Side Test for Chromium OS Autotest Codelab - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="http://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="http://www.chromium.org/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="http://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="http://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../../Home.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../../chromium-os.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../../developers/discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../../../chromium-os.html" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="../../testing.html" dir="ltr">Testing Home</A>‎ &gt; ‎<A href="http://www.chromium.org/chromium-os/testing/test-code-labs" dir="ltr">Test Code Labs</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Server Side Test for Chromium OS Autotest Codelab</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><b>
<b>
<b style="font-weight:normal;font-size:medium;font-family:Times New Roman"><b style="font-size:medium;font-weight:normal">
<div style="display:inline!important"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-References"><strong>1 </strong>References</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Overview"><strong>2 </strong>Overview</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Prerequisite"><strong>3 </strong>Prerequisite</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Difference-between-client-and-server-test"><strong>4 </strong>Difference between client and server test</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Create-a-new-server-side-test"><strong>5 </strong>Create a new server side test</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-Syntax-and-style-guide"><strong>5.1 </strong>Syntax and style guide</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-1.-Name-your-test"><strong>5.2 </strong>Step 1. Name your test</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-2.-Create-a-barebone-server-side-test"><strong>5.3 </strong>Step 2. Create a barebone server side test</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-Step-2.1.-Create-a-Control-file"><strong>5.3.1 </strong>Step 2.1. Create a Control file</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-2.2.-Create-a-test-wrapper"><strong>5.3.2 </strong>Step 2.2. Create a test wrapper</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-version"><strong>5.3.2.1 </strong>version</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-initialize"><strong>5.3.2.2 </strong>initialize</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-setup"><strong>5.3.2.3 </strong>setup</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-run_once"><strong>5.3.2.4 </strong>run_once</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-cleanup"><strong>5.3.2.5 </strong>cleanup</a></li></ol></li></ol></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-3.-Running-the-server-side-test"><strong>5.4 </strong>Step 3. Running the server-side test</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-Run-Autotest-manually"><strong>5.4.1 </strong>Run Autotest manually</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Add-test-to-an-existing-test-suite"><strong>5.4.2 </strong>Add test to an existing test suite</a></li></ol></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.-Implement-test-logic-in-test-wrapper"><strong>5.5 </strong>Step 4. Implement test logic in test wrapper</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.1.-Import-modules-useful-for-Chromium-OS-specific-test"><strong>5.5.1 </strong>Step 4.1. Import modules useful for Chromium OS specific test</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.3.-Get-Set-brightness"><strong>5.5.2 </strong>Step 4.3. Get/Set brightness</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.4.-Actions-being-taken-during-the-test"><strong>5.5.3 </strong>Step 4.4. Actions being taken during the test</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.5.-Disable-ALS-Auto-Light-Sensor-"><strong>5.5.4 </strong>Step 4.5. Disable ALS(Auto Light Sensor)</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.6.-Run-test-and-validate-test-results"><strong>5.5.5 </strong>Step 4.6. Run test and validate test results</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Step-4.7.-Cleanup"><strong>5.5.6 </strong>Step 4.7. Cleanup</a></li></ol></li></ol></li><li class="goog-toc"><a href="server-side-test.html#TOC-Verify-Test-by-Running-Autotest-Manually"><strong>6 </strong>Verify Test by Running Autotest Manually</a></li><li class="goog-toc"><a href="server-side-test.html#TOC-Possible-failure-scenarios"><strong>7 </strong>Possible failure scenarios</a><ol class="goog-toc"><li class="goog-toc"><a href="server-side-test.html#TOC-Device-failed-to-reboot"><strong>7.1 </strong>Device failed to reboot</a></li></ol></li></ol></div></div></div></div></div>
</b></b>
<br />
<h2 style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-References"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">References</span></h2>
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="http://www.chromium.org/chromium-os/testing/autotest-best-practices"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest Best Practices </span></a></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="../autotest-developer-faq.html#TOC-Writing-Autotests"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Writing Autotests</span></a></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="https://wiki.corp.google.com/twiki/bin/view/Codelab/WritingAutotestTests"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Codelab for Writing an Autotest Test</span></a><span style="vertical-align:baseline;white-space:pre-wrap"> - This is a codelab teaching you how to write a generic test for Autotest.</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="../autotest-user-doc.html"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest for Chromium OS developers</span></a></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="../../developer-guide.html"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Chromium OS Developer Guide</span></a><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
</li>
</ol>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Overview"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Overview</span></h2>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">In this codelab, you will build a server-side Autotest to test if the backlight brightness is restored to the original value on a device after the following operations:</span></p>
<br />
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt;display:inline!important"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;display:inline!important"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt;display:inline!important"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> user is logged out and logged back in</span></p></li></ol></li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">device is suspended and resumed</span></p>
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />
</span></p>
</li>
</ol>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Prerequisite"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Prerequisite</span></h2>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">This Codelab is for Chromium OS developers and testers to learn how to write a server side Autotest. Assumptions:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">You know the Python programming language.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">You have a device under test (DUT) with a test image installed. See </span><a href="../../developer-guide.html#TOC-Installing-Chromium-OS-on-your-Device"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Chromium OS Developer Guide</span></a><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> for details.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">You have Chromium OS development environment setup, see </span><a href="../../developer-guide.html#TOC-Get-the-Source"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Chromium OS Developer Guide</span></a><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> for details.</span></p>
</li></ul>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:19px;font-family:Arial;background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">Objectives</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">By the end of this lab, you will know how to:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Write Chromium OS server side Autotest in Python</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Manually run the server side Autotest against a DUT</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Automatically run test as part of a suite</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
</li></ul>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Difference-between-client-and-server-test"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Difference between client and server test</span></h2>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest has a notion of both client-side tests and server-side tests. All tests are managed by an Autotest server machine that is typically the machine where <a href="http://go/cros-test_that" target="_blank">test_that</a> </span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">is invoked. test_that (can be found in folder scripts) is a script to run autoserv process which deploys and executes tests on remote machines.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Code in a client-side test runs only on the device under test (DUT), and as such isn’t capable of maintaining state across reboots, handling a failed suspend/resume, or the like.  If possible, an Autotest should be written as a client-side test, as it’s simpler and more reusable. Code lab for client side test can be found <a href="autotest-client-tests.html" target="_blank">here</a>.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">A ‘server’ test runs on the Autotest server, and gets assigned a DUT, just like a client-side test.  It can use various Autotest primitives (and library code written by the CrOS team) to manipulate that device.  Most, if not all, tests that use <a href="../../servo.html">Servo</a> or remote power management should be written as server-side tests. As a good example, if the DUT needs to be rebooted during the test, it should be a server-side test. </span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Tests are located in 4 locations in the chromeos_public </span><a href="https://cs.corp.google.com/#chromeos_public/src/third_party/autotest/files/"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">third_party/autotest/files/</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> tree:</span></p>
<br />
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">client/site_tests - These are where most tests live. These are client tests that are Chromium OS specific.</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">client/tests - These are client tests that come from upstream Autotest, and most are general Linux tests (not Chromium OS specific).</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">server/site_tests - These are server tests that are Chromium OS specific.</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">server/tests - These are server tests that are general Linux tests (not Chromium OS specific).</span></p>
</li>
</ol>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Decide if your test is a client or server test and choose the appropriate directory from the above. </span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Create-a-new-server-side-test"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Create a new server side test</span></h2>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a href="https://github.com/autotest/autotest/wiki/AddingTest"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">Adding a test</span></a><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap"> involves putting a control file and a properly-written test wrapper in the right place in the source tree.  There are </span><a href="http://www.chromium.org/chromium-os/testing/autotest-best-practices#TOC-Writing-tests"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">conventions</span></a><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap"> that must be followed, and a</span><a href="https://github.com/autotest/autotest/wiki/AutotestApi"><span style="font-size:15px;font-family:Arial;color:rgb(0,0,0);text-decoration:none;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">variety of primitives</span></a><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);text-decoration:underline;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap">available for use.  When writing any code, whether client-side test, server-side test, or library, have a strong bias towards using</span><a href="http://www.chromium.org/chromium-os/testing/existing-autotest-utilities"><span style="font-size:15px;font-family:Arial;color:rgb(0,0,0);text-decoration:none;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">Autotest utility code</span></a><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap">.  This keeps the codebase consistent and avoids duplicated effort.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">In the subsections below, we will discuss the detail of following topics:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:13px;font-family:Arial;color:rgb(34,34,34);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;color:rgb(0,0,0);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Syntax and style guide.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:13px;font-family:Arial;color:rgb(34,34,34);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;color:rgb(0,0,0);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Code for a barebone server side test.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:13px;font-family:Arial;color:rgb(34,34,34);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;color:rgb(0,0,0);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">How to manually run a server side test on DUT.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:13px;font-family:Arial;color:rgb(34,34,34);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;color:rgb(0,0,0);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Code to implement the test logic for this exercise.</span></p>
</li></ul>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Syntax-and-style-guide"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Syntax and style guide</span></h3>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Before we start writing any code, it’s a good idea to understand and follow the Python coding style enforced in Chromium OS project. For Autotest code in Chromium OS project, the Python coding style must follow the </span><a href="http://git.chromium.org/gitweb/?p=chromiumos/third_party/autotest.git;a=blob;f=CODING_STYLE;hb=HEAD"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">CODING_STYLE</span></a><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap"> at the top level of the </span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest</span><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap"> repo. This style adds a few additions to </span><a href="http://www.python.org/dev/peps/pep-0008/"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">PEP-8</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> style guide, e.g., formatting on comments and Docstrings. You may also consider to follow </span><a href="http://www.chromium.org/chromium-os/python-style-guidelines"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Python Style Guidelines in Chromium Projects</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, but coding style defined in Autotest repo and </span><a href="http://www.python.org/dev/peps/pep-0008/"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">PEP-8</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> style guide must take precedence.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Some basic rules include:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Use 4 spaces instead of tab.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="http://google-styleguide.googlecode.com/svn/trunk/pyguide.html?showone=Strings#Strings"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Use the % operator for formatting strings</span></a><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Read </span><a href="http://www.python.org/dev/peps/pep-0008/#indentation"><span style="color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">this</span></a><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> about alignment for function calls with multiple line arguments.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">lower_case_with_underscores for local variable, function and method names.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">CapitalizedWords for class names</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">__double_leading_underscore for private class attribute name.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">UPPER_CASE_WITH_UNDERSCORES for static public class attribute name.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">Separate top-level function and class definitions with two blank lines.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">No extra space at the end of a line. </span><span style="vertical-align:baseline;white-space:pre-wrap">Limit all lines to a maximum of 80 characters.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">Use single quote for strings if possible.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">End comment with period.</span></p>
</li></ul>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a href="../../../developers/coding-style.html"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Here</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> is another resources talking about coding style, including languages other than Python. Keep in mind that the best practice is to keep the test file in pure Python i.e. one should avoid “shelling out” and generally use Python instead of tools like awk and grep.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-1.-Name-your-test"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Step 1. Name your test</span></h3>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Create a folder in “src/third_party/autotest/files/server/site_tests/”. Name the folder with the test name, which is “power_MyBacklightTest”.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">To name the test properly, first you need to decide the area wherein your test falls. It should be something like “power”, "platform", or "network" for instance. Take a look at the folder names in client/site_tests and server/site_tests, you can find some sample test area, and choose one area that’s proper for your test. This name is used to create the test name: e.g. "network_UnplugCable". Create a directory for your test at $(TEST_ROOT)/$(LOWERCASE_AREA)_$(TEST_NAME).</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Try to find an example test that does something similar and copy it.  You will create at least 2 files:</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">${TEST_ROOT}/${LOWERCASE_AREA}_${TEST_NAME}/control</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">${TEST_ROOT}/${LOWERCASE_AREA}_${TEST_NAME}/${LOWERCASE_AREA}_${TEST_NAME}.py</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Your control file runs the test and sets up default parameters.  The .py file is the test wrapper, and has the actual implementation of the test. You can create multiple control files for the same test that can take different arguments. As an example, </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=tree;f=client/site_tests/power_SuspendStress;h=e1db6f04fe525f1f752f54569137e9a8935cc3ae;hb=HEAD"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">power_SuspendStress</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> test has multiple control files that serve multiple purpose, while sharing the same test logic with different configuration.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Inside the control file, the TEST_CLASS variable should be set to ${LOWERCASE_AREA}.  The naming convention simply exists to make it easier to find other similar tests and measure the coverage in different areas of Chromium OS.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-2.-Create-a-barebone-server-side-test"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Step 2. Create a barebone server side test</span></h3>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">In this section we will discuss what’s the minimum code needed to create an empty server side test that provides all necessary files and overrides, but with no test logic in it.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-2.1.-Create-a-Control-file"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 2.1. Create a Control file</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">A control file contains important metadata about the test (name, author, description, duration, what suite it’s in, etc) and then pulls in and executes the actual test code. Detailed description about each variable can be found in the </span><a href="http://www.chromium.org/chromium-os/testing/autotest-best-practices#TOC-Control-files"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">Autotest Best Practices</span></a><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">. You can also find more information about control files </span><a href="https://github.com/autotest/autotest/wiki/AddingTest"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">here</span></a><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">In the folder power_MyBacklightTest you just created, create a control file named “control”, with the following content, set NAME to the test name of “power_MyBacklightTest”. Note that NAME must be exactly the same as the folder name. Set AUTHOR to your name or email address ([ldap]@chromium.org).</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">------------------------------</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Copyright information</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /><br />AUTHOR </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"your name, and at least one person ([ldap]@chromium.org) or a mailing list"</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />NAME </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"power_MyBacklightTest" </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># test name</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />TIME </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"SHORT"</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">              </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># can be MEDIUM, LONG</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />TEST_CATEGORY </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"Benchmark"</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># can be General, Stress</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />TEST_CLASS </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"power"</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># testing area, e.g., platform, network etc</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># indicating it's a server side test</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />TEST_TYPE </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"server"</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">SUITE </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"bvt"                 </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># if the test should be a part of the BVT<br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">EXPERIMENTAL </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"True"    </span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /><br />
DOC </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"""</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">This test measures the backlight level before and after certain system events</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">and verifies that the backlight level has not changed.</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">"""</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /><br />
</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">run_system_power_MyBacklightTest</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(machine):<br />    job</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">run_test(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);vertical-align:baseline;white-space:pre-wrap">'power_MyBacklightTest'</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">, client_ip</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">machine)<br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># run the test in multiple machines</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />
job</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">parallel_simple(run_system_power_MyBacklightTest, machines)</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">-----------------------------------------------------</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">This control file is used for </span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> server to run the test “power_MyBacklightTest” in each test device. The test is defined in the test wrapper file, which is explained in the next section.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Some important attributes are listed here:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">TIME: time duration to run the test, can be FAST (&lt;1min), SHORT, MEDIUM, LONG or LENGTHY (&gt;30min).</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">TEST_CATEGORY: describes the category for your tests e.g. Stress, Functional</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">TEST_TYPE: Client or </span><span style="font-weight:bold;vertical-align:baseline;white-space:pre-wrap">Server</span><span style="vertical-align:baseline;white-space:pre-wrap">, indicating it’s a client side or server side test.</span></p>
</li></ul>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Some optional attributes:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">SUITE: A comma-delimited string of suite names that this test should be a part of, e.g. bvt, regression, smoke</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><a href="http://www.chromium.org/chromium-os/testing/test-dependencies-in-dynamic-suites"><span style="color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">DEPENDENCIES</span></a><span style="vertical-align:baseline;white-space:pre-wrap">: list, of, tags known to the HW test lab, e.g., webcam, bluetooth</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">EXPERIMENTAL: if the test is experimental, value can be True or False. For experimental tests, failure is considered to be non-fatal. For the test you uploaded, EXPERIMENTAL should be set to True until the test passes reliably on all intended platforms in the lab.</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
</li></ul>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-2.2.-Create-a-test-wrapper"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 2.2. Create a test wrapper</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">The test wrapper file contains code for the test logic. Following is the source code for a test wrapper for a barebone server side test that contains all the necessary method overrides, but without any test logic. Basically the test wrapper contains a class derived from base class “test” (server/test.py). Autotest server will pick up this class and execute method “run_once” to do the actual test work, and call method cleanup after all tests in this test wrapper is done.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Note that the name of folder containing the control file, the NAME value in control file, and the test wrapper must match the class name. To create the test wrapper, in the folder power_MyBacklightTest, create test file named “power_MyBacklightTest.py”.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">-----------------------------------------------------</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Copyright information</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> test<br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">class</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">power_MyBacklightTest</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(test</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">test):</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Test to check backlight brightness restored after various actions."""</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />    version </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);vertical-align:baseline;white-space:pre-wrap">1</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br />
</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">initialize</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">pass</span></p>
<div style="font-weight:normal;font-size:medium;font-family:Times New Roman"><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-size:medium;font-weight:normal"><br /></b></b></div><br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">setup</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">pass</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /><br /><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">run_once</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">, client_ip):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">pass</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">cleanup</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">pass</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">-----------------------------------------------------</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">The test wrapper’s base class is set to test.test (server/test.py). Autotest server will pick up this class and call following methods in order:</span></p>
<br />
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">initialize, where you can do initialization for this particular test.</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">run_once, where actual test logic lives.</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">cleanup, called at the end of the test.</span></p>
</li>
</ol>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Note that setup is not called during testing. Following are some details about each method and attribute version.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h5 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-version"></a><span style="font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">version</span></h5>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">You must define the class variable </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap">version</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">. </span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h5 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-initialize"></a><span style="font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">initialize</span></h5>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">The method </span><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">initialize</span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> runs once for each job. The method is equivalent to </span><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_init_</span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">. It is called before actual test is run. However, do not use </span><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_init_</span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> for initialization, use initialize instead. </span><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_init_</span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> is defined and used in base class (base_test) to initialize the attributes for the base class. Overriding _init_ will break the test.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h5 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-setup"></a><span style="font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">setup</span></h5>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">This method is the only one called when you </span><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">build_packages --withautotest, </span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">while other methods are called during testing. The method is triggered when version attribute’s value is changed or the test package is built the first time to produce expected binaries. If the test is scheduled to run in a DUT in which the test has already been installed, Autotest will check the version attribute’s value of the test class. If the value is changed, the test will be reinstalled. One sample usage of this method can be found </span><a href="../autotest-developer-faq.html#TOC-Adding-binaries-for-your-tests-to-call-as-part-of-the-test"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">here</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h5 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-run_once"></a><span style="font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">run_once</span></h5>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">You then must provide an override for the </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap">run_once()</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> method in your class. The method contains the actual test logic. The </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap">run_once</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> method can accept any arguments you desire. These are passed in as the</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap"> *dargs </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">in the </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap">job.run_test()</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> method in the control file. As the test logic can be complicated, instead of a lengthy </span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);font-style:italic;vertical-align:baseline;white-space:pre-wrap">run_once</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">() method, it’s highly recommended to use member methods to better organize the test code for easier review.  At the end of this method, you validate the test results in this method, and log any failure.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h5 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-cleanup"></a><span style="font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">cleanup</span></h5>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">cleanup</span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> is the method where you do the custodial work, e.g., restore the system’s status to its original state if you have cached that, in this test, it’s the backlight brightness.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-3.-Running-the-server-side-test"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Step 3. Running the server-side test</span></h3>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Run-Autotest-manually"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Run Autotest manually</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">After the control file and test wrapper file are created, you can try to manually run your </span><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> against DUT, which has a test image installed (follow </span><a href="../../developer-guide.html#TOC-Build-a-disk-image-for-your-board"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">this instruction</span></a><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> to build a test image using the “test” argument).</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">To get started, first you need to create or enter a chroot in your host machine. Details can be found </span><a href="../../developer-guide.html#TOC-Create-a-chroot"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">here</span></a><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">. Go to chromiumos directory, run following command to create or enter a chroot.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">./chromite/bin/cros_sdk</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Then go to folder src/scripts, run following command to setup the board, that is, the class of target device.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">./setup_board --board=${BOARD}</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Go to folder src/third_party/autotest/files, run following command to start working on the board.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">cros_workon --board=${BOARD} start .</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">Once you complete above steps, you can now try to run the server side test. Go to src/scripts directory, run the following command to manually run your Autotest:</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">test_that  ${ClientIP} ${LOWERCASE_AREA}_${TEST_NAME}</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><br /></p><p dir="ltr" style="font-weight:normal;margin-top:0pt;margin-bottom:0pt"><font face="arial, sans-serif" size="2">${LOWERCASE_AREA}_${TEST_NAME} is the NAME in control file. If you set NAME attribute to a different value, you need to use that value in test_that command.</font></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><br /></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">For example:</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">test_that 192.168.1.20 power_MyBacklightTest</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">You need to replace the DUT’s IP address with your own configuration.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">After the command is executed, the test should finish in about 30 seconds. You should expect output with detailed information of each step the test is executed, for example:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">Install autotest if it’s not found in DUT.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">Start autotestd_monitor and collect system information before and after the test.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="vertical-align:baseline;white-space:pre-wrap">Execute the test logic defined in test wrapper.</span></p>
</li></ul>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">At the end of the output, you will find the test result, like following:</span></p>
</b></b><div><div>------------------------------------------------------------------------------------------------------------</div><div>/tmp/test_that_results_Bdfrwv/results-1-experimental_power_MyBacklightTest                       [  PASSED  ]</div><div>/tmp/test_that_results_Bdfrwv/results-1-experimental_power_MyBacklightTest/power_MyBacklightTest [  PASSED  ]</div><div>------------------------------------------------------------------------------------------------------------</div><div>Total PASS: 2/2 (100%)</div><div><br /></div><div>18:16:28 INFO | Finished running tests. Results can be found in /tmp/test_that_results_Bdfrwv</div></div><div><br /></div>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">In a real world example, the test may take much longer to finish to execute all the test logic.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Add-test-to-an-existing-test-suite"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Add test to an existing test suite</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">If you want Autotest to run your test automatically, you must add it to one or more existing test suites. For example, to have it run as part of the BVT (build validation test), you would edit the "SUITE" attribute in the control file, and set it equal to 'bvt'. Autotest then will pick up this test and run it as part of the bvt suite.</span></p>
<br />
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-weight:normal;font-family:Arial;font-size:15px;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">The control file and test wrapper must be stored in a subfolder of src/third_party/autotest/files/server/site_tests/ folder. Note that the folder name must match the class name of the test code (the class is the one defined in test wrapper and derived from base class “test”). See the c</span><span style="background-color:transparent;font-size:15px;white-space:pre-wrap"><font face="Arial">ode lab for <a href="http://www.chromium.org/chromium-os/testing/test-code-labs/dynamic-suite-codelab">Creating and deploying Chromium OS Dynamic Test Suites</a>.</font></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.-Implement-test-logic-in-test-wrapper"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Step 4. Implement test logic in test wrapper</span></h3>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">In the previous section, we show a test wrapper for a barebone server side test that contains all necessary method overrides without any actual code in it. In this section, we will implement the test logic which is to test if the backlight brightness goes back to its original setting after various scenarios. That is, you need to write code to accomplish the following individual tasks:</span></p>
<br />
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Get/set backlight’s brightness</span></p>
</li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;white-space:pre-wrap">Log out and log in user</span></p></li>
<li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Suspend the device and resume</span></p>
</li>
</ol>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Code will be added to the test wrapper we created in the last section, that is</span><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap"> “power_MyBacklightTest.py”, in the folder power_MyBacklightTest. Follow each steps in this section, and copy the code to the test wrapper “power_MyBacklightTest.py”. At the end you will have a complete test to test the backlight brightness of a DUT.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">While writing a server side test, it is important to keep in mind that the test execution is initiated in the server. To execute a command running on the DUT, you need to run the command through a host object (self._client showing in the code). Different from to a server side test, client side test code is copied to the DUT and executed within the DUT.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.1.-Import-modules-useful-for-Chromium-OS-specific-test"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.1. Import modules useful for Chromium OS specific test</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Add the imports at the beginning of test wrapper.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">import </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">logging, os, subprocess, tempfile, time</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">from </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.client.common_lib</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"> import </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=blob;f=client/common_lib/error.py;h=d9854db796a812b86089773b4cfb365a8ddf0359;hb=HEAD"><span style="font-size:13px;font-family:Verdana;color:rgb(17,85,204);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">error</span></a><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br />from </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"> import </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=blob;f=server/autotest.py;h=56b578b08da7d61762dad1bec71608db84ed81d4;hb=HEAD"><span style="font-size:13px;font-family:Verdana;color:rgb(17,85,204);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest</span></a><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br />from </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"> import </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=tree;f=server/hosts;h=c493f142abfaacc5a9db28c64cbc3fbbe9d08f75;hb=HEAD"><span style="font-size:13px;font-family:Verdana;color:rgb(17,85,204);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">hosts</span></a><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br />from </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"> import </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=blob;f=server/test.py;h=8fdba9d7c40addf23e139b060f558e17bb34e40b;hb=HEAD"><span style="font-size:13px;font-family:Verdana;color:rgb(17,85,204);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">test</span></a><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><br />from </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap"> import </span><a href="https://gerrit.chromium.org/gerrit/gitweb?p=chromiumos/third_party/autotest.git;a=blob;f=server/utils.py;h=72f72f938f37b7c7cac729de05df446b0bbbd253;hb=HEAD"><span style="font-size:13px;font-family:Verdana;color:rgb(17,85,204);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">utils</span></a></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">These modules include some useful base classes to be used to run commands in a test device or control a servo device. More details about how </span><a href="../autotest-developer-faq.html#TOC-Writing-Autotests"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">import</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> is used in Autotest can be found </span><a href="../autotest-developer-faq.html#TOC-A-word-about-imports"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">here</span></a><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">. Note that each line only imports one module and modules are ordered alphabetically.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.2. Helper methods</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Add following methods to class power_MyBacklightTest. They are some helper methods to execute the commands from the DUT, or used to check the DUT’s power status.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Execute a command on the client.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">
</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @param cmd: command to execute on client.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @return: The output object, with stdout and stderr fields.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />
</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'Client cmd: [</span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">]'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">run(cmd)<br /><br />
    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd_and_wait_for_restart</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd):<br />        boot_id </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">get_boot_id()<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'sh -c "sync; sleep 1; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">" &gt;/dev/null 2&gt;&amp;1 &amp;'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> cmd)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">wait_for_restart(old_boot_id</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">boot_id)<br /><br />
    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_check_power_status</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        cmd_result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'status powerd'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'running'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> cmd_result</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">stdout:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'powerd must be running.'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt;display:inline!important"><b style="color:rgb(0,0,0);font-style:normal;font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-weight:normal"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline">        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline">'power_supply_info | grep online'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline">)</span></b></b></p><br /><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'yes'</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> result</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">stdout:<br />            </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'power must be plugged in.'</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)</span><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.3.-Get-Set-brightness"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.3. Get/Set brightness</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Add following two methods in class power_MyBacklightTest. In these two methods, a command is passed by _client_cmd method to get current brightness from test device, and _set_brightness to set the device.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_get_brightness</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Get brightness in integer value. It's not a percentage value and</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        may be over 100"""</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'backlight_tool --get_brightness'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">int</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(result</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">stdout</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">rstrip())<br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, brightness</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">100</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">):<br />        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'backlight_tool --set_brightness_percent </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">                                           </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> brightness)</span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-1"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></h4><h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.4.-Actions-being-taken-during-the-test"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.4. Actions being taken during the test</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Add following methods in class power_MyBacklightTest. In these methods, command is called to apply actions to DUT, including, logout/login, and power suspend/resume.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:13px;font-family:Verdana;vertical-align:baseline;white-space:pre-wrap">    </span><span style="background-color:transparent;font-size:13px;font-family:Verdana;color:rgb(0,112,32);font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="background-color:transparent;font-size:13px;font-family:Verdana;vertical-align:baseline;white-space:pre-wrap"> </span><span style="background-color:transparent;font-size:13px;font-family:Verdana;color:rgb(6,40,126);vertical-align:baseline;white-space:pre-wrap">_do_logout</span><span style="background-color:transparent;font-size:13px;font-family:Verdana;vertical-align:baseline;white-space:pre-wrap">(</span><span style="background-color:transparent;font-size:13px;font-family:Verdana;color:rgb(0,112,32);vertical-align:baseline;white-space:pre-wrap">self</span><span style="background-color:transparent;font-size:13px;font-family:Verdana;vertical-align:baseline;white-space:pre-wrap">):</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'restart ui'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)<br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">
    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_do_suspend</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">):</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # The method calls a client side test 'power_resume' to do a power</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # suspend on the DUT. It is easy yet powerful for one test to run</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # another test to implement certain action without duplicating code.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_at</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">run_test(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'power_Resume'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.5.-Disable-ALS-Auto-Light-Sensor-"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.5. Disable ALS(Auto Light Sensor)</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Auto light sensor might interfere the brightness, so it needs to be disabled before test starts, and re-enabled after the test finishes. Add following two methods in class power_MyBacklightTest.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_set_als_disable</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Turns off ALS in power manager.  Saves the old has_ambient_light_sensor</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />     </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">   flag if it exists.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">       </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Basic use of shell code via ssh run command is acceptable, rather than</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">       # shipping over a small script to perform the same task. </span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        als_path </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="color:rgb(64,112,160);font-family:Verdana;font-size:13px;font-style:italic;white-space:pre-wrap">'/var/lib/power_manager/has_ambient_light_sensor'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'if [ -e </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> ]; then mv </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_backup; fi'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />                         (als_path, als_path, als_path))<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'echo 0 &gt; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> als_path)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'restart powerd'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_als_disabled </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">True</span></p>
<br />
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_restore_als_disable</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Restore the has_ambient_light_sensor flag setting that was overwritten in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           _set_als_disable.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_als_disabled:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        als_path </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'/var/lib/power_manager/has_ambient_light_sensor'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'rm </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> als_path)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'if [ -e </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_backup ]; then mv </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_backup </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">; fi'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />                         (als_path, als_path, als_path))<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'restart powerd'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)</span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-2"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></h4><h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.6.-Run-test-and-validate-test-results"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.6. Run test and validate test results</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">This is the method where you run the actual test logic. At the end of this method, you validate the test results, and log any failure. It overrides the run_once method in base class test.test.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># The dictionary of test scenarios and its corresponding method to</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    # apply each action to the DUT.</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    _transitions </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> {</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />                     </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'logout':</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> _do_logout,<br />                     </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'suspend'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">: _do_suspend,<br />                     }</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">run_once</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, client_ip):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Run the test.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt;display:inline!important"><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-weight:normal"><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline">        For each system transition event in |_transitions|:</span></b></b></p><br /><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Read the brightness.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Trigger transition event.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Wait for client to come back up.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Check new brightness against previous brightness.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />
</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @param client_ip: string of client's ip address (required)</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />
</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> client_ip:<br />            error</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">"Must provide client's IP address to test"</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)<br /></span><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Create a custom host class for this machine, which is used to execute</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># commands and other functions.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> hosts</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">create_host(client_ip)</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Create an Autotest instance which you can run method like run_test,</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # which can execute another client side test to facilitate this test.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client_at </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> autotest</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Autotest(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_client)<br /></span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt;display:inline!important"><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-weight:normal"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">_results </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline"> {}</span></b></b></p><br /><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-weight:normal"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt;display:inline!important"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">_check_power_status()</span></p></b></b><br /></span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_set_als_disable()<br />
        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Save the original brightness, to be restored after the test ends.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_original_brightness </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_get_brightness()<br />
        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Set the brightness to a random number which is different from</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># system default value.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent(</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">71</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">)<br />
        </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Run the transition event tests.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">for</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> test_name </span><span style="font-weight:bold;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_transitions:<br />            </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_old_brightness </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_get_brightness()<br /><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-weight:normal"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt;display:inline!important"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">_transitions[test_name](</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline">)</span></p></b></b><br /></span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">
            </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Save the before and after backlight values.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />            </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_results[test_name] </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> { </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'old'</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">: </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_old_brightness,<br />                                         </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'new'</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">: </span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-weight:normal;font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_get_brightness() }</span>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Check results to make sure backlight levels were preserved across</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># transition events.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">0</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />
        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">for</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> test_name </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_results:<br />            old_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_results[test_name][</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'old'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">]<br />            new_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_results[test_name][</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'new'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">]<br /><br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> old_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">==</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> new_brightness:<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'Transition event [  PASSED  ]: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, test_name)<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">else</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">:<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'Transition event [  FAILED  ]: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, test_name)<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'   Brightness changed: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> -&gt; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">, <br />                             old_brightness, new_brightness)<br />                num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">+=</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">1</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">&gt;</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">0</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">TestFail((</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'Failed to preserve backlight over </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> '</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />                                  </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">'transition event(s).'</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">) </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> num_failed)</span></p>
<h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-3"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></h4><h4 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Step-4.7.-Cleanup"></a><span style="font-size:15px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;font-weight:normal;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Step 4.7. Cleanup</span></h4>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">“cleanup” is the method where you do the custodial work, e.g., restore the system’s status to its original state if you have cached that, in this test, it’s the backlight brightness. It overrides the cleanup method in base class test.test.</span></p><p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">cleanup</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Restore DUT's condition before the test starts, and check the test</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        results.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_restore_als_disable()<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">_original_brightness)<br />
</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">For more information on writing your test, see the </span><a href="../autotest-developer-faq.html"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);vertical-align:baseline;white-space:pre-wrap">frequently asked questions</span></a><span style="font-size:15px;font-family:Arial;vertical-align:baseline;white-space:pre-wrap">.</span></p>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-4"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br /></span></h2><h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Verify-Test-by-Running-Autotest-Manually"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Verify Test by Running Autotest Manually</span></h2>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">After you complete the last section, you should have all the code ready to run the test. As discussed in earlier section, once you configure the chroot properly, you can try to run the server side test manually with following command in src/scripts folder:</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap">test_that ${ClientIP} ${LOWERCASE_AREA}_${TEST_NAME}</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">For example:</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);font-weight:bold;vertical-align:baseline;white-space:pre-wrap"><span style="font-size:10pt;font-weight:normal">test_that  </span>192.168.1.20</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,96,0);background-color:rgb(239,239,239);vertical-align:baseline;white-space:pre-wrap"> power_MyBacklightTest</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">You need to replace the board name and DUT’s IP address with your own configuration.</span></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline;white-space:pre-wrap">If the test is successful, the following should happen in your test device in order:</span></p>
<br />
<ol style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">User log out</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">User log in</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">Screen brightness stays at 71%.</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">Screen goes black (system suspend/resume).</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">System comes up again.</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">Screen brightness stays at 71%.</span></p></li><li dir="ltr" style="list-style-type:decimal;font-size:15px;font-family:Arial;color:rgb(51,51,51);vertical-align:baseline"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="white-space:pre-wrap;background-color:transparent">In the clean up procedure, screen brightness is reset to its original value.</span></p></li></ol>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">All log generated from the test run can be found in a tmp folder, e.g.,  /tmp/test_that_results_WZ_eVZ.</span><span style="background-color:transparent;font-family:Arial;font-size:15px;white-space:pre-wrap"> The following are some files useful for troubleshooting an issue:</span></p>
<br />
<ul style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">status and status.log, contains the result of each test’s start/end time and test result.</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">keyval, some setup information, e.g., drone, DUT’s hostname</span></p>
</li>
<li dir="ltr" style="list-style-type:disc;font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline">
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;vertical-align:baseline;white-space:pre-wrap">debug/autoserv.DEBUG, contains all logs collected by autoserv during the test.</span></p>
</li></ul>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">When the test is completed, following message will be shown at the end of the output to indicate all tests are passed:</span></p>
<p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><font face="Arial" size="2"><span style="white-space:pre-wrap">------------------------------------------------------------------------------------------------------------
/tmp/test_that_results_Bdfrwv/results-1-experimental_power_MyBacklightTest                       [  PASSED  ]
/tmp/test_that_results_Bdfrwv/results-1-experimental_power_MyBacklightTest/power_MyBacklightTest [  PASSED  ]
------------------------------------------------------------------------------------------------------------
Total PASS: 2/2 (100%)

18:16:28 INFO | Finished running tests. Results can be found in /tmp/test_that_results_Bdfrwv</span></font></p>
<br />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">To review the test result later, you can always run generate_test_report to retrieve above test result.</span></p>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-5"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><br />
</span></h2>
<h2 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Possible-failure-scenarios"></a><span style="font-size:19px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Possible failure scenarios</span></h2>
<h3 dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><a name="TOC-Device-failed-to-reboot"></a><span style="font-size:16px;font-family:Arial;color:rgb(102,102,102);background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Device failed to reboot</span></h3>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">If the device failed to reboot during the test, the test will eventually timed out and consider failed. You need to verify the DUT is still connected to network and can be used to test. A quick check you can do is to ssh to the DUT as root user.</span></p>
<br />
<hr style="font-weight:normal;font-size:medium;font-family:Times New Roman" />
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Code of the test wrapper</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;background-color:transparent;vertical-align:baseline;white-space:pre-wrap">Reference: /src/third_party/autotest/files/server/site_tests/power_BacklightServer</span></p>
<p dir="ltr" style="font-weight:normal;font-size:medium;font-family:Times New Roman;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;font-family:Arial;color:rgb(17,85,204);background-color:transparent;vertical-align:baseline;white-space:pre-wrap"><a href="https://chromium.googlesource.com/chromiumos/third_party/autotest/+/master/server/site_tests/power_BacklightServer">https://chromium.googlesource.com/chromiumos/third_party/autotest/+/master/server/site_tests/power_BacklightServer</a></span></p>
<hr style="font-weight:normal;font-size:medium;font-family:Times New Roman" />
<b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"># Copyright (c) 2013 The Chromium OS Authors. All rights reserved.<br /># Use of this source code is governed by a BSD-style license that can be<br /># found in the LICENSE file.<br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">,</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">os</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">,</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">subprocess</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">,</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">tempfile</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">,</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">time</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">autotest_lib.client.common_lib</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error<br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> autotest<br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> hosts<br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> test<br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">from</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">autotest_lib.server</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">import</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> utils<br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">class</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(14,132,181);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">power_MyBacklightTest</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(test</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">test):</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Test to check backlight brightness restored after various actions."""</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />    version </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">1</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Execute a command on the client.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @param cmd: command to execute on client.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @return: The output object, with stdout and stderr fields.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'Client cmd: [</span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">]'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">run(cmd)<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd_and_wait_for_restart</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, cmd):<br />        boot_id </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">get_boot_id()<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'sh -c "sync; sleep 1; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">" &gt;/dev/null 2&gt;&amp;1 &amp;'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> cmd)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">wait_for_restart(old_boot_id</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">boot_id)<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_get_brightness</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Get brightness in integer value. It's not a percentage value and</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        may be over 100"""</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'backlight_tool --get_brightness'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">int</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(result</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">stdout</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">rstrip())<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, brightness</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">100</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'backlight_tool --set_brightness_percent </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />                                  </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> brightness)<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_check_power_status</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        cmd_result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'status powerd'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'running'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> cmd_result</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">stdout:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'powerd must be running.'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br />        result </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'power_supply_info | grep online'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'yes'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> result</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">stdout:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'power must be plugged in.'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_do_logout</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'restart ui'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_do_suspend</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # The method calls a client side test 'power_resume' to do a power</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # suspend on the DUT. It is easy yet powerful for one test to run</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # another test to implement certain action without duplicating code.<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_at</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">run_test(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'power_Resume'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />    _transitions </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> { <br />                     'logout': _do_logout,<br />                     </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'suspend'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">: _do_suspend,<br />                     }<br /><br />    _als_disabled </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">False</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_set_als_disable</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Turns off ALS in power manager.  Saves the old has_ambient_light_sensor flag if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           it exists.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        als_path </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="color:rgb(64,112,160);font-family:Verdana;font-size:13px;font-style:italic;white-space:pre-wrap">'/var/lib/power_manager/has_ambient_light_sensor'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'if [ -e </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> ]; then mv </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_backup; fi'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />                         (als_path, als_path, als_path))<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'echo 0 &gt; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> als_path)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'restart powerd'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_als_disabled </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">True</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_restore_als_disable</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Restore the has_ambient_light_sensor flag setting that was overwritten in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           _set_als_disable.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_als_disabled:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">return</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        als_path </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'/var/lib/power_manager/has_ambient_light_sensor'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'rm </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> als_path)<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'if [ -e </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_backup ]; then mv </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_backup </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">; fi'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />                         (als_path, als_path, als_path))<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_cmd(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'restart powerd'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">run_once</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, client_ip):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Run the test.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        For each system transition event in |_transitions|:</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Read the brightness.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Trigger transition event.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Wait for client to come back up.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">           Check new brightness against previous brightness.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        @param client_ip: string of client's ip address (required)</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">not</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> client_ip:<br />            error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestError(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"Must provide client's IP address to test"</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /></span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # Create a custom host class for this machine, which is used to execute</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # commands and other functions.</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> hosts</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">create_host(client_ip)<br />        # Create an Autotest instance which you can run method like run_test,</span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        # which can execute another client side test to facilitate this test.</span></p><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client_at </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> autotest</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">Autotest(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_client)<br /><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_results </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> {}<br /><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_check_power_status()<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_set_als_disable()<br /><br />        # Save the original brightness, to be restored after the test ends.<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_original_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_get_brightness()<br />        # Set the brightness to a random number which is different from<br />        # system default value.<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">71</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br />        # Run the transition event tests.<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">for</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> test_name </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_transitions:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_old_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_get_brightness()<br /><br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_transitions[test_name](</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">)<br /><br />            # Save the before and after backlight values.<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_results[test_name] </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> { </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'old'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">: </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_old_brightness,<br />                                         </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'new'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">: </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_get_brightness() }<br /><br /><br />    </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">def</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(6,40,126);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">cleanup</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">):<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">"""Restore DUT's condition before the test starts, and check the test</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        results.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">        """</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_restore_als_disable()<br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_set_brightness_percent(</span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_original_brightness)<br /><br />        # Check results to make sure backlight levels were preserved across<br />        # transition events.<br />        num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">0</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">for</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> test_name </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">in</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_results:<br />            old_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_results[test_name][</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'old'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">]<br />            new_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">self</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">_results[test_name][</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'new'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">]<br /><br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> old_brightness </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">==</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> new_brightness:<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'Transition event [  PASSED  ]: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, test_name)                <br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">else</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">:<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'Transition event [  FAILED  ]: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%s</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">, test_name)<br />                logging</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">info(</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'   Brightness changed: </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> -&gt; </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">,<br />                             old_brightness, new_brightness)<br />                num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">+=</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">1</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /><br />        </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">if</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> num_failed </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">&gt;</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,160,112);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">0</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">:<br />            </span><span style="font-size:13px;font-family:Verdana;color:rgb(0,112,32);background-color:transparent;font-weight:bold;font-style:italic;vertical-align:baseline;white-space:pre-wrap">raise</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> error</span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">.</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">TestFail((</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">'Failed to preserve backlight over </span><span style="font-size:13px;font-family:Verdana;color:rgb(112,160,208);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap">%d</span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"> '</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><br /></span></b><b style="font-family:Times New Roman;font-size:medium;font-weight:normal"><b style="font-size:medium;font-weight:normal"><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><b style="color:rgb(0,0,0);font-style:normal;font-family:Times New Roman;font-size:medium;font-weight:normal"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline">                                  </span><span style="font-size:13px;font-family:Verdana;color:rgb(64,112,160);background-color:transparent;font-style:italic;vertical-align:baseline">'transition event(s).'</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline">) </span><span style="font-size:13px;font-family:Verdana;color:rgb(102,102,102);background-color:transparent;font-style:italic;vertical-align:baseline">%</span><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline"> num_failed)</span></b></span></p><p dir="ltr" style="margin-top:0pt;margin-bottom:0pt"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline;white-space:pre-wrap"><b style="color:rgb(0,0,0);font-style:normal;font-family:Times New Roman;font-size:medium;font-weight:normal"><span style="font-size:13px;font-family:Verdana;color:rgb(96,160,176);background-color:transparent;font-style:italic;vertical-align:baseline"><br /></span></b></span></p></b></b></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-attachments">
<div class="sites-attachments-row"><div class="sites-attachments-icon" style="left:0px;"><span aria-label="Attachments" title="Attachments"><div class="sites-translucent sites-symbol" aria-hidden="true">Č</div></span></div><div id="sites-attachments-update-div" class="sites-attachments-inner-div" style="display:none;"><span class="sites-attachments-update-icon"><img src="http://www.gstatic.com/sites/p/56e332/system/app/images/spinner.gif" /></span><div class="sites-attachments-update-text">Updating...</div></div></div><div class="sites-attachments-separator"></div>
<div id="attachment-wuid:gx:6f44db6265c46ce6"><div class="sites-attachments-row"><div class="sites-attachments-icon sites-attachments-icon-accessible" style="left:5px"><div class="sites-translucent sites-symbol" aria-label="File" title="File">ċ</div></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name">control <div class="sites-translucent">(1k)</div></div><div class="sites-attachments-author">Dan Shi, <div class="sites-translucent">Jun 3, 2014, 9:45 PM</div></div></div><div class="sites-attachments-version sites-attachments-version-accessible"><a href="http://www.chromium.org/system/app/pages/admin/revisions?wuid=wuid:gx:6f44db6265c46ce6">v.1</a></div><div id="attachment-download-wuid:gx:6f44db6265c46ce6" class="sites-attachments-icon sites-attachments-icon-accessible" style="right:0px"><a href="http://www.chromium.org/chromium-os/testing/test-code-labs/server-side-test/control?attredirects=0&amp;d=1" aria-label="Download control" title="Download" role="button"><span class="sites-symbol" aria-hidden="true">ď</span></a></div></div><div class="sites-attachments-separator"></div></div>
<div id="attachment-wuid:gx:822a2bd9686374a"><div class="sites-attachments-row"><div class="sites-attachments-icon sites-attachments-icon-accessible" style="left:5px"><div class="sites-translucent sites-symbol" aria-label="File" title="File">ċ</div></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name">power_MyBacklightTest.py <div class="sites-translucent">(7k)</div></div><div class="sites-attachments-author">Dan Shi, <div class="sites-translucent">Jun 3, 2014, 9:45 PM</div></div></div><div class="sites-attachments-version sites-attachments-version-accessible"><a href="http://www.chromium.org/system/app/pages/admin/revisions?wuid=wuid:gx:822a2bd9686374a">v.1</a></div><div id="attachment-download-wuid:gx:822a2bd9686374a" class="sites-attachments-icon sites-attachments-icon-accessible" style="right:0px"><a href="http://www.chromium.org/chromium-os/testing/test-code-labs/server-side-test/power_MyBacklightTest.py?attredirects=0&amp;d=1" aria-label="Download power_MyBacklightTest.py" title="Download" role="button"><span class="sites-symbol" aria-hidden="true">ď</span></a></div></div><div class="sites-attachments-separator"></div></div>
<div style="height: 10px"></div>
</div>
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/chromium.org/dev/chromium-os/testing/test-code-labs/server-side-test">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="http://www.chromium.org/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="http://www.chromium.org/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9f21PirebK4UhnVwRSGYjA1h0pBYJRTTl4-vZSslM4vjeZuiXnFWxP9gCOXEe-19yajbuXmpDAJB7bKESHqia4qu73f-Itlj8DRTHJnyf8R-lNpMB/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
