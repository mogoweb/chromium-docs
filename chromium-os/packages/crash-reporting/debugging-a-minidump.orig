<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="http://www.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/packages","deleted":false,"title":"packages","dir":"ltr"},{"path":"/chromium-os/packages/crash-reporting","deleted":false,"title":"Crash Reporting (Chrome OS System)","dir":"ltr"},{"path":"/chromium-os/packages/crash-reporting/debugging-a-minidump","deleted":false,"title":"Debugging a Minidump","dir":"ltr"}];
  var JOT_clearDotPath = 'http://www.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttp://sites.google.com/a/chromium.org/dev/chromium-os/packages/crash-reporting/debugging-a-minidump\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"http://csi.gstatic.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["http://www.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["http://www.gstatic.com/sites/p/56e332/system/js/codemirror.js","http://www.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","http://www.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","http://www.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","http://www.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/packages/crash-reporting","parentWuid":"wuid:gx:758606dbdf7d4562","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Debugging a Minidump","locale":"en","wuid":"wuid:gx:4d5bad7d8850224a","revision":12,"path":"/chromium-os/packages/crash-reporting/debugging-a-minidump","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"debugging-a-minidump","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Debugging a Minidump - The Chromium Projects" />
<meta itemprop="name" content="Debugging a Minidump - The Chromium Projects" />
<meta property="og:title" content="Debugging a Minidump - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="http://www.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Debugging a Minidump - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="http://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="http://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:571d8fbd499df20e" class="sites-navigation-link">Sitemap</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/chromium-os" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="/chromium-os/packages" dir="ltr">packages</A>‎ &gt; ‎<A href="/chromium-os/packages/crash-reporting" dir="ltr">Crash Reporting (Chrome OS System)</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Debugging a Minidump</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><br /><div><br /></div><h2><a name="TOC-Table-of-Contents"></a><font size="5"><u>Table of Contents</u></font></h2><div><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed sites-embed-full-width" style="width:100%;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Table-of-Contents"><strong>1 </strong>Table of Contents</a></li><li class="goog-toc"><a href="#TOC-Use-minidump_stackwalk-to-show-a-stack-trace"><strong>2 </strong>Use minidump_stackwalk to show a stack trace</a></li><li class="goog-toc"><a href="#TOC-Use-gdb-to-show-a-backtrace"><strong>3 </strong>Use gdb to show a backtrace</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Generate-core-file"><strong>3.1 </strong>Generate core file</a></li><li class="goog-toc"><a href="#TOC-Calculate-address-for-symbols"><strong>3.2 </strong>Calculate address for symbols</a></li><li class="goog-toc"><a href="#TOC-Start-debugger"><strong>3.3 </strong>Start debugger</a></li><li class="goog-toc"><a href="#TOC-Example"><strong>3.4 </strong>Example</a></li></ol></li><li class="goog-toc"><a href="#TOC-If-backtrace-in-gdb-did-not-help"><strong>4 </strong>If backtrace in gdb did not help</a></li></ol></div></div></div></div></div><br /></div><div><br /></div><div><div>Reference: <a href="https://sites.google.com/a/google.com/chrome-msk/dev#TOC-Crash-dump-analysis">https://sites.google.com/a/google.com/chrome-msk/dev#TOC-Crash-dump-analysis</a></div><div><br /></div><div>This page discusses how to debug a ChromiumOS minidump.</div><div><ul><li><span style="font-size:10pt;background-color:transparent">For information on how to debug a Chrome minidump on Linux see </span><a href="https://code.google.com/p/chromium/wiki/LinuxMinidumpToCore" style="font-size:10pt;background-color:transparent">LinuxMinidumpToCore</a><span style="font-size:10pt;background-color:transparent">.</span></li><li><span style="font-size:10pt;background-color:transparent">To debug a Chrome minidump on Windows just load the minidump into Visual Studio or windbg, set up the Chrome symbol server and Microsoft symbol server, and enable source indexing. Instructions can be found on the </span><a href="http://www.chromium.org/developers/how-tos/debugging-on-windows">Debugging Chromium on Windows</a> page.</li><li><span style="font-size:10pt;background-color:transparent">For other thoughts on crash analysis see <a href="http://www.chromium.org/developers/crash-reports">Crash Reports</a>.</span></li></ul></div><h2><a name="TOC-Use-minidump_stackwalk-to-show-a-stack-trace"></a><font size="5"><u>Use minidump_stackwalk to show a stack trace</u></font></h2><div><br /></div><div>TODO(mkrebs): ...</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><h2><a name="TOC-Use-gdb-to-show-a-backtrace"></a><font size="5"><u>Use gdb to show a backtrace</u></font></h2><h3><a name="TOC-Generate-core-file"></a><font size="4">Generate core file</font></h3></div><div><span style="font-size:10pt">Convert a minidump to a core file.</span><br /><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>sh -c '~/chromiumos/chroot/usr/bin/minidump-2-core -v upload_file_minidump-7adc2ee0079cb374.dmp &gt; minidump.core 2&gt;minidump.core.out'</code></div><div></div></div>For a minidump from a 32-bit executable, use <code>minidump-2-core.32</code> instead.<div><br /></div><div>For an ARM minidump, you have to work a little bit harder to get a core file.  The easiest way is probably to do the conversion using qemu within your chroot.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><span style="color:rgb(153,0,255);line-height:1;font-size:10pt"># Convert minidump to a core file in /tmp/</span></div><div><code><font color="#9900ff">SYSROOT=/build/daisy<br />qemu-arm \<br />  ${SYSROOT}/lib/ld-linux-armhf.so.3 \<br />  --library-path ${SYSROOT}/lib:${SYSROOT}/usr/lib \<br />  ${SYSROOT}/usr/bin/minidump-2-core \<br />    -v ~/test/upload_file_minidump-de1f11232d825812.dmp &gt;/tmp/minidump.core 2&gt;/tmp/minidump.core.out</font></code></div><div></div></div>Reference: <a href="http://crosbug.com/34938">http://crosbug.com/34938</a><div><br /></div></div><div><h3><a name="TOC-Calculate-address-for-symbols"></a><font size="4">Calculate address for symbols</font></h3><div><span style="font-size:10pt">First, setup the necessary files for the debugger.  You need both the original executables and/or libraries whose symbols you wish to calculate, and you will need their corresponding debug information.  Googlers: S</span><span style="font-size:10pt">ee </span><a href="https://sites.google.com/a/google.com/mkrebs/references/chrome-os#TOC-Setup-files-for-debugger" style="font-size:10pt">Setup files for debugger</a> for how to get these for official images.</div><div><br /></div><div>Calculate the base address of the crashing executable's .text section.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code># Determine base address where the crashing executable was mapped</code></div><div><code>set t1=`grep -w GUID minidump.core.out | grep '"/opt/google/chrome/chrome"' | sed -e 's/-.*//'`</code></div><div><code># Determine offset of .text within the executable (run objdump with sudo if setuid program like Xorg)</code></div><div><code>set t2=`objdump -h /usr/local/google/home/mkrebs/tmp/test/sigabrt/2913.45.0/image/rootfs/opt/google/chrome/chrome | \grep '\.text'|awk '{print $4}'`</code></div><div><code># Print out address of .text in memory</code></div><div><code>perl -e 'die unless $ARGV[0] &amp;&amp; $ARGV[1]; printf("%#x\n", hex($ARGV[0]) + hex($ARGV[1]))' $t1 $t2</code></div><div></div></div><br /><div>You may also want to do this for shared libraries that the executable loaded.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code># Determine base address where the library was mapped</code></div><div><code>set t1=`grep -w GUID minidump.core.out | grep '"/lib/libc-2.15.so"' | sed -e 's/-.*//'`</code></div><div><code># Determine offset of .text within the executable (run objdump with sudo if setuid program like Xorg)</code></div><div><code>set t2=`objdump -h /usr/local/google/home/mkrebs/tmp/test/issue35349/2913.84.5/image/rootfs/lib/libc-2.15.so | \grep '\.text'|awk '{print $4}'`</code></div><div><code># Print out address of .text in memory</code></div><div><code>perl -e 'die unless $ARGV[0] &amp;&amp; $ARGV[1]; printf("%#x\n", hex($ARGV[0]) + hex($ARGV[1]))' $t1 $t2</code></div><div></div></div><br /><div>Googlers: Alternatively, you can try my <font face="courier new, monospace">generate_gdb_command_file</font> script to automatically generate a gdb command file for adding all the symbol files.  For the "--top" command-line option, specify the path to where your image is mounted.  Then, pass the path to the file to which you redirected <font face="courier new, monospace">minidump-2-core's</font> stderr.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>/home/mkrebs/bin/scripts/generate_gdb_command_file --top 2913.84.5/image/rootfs/ ~/checkouts/cros/cros6/chroot/tmp/minidump.core.out &gt; minidump.gdb</code></div><div></div></div><br /><h3><a name="TOC-Start-debugger"></a><font size="4">Start debugger</font></h3><div><span style="font-size:10pt">Run gdb on the core file.</span></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>gdb --core minidump.core</code></div><div><code><font color="#9900ff">armv7a-cros-linux-gnueabi-gdb --core minidump.core</font></code></div><div></div></div><br /><div>Map executable's symbol file to base address of .text section.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code><font color="#000000">(gdb) add-symbol-file &lt;path to top-level "debug" directory&gt;/&lt;path to .debug file&gt; &lt;address from calculation&gt;</font></code></div><div></div></div><br /><div>Googlers: Alternatively, if you tried my <font face="courier new, monospace">generate_gdb_command_file</font> script, use the generated gdb command file to add all the symbol files.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>gdb --core minidump.core --command minidump.gdb</code></div><div></div></div><br /><h3><a name="TOC-Example"></a><font size="4">Example</font></h3><div></div><div class="sites-codeblock sites-codesnippet-block"><div><span style="font-size:10pt"><code>grep -w GUID minidump.core.txt | grep '"/opt/google/chrome/chrome"' | sed -e 's/-.*//'</code></span></div><div><code>0x72CC9000</code></div><div><code>objdump -h /usr/local/google/home/mkrebs/tmp/test/sigabrt/2913.45.0/image/rootfs/opt/google/chrome/chrome | \grep '\.text'|awk '{print $4}'</code></div><div><code>002a73e0</code></div><div><code>perl -e 'printf("%#x\n", hex($ARGV[0]) + hex($ARGV[1]))' 0x72CC9000 002a73e0</code></div><div><code>0x72f703e0</code></div><div></div></div><br /><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>gdb --core=minidump.core</code></div><div><code><font color="#000000">(gdb) add-symbol-file /usr/local/google/home/mkrebs/tmp/test/sigabrt/2913.45.0/debug/opt/google/chrome/chrome.debug 0x72f703e0</font></code></div><div></div></div><div><br /></div></div><div><br /></div><div><br /></div><h2><a name="TOC-If-backtrace-in-gdb-did-not-help"></a><font size="5"><u>If backtrace in gdb did not help</u></font></h2><div><span style="font-size:10pt">Sometimes, the gdb backtrace command (<a href="http://www.chromium.org/chromium-os/how-tos-and-troubleshooting/crash-reporting/debugging-a-minidump#TOC-Use-gdb-to-show-a-backtrace">Use gdb to show a backtrace</a>) doesn't show a stack trace any better than that of <font face="courier new, monospace">minidump_stackwalk</font> (</span><a href="http://www.chromium.org/chromium-os/how-tos-and-troubleshooting/crash-reporting/debugging-a-minidump#TOC-Use-minidump_stackwalk-to-show-a-stack-trace">Use minidump_stackwalk to show a stack trace</a>).<span style="font-size:10pt">  If you think there's more to it than what those two are showing you, try this method to naively dump all the known symbol addresses seen on the stack.  You'll see some false positives, but you may just find the name of a function that seems like a plausible place to look.</span></div><div><div><br /></div><div>First, start from the above step of <a href="http://www.chromium.org/chromium-os/how-tos-and-troubleshooting/crash-reporting/debugging-a-minidump#TOC-Use-gdb-to-show-a-backtrace" style="font-size:10pt">using gdb to show a backtrace</a><span style="font-size:10pt">.  We can reuse the gdb command file that was generated for it.  Googlers: If you didn't use my <font face="courier new, monospace">generate_gdb_command_file</font> script, you can manually create the gdb command file containing any "add-symbol-file" commands you ran.</span></div><div><br /></div><div>Second, determine the base address of the stack.  The easiest way is to just look at the stack address in the minidump.  This command will set the $sp_addr variable to the stack address of the first thread in the minidump:</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>set sp_addr=`~/checkouts/cros/cros6/chroot/usr/bin/minidump_dump upload_file_minidump-62893577d8a73070.dmp | perl -ne 's/^  stack.start_of_memory_range = // &amp;&amp; print &amp;&amp; exit'`</code></div><div></div></div><br /><div>If you want to be smarter, you can run <font face="courier new, monospace">minidump_stackwalk</font> on the minidump (using the appropriate Breakpad symbols) and skip past any stack frames you can assume are accurate.  You would do this by looking for the stack pointer of the last consecutive call frame found by "call frame info".  For example, for issue <a href="http://crosbug.com/35531">http://crosbug.com/35531</a> the stack pointer value would be <b>0x7e8b3440</b> given the following top-most (i.e. higher address) frames:</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code><font color="#000000">  7  Xorg!OsSigHandler [osinit.c : 146 + 0x11]</font></code></div><div><code><font color="#000000">      r4 = 0x76fc9f7c    r5 = 0x7e8b3440    r6 = 0x76bfb094    r7 = 0x00000000</font></code></div><div><code><font color="#000000">      r8 = 0x00000000    r9 = 0x00000020   r10 = 0x00000004    fp = 0x00000008</font></code></div><div><code><font color="#000000">      sp = 0x7e8b3430    pc = 0x76f90949</font></code></div><div><code><font color="#000000">     Found by: call frame info</font></code></div><div><code><font color="#000000">  8  libc-2.15.so + 0x25e6e</font></code></div><div><code><font color="#000000">      r4 = 0x774ec898    r5 = 0x76e9aeb8    r6 = 0x76bfb094    r7 = 0x00000000</font></code></div><div><code><font color="#000000">      r8 = 0x00000000    r9 = 0x00000020   r10 = 0x00000004    fp = 0x00000008</font></code></div><div><code><font color="#000000">      sp = 0x7e8b3440    pc = 0x76b40e70</font></code></div><div><code><font color="#000000">     Found by: call frame info</font></code></div><div><code><font color="#000000">  9  libc-2.15.so!new_do_write [fileops.c : 537 + 0x11]</font></code></div><div><code><font color="#000000">      sp = 0x7e8b345c    pc = 0x76b6abe5</font></code></div><div><code><font color="#000000">     Found by: stack scanning</font></code></div><div></div></div><br /><div>Finally, run the following <font face="courier new, monospace">gdb</font> command to dump 1024 words of the stack (i.e. potential addresses).  In the output, for any value that corresponds to a known symbol, <font face="courier new, monospace">gdb</font> will annotate it with the symbol's name in angle brackets.  Knowing that, we can simply pipe the output to something (in this case, <font face="courier new, monospace">perl</font>) to pull out any annotation it finds in the stack dump.</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>gdb --core minidump.core --batch --command minidump.gdb --eval-command "x/1024aw $sp_addr" |&amp; perl -ne '$re=qr{(&lt;((?:[^&lt;&gt;]++|(?-2))*+)&gt;)}; print "$2\n" while (s/0x[0-9a-f]+ $re//)'</code></div><div></div></div><br /><div>Reference: <a href="http://crosbug.com/35534#c2">http://crosbug.com/35534#c2</a></div></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=http://sites.google.com/a/chromium.org/dev/chromium-os/packages/crash-reporting/debugging-a-minidump">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="http://www.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9n9MwC5TMXJlOOI9uqlUsd9cQGnQJemuitG5445xEbI607046qMNqIcw1Fazz-viY1SlXbx-V4xTaB591fxaHT5qCgG2vQjgVmh-2d_SYMSOWbkhM/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('http://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'http://csi.gstatic.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
