<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/chromium-os","deleted":false,"title":"Chromium OS","dir":"ltr"},{"path":"/chromium-os/how-tos-and-troubleshooting","deleted":false,"title":"How Tos and Troubleshooting","dir":"ltr"},{"path":"/chromium-os/how-tos-and-troubleshooting/kernel-configuration","deleted":false,"title":"Kernel Configuration","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/chromium-os/how-tos-and-troubleshooting/kernel-configuration\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/chromium-os/how-tos-and-troubleshooting","parentWuid":"wuid:gx:72ecb36fa9c83ecd","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Kernel Configuration","locale":"en","wuid":"wuid:gx:452883f43073ebe8","revision":21,"path":"/chromium-os/how-tos-and-troubleshooting/kernel-configuration","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"kernel-configuration","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Kernel Configuration - The Chromium Projects" />
<meta itemprop="name" content="Kernel Configuration - The Chromium Projects" />
<meta property="og:title" content="Kernel Configuration - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Kernel Configuration - The Chromium Projects</title>
<meta itemprop="image" content="https://www.chromium.org/_/rsrc/1295028130350/chromium-os/how-tos-and-troubleshooting/kernel-configuration/kernel_config_diag.png?height=274&amp;width=400" />
<meta property="og:image" content="https://www.chromium.org/_/rsrc/1295028130350/chromium-os/how-tos-and-troubleshooting/kernel-configuration/kernel_config_diag.png?height=274&amp;width=400" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../developers/discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../../chromium-os.1.html" dir="ltr">Chromium OS</A>‎ &gt; ‎<A href="../how-tos-and-troubleshooting.1.html" dir="ltr">How Tos and Troubleshooting</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Kernel Configuration</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><h2><a name="TOC-1"></a><span style="display:inline"><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Overview"><strong>1 </strong>Overview</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Conversions"><strong>2 </strong>Conversions</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Scripts"><strong>3 </strong>Scripts</a><ol class="goog-toc"><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-kernelconfig"><strong>3.1 </strong>kernelconfig</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-prepareconfig"><strong>3.2 </strong>prepareconfig</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-splitconfig"><strong>3.3 </strong>splitconfig</a></li></ol></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Using-the-kernelconfig-script"><strong>4 </strong>Using the kernelconfig script</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Make-a-change-to-the-config-"><strong>5 </strong>Make a change to the config </a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Alternative-Method-to-Edit-Config"><strong>6 </strong>Alternative Method to Edit Config</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Comparing-in-tree-config-to-split-config"><strong>7 </strong>Comparing in-tree config to split config</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Manual-Building"><strong>8 </strong>Manual Building</a><ol class="goog-toc"><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Generate-a-new-splitconfig-after-adding-new-Kconfig-options"><strong>8.1 </strong>Generate a new splitconfig after adding new Kconfig options</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-Adding-a-new-config"><strong>8.2 </strong>Adding a new config</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-How-can-I-find-the-list-of-flavour-configs"><strong>8.3 </strong>How can I find the list of flavour configs</a></li><li class="goog-toc"><a href="kernel-configuration.1.html#TOC-How-to-regenerate-and-validate-splitconfigs-from-single-config"><strong>8.4 </strong>How to regenerate and validate splitconfigs from single config</a></li></ol></li></ol></div></div></div></div></span></h2>
<h2><a name="TOC-Overview"></a>Overview</h2>
<p>Kernel configuration is a little complicated in Chromium OS. There are a number of different kernels based on architecture (x86, ARM) variants (generic, exynos) and platforms (Seaboard, Mario). We want to split the config into a sort of hierarchy so that the common options are shared between the variants (click to enlarge):</p>
<div><a href="kernel-configuration/kernel_config_diag.png%3Fattredirects=0" imageanchor="1"><img border="0" height="274" src="../../_/rsrc/1295028130350/chromium-os/how-tos-and-troubleshooting/kernel-configuration/kernel_config_diag.png%3Fheight=274&amp;width=400" width="400" /></a></div>
<p>Shown here are 6 flavours, three for ARM and three for Intel (it is not clear why flavours is spelt the British way). Two of the variants are not actually distinct - these are are shown with arrows and are symlinks in the directory. In this case chromeos-arm just points to chromiumos-arm and they are the same.</p>
<h2><a name="TOC-Conversions"></a>Conversions</h2>
<p>We need to be able to do the following:</p>
<div>
<ul><li>create a .config file for a particular flavour - this is done simply by concatenating the three levels for a particular flavour. For example we create the tegra2 flavour by concatenating base.config, armel/common.config and armel/chromeos-tegra2.flavour.config. This .config file is suitable for configuring the kernel.</li>
<li>split a .config into its constituent parts. This is a little more complicated and has to be done for all flavours at once. Given a .config file for each flavour we can look for items which are common to all flavours - these can be put into the family config. We also look for everything common within each architecture - these are put into the architecture files like config.common.arm. The splitconfig script does this.</li></ul>
</div>
<h2><a name="TOC-Scripts"></a>Scripts</h2>
<p>Scripts to deal with the kernel configuration are in the chromeos/scripts directory:</p>
<div>
<div class="sites-codeblock sites-codesnippet-block">
<div><code>$ ls chromeos/scripts/</code></div>
<div><code>compat_wireless_config  kernelconfig  prepareconfig  splitconfig</code></div></div></div>
<h3><a name="TOC-kernelconfig"></a>kernelconfig</h3>
<p>This script deals with each separate flavour in turn, performing the selected operations. It starts by building the config for each flavour, does the operations, and afterwards it splits the flavour configs back into the proper hierarchy.  It supports three operations</p>
<div>
<ul><li>oldconfig - does a 'make oldconfig' on each config</li>
<li>editconfig - does a 'make menuconfig' on each config</li>
<li>genconfig - like oldconfig, but it leaves the generated full config files lying around afterwards in the CONFIGS directory</li></ul>
<p>There is a bit of a problem with kernelconfig. If you want to change a kernel option which is common to all flavours, for example, then you must change it once for each flavour using 'kernelconfig editconfig'. At the moment this is 6 times! If you miss one, then the result may be no change which can be very confusing. See below for another approach.</p>
</div>
<h3><a name="TOC-prepareconfig"></a>prepareconfig</h3>
<p>This is used to prepare the config for a particular flavour. It assembles the default config for the flavour, then embeds CONFIG_VERSION_SIGNATURE in the config file, which is a string like 'Ubuntu ${release}-${revision}-${flavour}' where release and revision are obtained from the changelog and the flavour is passed in on the command line.</p>
<p><span style="background-color:transparent;font-size:10pt">This is useful when starting development on a board and you want to build in-tree:</span></p>
<div class="sites-codeblock sites-codesnippet-block" style="font-weight:normal;background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:14px">
<div><code>./chromeos/scripts/prepareconfig chromeos-tegra2</code></div>
<div><code>export ARCH=arm</code></div>
<div><code>export CROSS_COMPILE=armv7a-cros-linux-gnueabi-</code></div>
<div><code>make oldconfig    #(to pick up new options, if any)</code></div>
<div><code>make</code></div>
<div><code>...</code></div>
</div>
<p><span style="background-color:transparent;font-size:10pt">This script is used in the emerge. An example resulting string is 'Ubuntu 2.6.32-0.1-chromeos-tegra2'.</span></p>
<h3><a name="TOC-splitconfig"></a>splitconfig</h3>
<p>This takes all config.* files in the currect directory and works out the common options in each. It writes these to config.common, then generates new config.* files (overwriting the original ones) with these common options removed. As a side effect, all config options will be in sorted order.</p>
<p><span style="background-color:transparent;font-size:10pt">This script is used by kernelconfig to extract the common options for an architecture, then again on a second level to extract the common options for Chromium OS.</span></p>
<h2><a name="TOC-Using-the-kernelconfig-script"></a>Using the kernelconfig script</h2>
<p>The kernel config is split into several config files - generic, chrome-specific, architecture-specific and board specific. Automatic tools split and combine these configs.</p>
<p><span style="background-color:transparent;font-size:10pt">If you want to edit the configuration for a particular board etc. then you need to do something like:</span></p>
<div class="sites-codeblock sites-codesnippet-block" style="font-weight:normal;background-color:rgb(239,239,239);border:1px solid rgb(211,211,211);display:block;padding:0.5em 0px 0.5em 1em;line-height:14px">
<div><code>$ cd .../src/third_party/kernel/v$VER/</code></div>
<div><code>$ ./chromeos/scripts/kernelconfig editconfig</code></div>
</div>
<p style="font-size:13.3333330154419px">The exact value for $VER depends on your board as each one is different. You can find that out by seeing what version by running <code>`emerge-$BOARD -pv virtual/linux-sources`</code>.</p><p><span style="font-size:10pt;background-color:transparent">This will run 'make menuconfig' for each part of the config. At the time of writing (Oct-10) this is:</span></p>
<div>
<ul><li>x86_64/chromeos-intel-pineview.flavour.config</li>
<li>i386/chromeos-intel-menlow.flavour.config</li>
<li>i386/chromeos-pinetrail-i386.flavour.config</li>
<li>i386/chromiumos-i386.flavour.config</li>
<li>armel/chromeos-arm.flavour.config</li>
<li>armel/chromeos-tegra2.flavour.config</li>
<li>armel/chromiumos-arm.flavour.config</li></ul>
</div>
<p>You need to figure out which part your config options appear in, and then make the changes when that config comes up. When it says 'press a key', you have to press &lt;enter&gt;.</p>
<h2><a name="TOC-Make-a-change-to-the-config-"></a>Make a change to the config </h2>
<p>Run editconfig to modify each config appropriately using menuconfig and then regenerate the splitconfigs. The editconfig script will run "make menuconfig" on each flavor config. Please make appropriate changes for each menuconfig run and the script will generate the correct splitconfig.</p>
<div class="sites-codeblock sites-codesnippet-block"><code>cd /path/to/kernel</code><br />
<code>chromeos/scripts/kernelconfig editconfig # regenerate splitconfig</code></div>
<h2><a name="TOC-Alternative-Method-to-Edit-Config"></a>Alternative Method to Edit Config</h2>
<p>Maybe this will work for you:</p>
<div>
<ul><li>Look for the kernel config option you want to edit</li></ul>
<div class="sites-codeblock sites-codesnippet-block"><code>$ grep -rs CONFIG_NETWORK_FILESYSTEMS chromeos/config/<br />
chromeos/config/base.config:# CONFIG_NETWORK_FILESYSTEMS is not set</code></div>
</div>
<div>
<ul><li>Now edit that file <code>chromeos/config/base.config</code> to change the config like this:</li></ul>
<div class="sites-codeblock sites-codesnippet-block">
<div><code># CONFIG_NETPOLL_TRAP is not set</code></div>
<div>
<div><s><code># CONFIG_NETWORK_FILESYSTEMS is not set</code></s></div>
<div><code>CONFIG_NETWORK_FILESYSTEMS=y</code></div>
<div><code>CONFIG_NETWORK_SECMARK=y</code></div>
<div><code># CONFIG_NET_9P is not set</code></div>
</div>
</div>
<ul><li>Now run this to recreate all the configs based on your changes</li></ul>
<div>
<div class="sites-codeblock sites-codesnippet-block"><span style="font-family:monospace;color:rgb(0,96,0);line-height:26px"><code>$ </code></span><code>chromeos/scripts/kernelconfig oldconfig</code></div>
</div>
<ul><li>If you are asked questions, press return to accept the default. If needed you can change it by editing the file on your next run around this method.<br />
</li>
<li>Rinse and repeat</li></ul>
</div>
<h2><a name="TOC-Comparing-in-tree-config-to-split-config"></a>Comparing in-tree config to split config</h2>
<p>This might not be useful, but:</p>
<div class="sites-codeblock sites-codesnippet-block">
<code># get full flavour config sorted, without leading #<br />
FLAVOUR=chromeos-tegra2 cat chromeos/config/base.config \<br />
   chromeos/config/armel/common.config \<br />
   chromeos/config/armel/$FLAVOUR.flavour.config | \<br />
   grep CONFIG_ | sed "s/.*CONFIG/CONFIG/" | sort -u &gt;1.emerge<br />
<br />
# purify .config in the same way<br />
cat .config | grep CONFIG_ | sed "s/.*CONFIG/CONFIG/" | sort &gt;2.config<br />
<br />
# compare<br />
diff 1.emerge 2.config</code>
</div>
<h2><a name="TOC-Manual-Building"></a>Manual Building</h2>
<p>Here is how to build the kernel yourself manually, from within the chroot.</p>
<p>Make sure you have done something like:</p>
<div class="sites-codeblock sites-codesnippet-block">
<code>export B="tegra2_seaboard"<br />
export ARCH=arm<br />
export CROSS_COMPILE=armv7a-cros-linux-gnueabi-<br />
<br />
# indicate that you are making kernel changes<br />
cros_workon start --board=$B sys-kernel/chromeos-kernel-$VER</code></div>
<p>The exact value for $VER depends on your board as each one is different. You can find that out by seeing what version by running <code>`emerge-$BOARD -pv virtual/linux-sources`</code>.</p><p>As you probably know, the <code>cros_workon start</code> tells the build system to use your local source install of the official source. Then set up the config:</p>
<div class="sites-codeblock sites-codesnippet-block">
<code># set up the .config file<br />
./chromeos/scripts/prepareconfig chromeos-tegra2<br />
make oldconfig<br />
<br />
# edit config<br />
make menuconfig<br />
# (make your changes)</code>
</div>
<p>Now, after you make a kernel change, you can simply type <code>make</code> as normal:</p>
<div class="sites-codeblock sites-codesnippet-block">
<code># build the kernel and modules<br />
make<br />
<br />
# or maybe: build the uImage on an 8 core machine<br />
make -j10 uImage<br />
<br />
# or both!<br />
make &amp;&amp; make uImage</code>
</div>
<h3><a name="TOC-Generate-a-new-splitconfig-after-adding-new-Kconfig-options"></a>Generate a new splitconfig after adding new Kconfig options</h3>
<p>Run oldconfig to regenerate the splitconfigs. The oldconfig script will run "make oldconfig" on each flavor config. Please answer appropriately when prompted by oldconfig.  /path/to/kernel may be &lt;something&gt;/src/third_party/kernel/files, but this may change.</p>
<div class="sites-codeblock sites-codesnippet-block"><code>cd /path/to/kernel<br />
chromeos/scripts/kernelconfig oldconfig # regenerate splitconfig</code></div>
<h3><a name="TOC-Adding-a-new-config"></a>Adding a new config</h3>
<p>Copy the new config to the appropriate place in the chromeos/config and then run oldconfig</p>
<div class="sites-codeblock sites-codesnippet-block"><code>cd /path/to/kernel<br />
cp config.flavour.chromeos-new .config<br />
make ARCH=${ARCH} oldconfig<br />
cp .config chromeos/config/&lt;arch&gt;/&lt;flavour&gt;.flavour.config<br />
chromeos/scripts/kernelconfig oldconfig # regenerate splitconfig<br />
</code></div>
<h3><a name="TOC-How-can-I-find-the-list-of-flavour-configs"></a>How can I find the list of flavour configs</h3>
<div class="sites-codeblock sites-codesnippet-block"><code>cd /path/to/kernel<br />
find chromeos/config -name \*.flavour.config</code></div>
<h3><a name="TOC-How-to-regenerate-and-validate-splitconfigs-from-single-config"></a>How to regenerate and validate splitconfigs from single config</h3>
<div class="sites-codeblock sites-codesnippet-block"><code>cd /path/to/kernel<br />
cp &lt;single config&gt; chromeos/config/&lt;arch&gt;/&lt;flavour&gt;.flavour.config<br />
chromeos/scripts/kernelconfig oldconfig<br />
chromeos/scripts/prepareconfig &lt;flavour&gt;<br />
make ARCH=${ARCH} oldconfig<br />
diff .config &lt;single config&gt;</code></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/chromium-os/how-tos-and-troubleshooting/kernel-configuration">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq92mIESmkaJwK6xOCMwho2epu3cvJBtGWT9MMPN9YiaUMrsm20PqoQPiEbzt4i2e99v6-4kfcg9tYkIEIhbeGr6Cbjf79yfxsRWdUDJ-8boe4TPuUt/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
