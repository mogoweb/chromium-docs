<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/tree-sheriffs","deleted":false,"title":"Tree Sheriffs","dir":"ltr"},{"path":"/developers/tree-sheriffs/sheriff-details-nacl","deleted":false,"title":"Sheriff details: NaCl","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/tree-sheriffs/sheriff-details-nacl\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/tree-sheriffs","parentWuid":"wuid:gx:24b52fca28997d96","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Sheriff details: NaCl","locale":"en","wuid":"wuid:gx:548df0ca7ca8abe8","revision":52,"path":"/developers/tree-sheriffs/sheriff-details-nacl","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"sheriff-details-nacl","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Sheriff details: NaCl - The Chromium Projects" />
<meta itemprop="name" content="Sheriff details: NaCl - The Chromium Projects" />
<meta property="og:title" content="Sheriff details: NaCl - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Sheriff details: NaCl - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/tree-sheriffs" dir="ltr">Tree Sheriffs</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Sheriff details: NaCl</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-What-to-watch"><strong>1 </strong>What to watch</a></li><li class="goog-toc"><a href="#TOC-When-to-close-the-tree"><strong>2 </strong>When to close the tree</a></li><li class="goog-toc"><a href="#TOC-Common-Tasks"><strong>3 </strong>Common Tasks</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Reverting-Changes"><strong>3.1 </strong>Reverting Changes</a></li><li class="goog-toc"><a href="#TOC-Compile-Failure"><strong>3.2 </strong>Compile Failure</a></li><li class="goog-toc"><a href="#TOC-Handling-failing-flaky-tests"><strong>3.3 </strong>Handling failing &amp; flaky tests</a></li><li class="goog-toc"><a href="#TOC-Updating-the-DEPS"><strong>3.4 </strong>Updating the DEPS</a></li><li class="goog-toc"><a href="#TOC-Updating-Chrome-s-revision-in-NaCl"><strong>3.5 </strong>Updating Chrome's revision in NaCl</a></li><li class="goog-toc"><a href="#TOC-Updating-the-NaCl-perf-expectations"><strong>3.6 </strong>Updating the NaCl perf expectations</a></li><li class="goog-toc"><a href="#TOC-Updating-the-NaCl-toolchain"><strong>3.7 </strong>Updating the NaCl toolchain</a></li><li class="goog-toc"><a href="#TOC-Updating-NaCl-s-revision-in-Chrome"><strong>3.8 </strong>Updating NaCl's revision in Chrome</a></li><li class="goog-toc"><a href="#TOC-Updating-the-NaCl-and-Toolchain-revision-in-the-NaCl-SDK"><strong>3.9 </strong>Updating the NaCl and Toolchain revision in the NaCl SDK</a></li></ol></li></ol></div></div></div></div>This page has details to help NaCl sheriffs. For more general information and procedures, first read <a href="https://www.chromium.org/developers/tree-sheriffs">Tree Sheriffs</a>.</div><div><br /></div><div><b>Useful Links:</b> <a href="http://build.chromium.org/p/client.nacl/console">NaCl waterfall</a> | <a href="http://build.chromium.org/p/chromium/console">Chrome waterfall</a> | <a href="https://www.chromium.org/nativeclient/day-to-day/infrastructure-faq" style="color:rgb(85,26,139)">Infrastructure FAQ</a> | <a href="https://www.google.com/calendar/hosted/google.com/render?cid=Z29vZ2xlLmNvbV9uZWNubGYyNnNsZ2o4ZWJwOHBlbjQwMjBra0Bncm91cC5jYWxlbmRhci5nb29nbGUuY29t" target="_blank">NaCl Build Sheriff Calendar</a></div><h2><a name="TOC-What-to-watch"></a>What to watch</h2><div><ul><li><a href="http://build.chromium.org/p/client.nacl/waterfall?show_events=true&amp;failures_only=true&amp;reload=120">Failures only waterfall</a></li><li><a href="http://build.chromium.org/p/client.nacl/console?reload=120">Console view</a>, to make sure the bots aren't not too far behind (try the "collapse" and "merge" links to get a more compact overall view that shows you what's been tested together)</li><li><a href="http://dev.chromium.org/contact/-chromium-irc">#Chromium IRC</a> on freenode (you're the point person for Chromium-NaCl build failures on the Chrome tree)</li><li>Be available on IM</li><li>Periodically check the waterfalls that aren't on the main page: (linked to in the upper left of the main waterfall page)</li><ul><li><a href="http://build.chromium.org/p/client.nacl.toolchain/console">Toolchain</a></li><li><a href="http://build.chromium.org/p/client.nacl.chrome/console">Chrome Integration</a></li><li><a href="http://build.chromium.org/p/client.nacl.sdk/console">SDK</a> (NOTE: The 'trout' column refers to the current release branch, and is only built when someone checks-in a change to the trout branch)</li><li><a href="http://build.chromium.org/p/client.nacl.ports/console">NaCl Ports</a></li><li><a href="http://build.chromium.org/p/tryserver.nacl/waterfall">Trybots</a> (look for repeated failures due to infrastructure issues - contact a trooper if you see one)</li></ul></ul></div><h2><a name="TOC-When-to-close-the-tree"></a>When to close the tree</h2><div>Whether you close the tree or not, be sure to update the status message with the relevant details about who's whether you expect the bot to cycle green or who's investigating a problem.</div><div><ul><li>A test went red: <font color="#bf9000">Tree maybe closed</font></li><ul><li>If the cause is obvious (the FooShouldWork test broke, and someone just checked in changes to foo_utils.cc), the tree can stay open. <b>Revert the change</b>, sending the review to the person. </li><li>If the cause isn't obvious, <font color="#990000">close the tree</font>. Ask everyone on the blamelist to help track it down and revert the patch as soon as found.</li></ul><li>A test occasionally goes red:  <font color="#38761d">Tree open</font></li><ul><li>This is a flaky test. If the change is obvious, <b>revert the change</b>.</li><li>If the change isn't obvious, disable the test <b>and </b>file a bug. See below for details</li></ul><li>One category of bot fails to build or has a swarm of test failures: <font color="#990000">Tree closed</font></li><li>One bot went red: <font color="#38761d">Tree open</font></li><ul><li>If only one buildbot is having problems (can't update, can't compile, exploding in some other way), the tree can stay open while it's fixed. We have reasonable redundant coverage now. Ask a trooper for help.</li></ul><li>A slave is hung at a step: <font color="#bf9000">Tree maybe closed</font></li><ul><li>If a slave hangs, sometimes just cancelling the build may not work. In that case call a trooper.</li></ul><li>Bot warns about performance improvement: <font color="#38761d">Tree open</font></li><ul><li>If it is obvious why, update the nacl_perf_expectations.json to set a new bound.</li><li>See note below about README for how update nacl_perf_expectations.json.</li><li>Check the graph to see if it is stable.</li><ul><li>To see the graph, click the [results] link which is right next to the PERF_IMPROVE message.</li></ul></ul><li>Bot warns about performance regression: <span style="color:rgb(191,144,0)">Tree maybe closed</span></li><ul><li>Check the [results] link which is right next to the PERF_REGRESS message. See how big of a spike in timings this is. See if it is a flake.</li><li>If it is not a flake:</li><li>If it is obvious why and unacceptable <b>revert the change. </b>Consult w/ the CL author.</li><li>If it is obvious why and considered acceptable (e.g., for security reasons), update nacl_perf_expectations.json to set a new bound. Consult w/ the CL author.</li><li>NOTE: the performance results link may occasionally get broken.  It's usually: something like <a href="http://build.chromium.org/f/client/perf/nacl-lucid_64-newlib-x86_32-pnacl-spec/spec2k/report.html?history=150">http://build.chromium.org/f/client/perf/nacl-lucid_64-newlib-x86_32-pnacl-spec/spec2k/report.html?history=150</a></li><ul><li>The link has "client" instead of "chromium"!</li></ul><li><span style="background-color:transparent;font-size:10pt">You can also check older results in the performance graph by changing "history=150" to "history=X" where X &gt; 150 and you can set change the "rev=-1" to a different ending rev.</span></li><li><span style="background-color:transparent;font-size:10pt">There is a newer performance dashboard linked from the </span><span style="background-color:transparent;font-size:10pt">"[</span><a href="https://chromeperf.appspot.com/report?masters=NativeClient&amp;bots=lucid-64-bare-newlib-opt&amp;tests=naclperf&amp;rev=12576" style="background-color:transparent;font-size:10pt">Results Dashboard</a><span style="background-color:transparent;font-size:10pt">]" link. The old [results] link will be deprecated later.</span></li><ul><li>You must be logged into google.com account to access it.</li></ul><li>To look for the buildbot test log output, search for "RESULT ${TestName...}". E.g., "RESULT TestThreadCreateAndJoin" under the buildbot stdio links.</li></ul><li>One of the bots on one of the non-main-page waterfalls is broken: <span style="color:rgb(191,144,0)">Tree maybe closed</span></li><ul><li>Toolchain: TBD</li><li>Chrome Integration: TBD</li><li>SDK: TBD</li><li>NaCl Ports: TBD</li></ul><li><i>TBD: fill in more NaCl-specific issues</i></li></ul></div><h2><a name="TOC-Common-Tasks"></a>Common Tasks</h2><h3><a name="TOC-Reverting-Changes"></a>Reverting Changes</h3><div><ul><li>RECOMMENDED: Use drover:</li><ul><li><a href="http://dev.chromium.org/developers/how-tos/drover">http://dev.chromium.org/developers/how-tos/drover</a></li><li>Setup a directory with drover.properties containing:</li><li><pre style="background-color:rgb(224,234,244);border:1px solid rgb(169,206,241);overflow:auto;padding-left:1em;padding-top:0.5em;padding-bottom:0.5em"><font color="#006000" face="Times" size="3">BASE_URL = "svn://svn.chromium.org/native_client"<br />TRUNK_URL = "svn://svn.chromium.org/native_client/trunk"<br />BRANCH_URL = BASE_URL + "/branches/$branch"<br />SKIP_CHECK_WORKING = True<br />FILE_PATTERN = r"[ ]+([MADUC])[ ]+/((?:trunk|branches/\d+)(.*)/(.*))"</font>
</pre>Then run:<pre style="background-color:rgb(224,234,244);border:1px solid rgb(169,206,241);overflow:auto;padding-left:1em;padding-top:0.5em;padding-bottom:0.5em"><font color="#006000" face="Times" size="3">drover --revert CLNUM</font></pre><div><br /></div></li></ul><li>Other methods:</li><ul><li>The easiest way: (from a git checkout) <font face="courier new, monospace">git revert &lt;hash&gt; &amp;&amp; git cl dcommit --tbr --bypass-hooks</font></li><li>The hard way: (from a svn checkout) <font face="courier new, monospace">gclient sync ; svn merge -c -1234 . ; gcl change XXXX ; gcl commit XXXX</font></li></ul></ul><div><br /></div></div><h3><a name="TOC-Compile-Failure"></a>Compile Failure<br /></h3><div><ul><li><b><font color="#ff0000">REVERT</font></b></li><li>Waiting for a fix it not a good idea. Just revert until it compiles again.</li><li>If it's not clear why compile failed, contact a trooper.</li><li>NOTE:  For a nacl toolchain, revert persistent problems by reverting the DEPS, for flakiness file a bug.<br /></li></ul><div><br /></div></div><h3><a name="TOC-Handling-failing-flaky-tests"></a>Handling failing &amp; flaky tests</h3><div>In recent experience most flakeyness is due to flakey bot infrastructure, not flakey tests. If you see that a failure on a bot is not repeatable across consecutive runs or failures on multiple bots, try forcing a build for that bot to see if the failure is repeatable.</div><div><br /></div><div>If no recent commit is the source of the problem then proceed with the steps below.</div><div><ul><li>Head over to code.google.com/p/nativeclient/issues and file a bug indicating the failure and that the test has been disabled.  Make sure to include sample output from the test (since the buildbots don't keep the data forever). Make sure to assign an owner, usually whoever modified the test last from a svn blame.</li><li>Disable the test.  (unfortunately, we don't have a flaky test mechanism like chromium)</li><li>In the change description add the line "BUG=xyz" where xyz is the bug number you filed</li><li>Ping the owner directly.  If you have time and relevant knowledge, assist the owner in tracking down the flake.</li></ul>Use the issue tracker to track progress on resolving flakeyness: http://code.google.com/p/nativeclient/issues/list?can=2&amp;q=label%3AFlakeyBots<br /><div><br /></div><h3><a name="TOC-Updating-the-DEPS"></a><b><font size="3">Updating the DEPS</font></b></h3><div>DEPS files should be updated:</div><div><ul><li>NaCl's revision in Chrome.  It is not essential for the sheriff to do this -- see below.</li><li>Chrome's revision in NaCl.  Since this is only used for testing, it is relatively low priority.</li><li>NaCl toolchain (to a rev after the chrome revision has been updated - this means you should wait for the toolchain to build after the previous DEPS update)</li><li>NaCl's and the toolchain's revision in the NaCl SDK (could be done before or in parallel with updating NaCl's revision in Chrome)</li></ul><div>Note:  The ordering of these updates used to be significant, but that is no longer the case, now that the NaCl toolchain no longer contains libraries (such as libppruntime) that need to be synchronized with the NaCl plugin.</div></div><div><br /></div><div><h3><a name="TOC-Updating-Chrome-s-revision-in-NaCl"></a>Updating Chrome's revision in NaCl</h3><div><ul><li>Check out NaCl.</li><li>Find the appropriate revision of Chrome.</li><li>Update "<b>chrome_rev</b>" in native_client/DEPS.</li><li>Upload the change and verify that the change doesn't break the build on <a href="http://build.chromium.org/p/tryserver.nacl/waterfall" style="color:rgb(0,102,204);outline-style:none">NaCl's trybots</a>.</li><li>Get the CL reviewed. Bradley Nelson, Noel Allen, Nick Bray or David Sehr are good candidates</li><li>Submit the CL</li><li>Verify that the CL does not break the build on <a href="http://build.chromium.org/p/client.nacl/console" style="color:rgb(0,102,204);outline-style:none">NaCl's build bots</a>.</li><ul><li>If it does, revert the change (see above for details). Reopen the tree if necessary.</li></ul></ul></div></div></div><div><div><div><h3><a name="TOC-1"></a><br /></h3><h3><a name="TOC-Updating-the-NaCl-perf-expectations"></a>Updating the NaCl perf expectations</h3></div><div><span style="background-color:transparent;font-size:10pt">This should only happen if there are performance improvements or regressions (e.g., PERF_REGRESS messages).</span></div><div><span style="background-color:transparent;font-size:10pt"><br /></span></div><div>At this point you've decided that the regression should be accepted and you've read through the "When to close the tree" section above. All the remains is to update the test expectations. To do so, s<span style="background-color:transparent;font-size:10pt">ee native_client/tools/nacl_perf_expectations/README. The basic steps are:</span></div><div><div><ol><li>Update the nacl_perf_expectations.json file w/ a new range of revisions [revA, revB] reflecting the new expected performance.</li><li>Run the tool to automatically grab improve/regress bounds. This will update the .json file.</li><li>Get a CL to check in the new .json file.</li></ol><div><br /></div></div></div><div><ul></ul></div></div><h3><a name="TOC-Updating-the-NaCl-toolchain"></a>Updating the NaCl toolchain</h3></div><div><ul><li>Check out NaCl</li><li>Find a valid toolchain using the script specifying the highest rev number to start searching at: <br /></li><ul><li>nacl/native_client$<b> python build/find_toolchain_revisions.py -s &lt;Starting_Rev_Number&gt;<br /></b></li></ul><li>While
 not recommended, you can find toolchains manually by checking the 
toolchain bot output and looking at the archive directories such as:</li><ul><li><b><a href="http://gsdview.appspot.com/nativeclient-archive2/x86_toolchain/r5188/">http://gsdview.appspot.com/nativeclient-archive2/x86_toolchain/r5188/</a></b></li></ul><ul><li><span style="border-collapse:collapse;font-family:arial,sans-serif"><b><a href="http://gsdview.appspot.com/nativeclient-archive2/toolchain/5179/" style="color:rgb(0,0,204)" target="_blank">http://gsdview.appspot.com/nativeclient-archive2/toolchain/5179/</a></b></span></li><li>Note that because several commits may go into NaCl close together, not every revision will have a toolchain build.</li><li>It can be useful to include the link for the revision(s) you are updating to into the CL description.</li></ul><li>Update "<b>arm_toolchain_version</b>" and "<b>x86_toolchain_version</b>" lines in the native_client/DEPS. </li><ul><li>If all toolchain files are in place, you may be able to set arm and x86 versions to the same number. Otherwise, you might have to set them to slightly different versions.</li></ul><li>Get the CL reviewed.  Bradley Nelson, Noel Allen, and David Sehr are good candidates. Make sure to include someone from the Moscow office, such as Victor Khimenko as a reviewer too -- they can help point out cases where you are trying to move to a toolchain that is not good.</li><li>Make sure to do a "gcl try" and verify that the CL does not break the build on <a href="http://build.chromium.org/p/tryserver.nacl/waterfall" style="color:rgb(85,26,139)">NaCl's trybots</a>.</li><li>If you have an LGTM and green trybots, then submit the CL.</li><li>Verify that the CL does not break the build on <a href="http://build.chromium.org/p/client.nacl/console">NaCl's build bots</a>.</li><ul><li>If it does, revert the change (see above for details). Reopen the tree if necessary.</li></ul></ul><div><br /></div><div><h3><a name="TOC-Updating-NaCl-s-revision-in-Chrome"></a>Updating NaCl's revision in Chrome</h3></div><div>Note that it is no longer necessary for the NaCl sheriff to do this.  mseaborn@chromium.org has a script which automates this (nacl_deps_bump.py in <a href="https://github.com/mseaborn/nacl-dev-tools">https://github.com/mseaborn/nacl-dev-tools</a>) which gets run every week day.</div><div><ul><li>Take a look at the <a href="http://build.chromium.org/p/client.nacl.chrome/console" style="color:rgb(0,102,204);outline-style:none">NaCl integration bots</a>. If any of them is failing, updating NaCl's revision in Chrome will probably break Chrome's build. Proceed only if you know what's causing the failure and why it will not happen in Chrome. (As of May 16, this is not strictly true, as NaCl tests are mostly turned off. If your try succeeds, you will likely be able to update DEPS.)</li><li>Checkout and build Chrome: (<a href="http://www.chromium.org/developers/how-tos/build-instructions-windows" style="color:rgb(0,102,204);outline-style:none">Windows</a>, <a href="http://code.google.com/p/chromium/wiki/MacBuildInstructions" style="color:rgb(0,102,204);outline-style:none">Mac OS X</a>, and <a href="http://code.google.com/p/chromium/wiki/LinuxBuildInstructions" style="color:rgb(0,102,204);outline-style:none">Linux</a>)</li><li>Update Native Client's revision (<i>nacl_revision</i>) and the tools version (<i>nacl_tools_revision</i>) in src/DEPS</li><ul><li><i>nacl_tools_revision</i> should match <i>tools_rev</i> from native_client/DEPS, <b>not  the toolchain version</b></li></ul><li>Run <i>gclient runhooks</i> to get the new hashes for nacl_irt_hash* entries in src/DEPS. Update those entries. Run gclient runhooks again to verify the hashes match. If the python script fails, it's likely because the IRT files do not exist. It sometimes takes a while for them to get uploaded.</li><li>Upload the change and verify that the change doesn't break the build on the <a href="http://build.chromium.org/p/tryserver.chromium/waterfall" style="color:rgb(0,102,204);outline-style:none">Chromium trybots</a>.</li><ul><li>On Linux, the incremental build is overly aggressive and stale build products can cause your compile to fail when it shouldn't. If you suspect this is the case, submit your try with a clobber (gcl try foo -c). If that succeeds, you will probably have to do the same on the Chrome Bots when you commit. Just let the Chrome sheriffs know you are doing this. There are about 7 Linux builders that will go red. Click on the top Bot tab and force a rebuild with a clobber.</li><li>If you get a seemingly unrelated failure on a Chrome test, there's a good chance it's flaky. Ask someone on the Chrome team.</li></ul><li>Get the CL reviewed. Bradley Nelson, Noel Allen, David Sehr are good candidates</li><li>Make sure you're on #chromium on IRC in case there are failures</li><li>Submit the CL  (if you check the "commit" box on the review site, it will run a try job and commit it for you if the try job passes.  This is handy, particularly if the Chrome tree is red.)</li><li>Verify that the CL does not break the build on <a href="http://build.chromium.org/p/chromium/console" style="color:rgb(0,102,204);outline-style:none">Chrome's build bot</a>.</li><ul><li>If the build breaks, revert the change (using drover script from depot_tools is recommended). Tell the IRC channel.  Work with the sheriff to reopen the tree.</li></ul></ul><div><br /></div><div><h3><a name="TOC-Updating-the-NaCl-and-Toolchain-revision-in-the-NaCl-SDK"></a>Updating the NaCl and Toolchain revision in the NaCl SDK</h3><div><ul><li>Check out a writable version of the <a href="https://www.chromium.org/system/errors/NodeNotFound?suri=wuid:gx:5cce54fa3ca9f4c" target="_blank" class="disabled">NaCl SDK source code</a>.  If you don't have write access, either request access from the owners, or coordinate with an SDK team member for submitting the change.</li><li>In src/DEPS, update native_client_version to the same version that you used in updating Chrome.  Also, update x86_toolchain_version to the same version as what went into the NaCl DEPS file.</li><li>Submit a try job with the change (i.e., 'gcl try' or 'git try') and make sure the try succeeds.</li><li>Get the CL reviewed (good candidates: dspringer, mball, mlinck) and check it in, or forward the patch to an SDK member for checking in.</li></ul></div></div></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/tree-sheriffs/sheriff-details-nacl">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9j_brlnX04ncC3MCs5v59HldoWHCGE9xfAvNO20rcFOjD7eYFS9gTCBylEf4XJRYHHF8-4M4-Y1ts7-HzuIAJ_wVsCvRvDQ89UR9nTS3OHWdQmoDT/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
