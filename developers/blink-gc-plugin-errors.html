<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/blink-gc-plugin-errors","deleted":false,"title":"Blink GC Plugin Errors","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/blink-gc-plugin-errors\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers","parentWuid":"wuid:gx:982466121d9f2cd","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Blink GC Plugin Errors","locale":"en","wuid":"wuid:gx:4ed2a5bdc25bf4c6","revision":9,"path":"/developers/blink-gc-plugin-errors","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"blink-gc-plugin-errors","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Blink GC Plugin Errors - The Chromium Projects" />
<meta itemprop="name" content="Blink GC Plugin Errors - The Chromium Projects" />
<meta property="og:title" content="Blink GC Plugin Errors - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Blink GC Plugin Errors - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../developers.1.html" dir="ltr">For Developers</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Blink GC Plugin Errors</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><h2><a name="TOC-Introduction"></a>Introduction</h2><div>With the addition of the new Blink garbage collection infrastructure we have created a clang compiler plugin to statically check various conditions are met. This page documents what conditions are checked, which error a failed condition will raise and how the error might be fixed.</div><div><br /></div><div>All diagnostics produced by the checker are prefixed with <font face="courier new, monospace">[blink-gc]</font><font face="arial, sans-serif">.</font></div><h2><a name="TOC-Tracing-Errors"></a><font face="arial, sans-serif">Tracing Errors</font></h2><div><font face="arial, sans-serif">All members of a class must be traced in order to ensure that the GC system does not reclaim their storage space. Thus, if a class contains any fields that need to be traced (ie, the field is either a GC managed object or it also contains fields that need to be traced), then the class must implement a trace method to do so.</font></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">If you get the error:</font></div><div><ul><li><font face="arial, sans-serif">Class 'Foo' requires a trace method<span style="font-size:10pt"> because it contains fields that require tracing.<br /></span></font></li></ul><font face="arial, sans-serif">then your class/struct contains fields that need to be traced and you must define a trace method doing so. The plugin will provide a note describing which fields that need to be traced. A problematic class might look like:</font></div><div><font face="arial, sans-serif"><br /></font></div><div><font color="#990000" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">This is fixed by defining a trace method and tracing the field </font><font face="courier new, monospace">m_baz</font><font face="arial, sans-serif">:</font></div><div><font face="arial, sans-serif"><br /></font></div><div><div><font color="#38761d" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#38761d" face="courier new, monospace">  virtual void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</font></div><div><font color="#38761d" face="courier new, monospace">private:</font></div><div><font color="#38761d" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#38761d" face="courier new, monospace">};</font></div></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">If you get the error:</font></div><div><ul><li><font face="arial, sans-serif">Class 'Foo' overrides non-virtual trace of base class 'Bar'.</font></li></ul><div><font face="arial, sans-serif">then your class/struct has overridden a non-virtual trace method of a base class and the base class should either be virtual or the hierarchy needs to implement manual trace dispatching (see the section on Dispatch Errors below).</font></div></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">If you get the errors:</font></div><div><ul><li><font face="arial, sans-serif">Base class 'Foo' of derived class 'Bar' requires tracing.</font></li><li><font face="arial, sans-serif">Class 'Bar' has untraced fields that require tracing.</font></li></ul></div><div><font face="arial, sans-serif">then your class/struct has a trace method, but it does not trace all of the required parts. The base class tracing ensures that fields declared in base classes are traced. The plugin will provide a note describing which fields that need to be traced. A problematic class might look like:</font></div><div><br /></div><div><div><font color="#990000" face="courier new, monospace">class Bar : public Foo {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  Baz* getTheOtherBaz() { return m_otherBaz; }</span></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  void trace(Visitor* visitor) { }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_otherBaz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">This is fixed by tracing </font><font face="courier new, monospace">Foo</font><font face="arial, sans-serif"> and </font><font face="courier new, monospace">m_otherBaz</font><font face="arial, sans-serif">:</font></div><div><font face="arial, sans-serif"><br /></font></div><div><div><font color="#38761d" face="courier new, monospace">class Bar : public Foo {</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">  Baz* getTheOtherBaz() { return m_otherBaz; }</font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d"><br /></font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">  void trace(Visitor* visitor)</font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">  {</font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">    visitor-&gt;trace(m_otherBaz);</font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">    Foo::trace(visitor);</font></span></div><div><span style="font-family:courier new,monospace;font-size:10pt"><font color="#38761d">  }</font></span></div><div><font color="#38761d" face="courier new, monospace">private:</font></div><div><font color="#38761d" face="courier new, monospace">  Member&lt;Baz&gt; m_otherBaz;</font></div><div><font color="#38761d" face="courier new, monospace">};</font></div></div><div><br /></div><div><h2><a name="TOC-Field-Errors"></a><font face="arial, sans-serif">Field Errors</font></h2></div><div><font face="arial, sans-serif">In order to ensure proper tracing, each field of a class is checked against some correctness requirements described below.</font></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">If you get the errors:</font></div><ul><li><span style="font-size:10pt">Class 'Foo' contains invalid fields.</span></li><li><span style="font-size:10pt">Class 'Foo' contains GC root in field 'm_bar'.</span></li></ul><div>then your class/struct contains problematic fields. If a field points to a GC allocated object then it should be in a Member, so if the field is currently a raw pointer, RefPtr or OwnPtr, it should be changed to a Member or WeakMember and properly traced. A problematic class might look like:</div><div><br /></div><div><div><font color="#990000" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  OwnPtr&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div>Here Baz is a GC allocated type and the issue is fixed by replacing the OwnPtr by Member and tracing the field:</div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div><div><font color="#38761d" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#38761d" face="courier new, monospace">  virtual void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</font></div><div><font color="#38761d" face="courier new, monospace">private:</font></div><div><font color="#38761d" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#38761d" face="courier new, monospace">};</font></div></div><div><font color="#38761d" face="courier new, monospace"><br /></font></div><div>Another type of invalid field is the embedding of or a pointer to a stack-allocated object from within A GC allocated object. This is simply not permitted and the containing class must also be stack allocated or the stack-allocated object must become GC allocated.</div><div><br /></div><div>If a field inside a GC allocated object either defines a GC root (ie, Persistent or PersistentHeapXXX collection) or embeds a GC root via a part object, then we likely have a memory leak. In this case the Persistent should be replaced by a properly traced Member. A problematic case might look like:</div><div><br /></div><div><div><font color="#990000" face="courier new, monospace">class Part {</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace">  DISALLOW_ALLOCATION();</span></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><font color="#990000" face="courier new, monospace">  </font><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Persistent&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div><font color="#990000" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_part.getTheBaz(); }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Part m_part;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div>Here Part is used as a part object of Foo and it contains a Persistent pointer to Baz. To fix the issue the Persistent should be replaced by Member and Part should be traced:</div><div><br /></div><div><div><font color="#38761d" face="courier new, monospace">class Part {</font></div><div><font color="#38761d" face="courier new, monospace">  DISALLOW_ALLOCATION();</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_baz; }</span></div><div><font color="#38761d" face="courier new, monospace">  void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</font></div><div><font color="#38761d" face="courier new, monospace">private:</font></div><div><font color="#38761d" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">};</span></div><div><font color="#38761d" face="courier new, monospace"><br /></font></div><div><font color="#38761d" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">  Baz* getTheBaz() { return m_part.getTheBaz(); }</span></div><div><font color="#38761d" face="courier new, monospace">  virtual void trace(Visitor* visitor) { visitor-&gt;trace(m_part); }</font></div><div><font color="#38761d" face="courier new, monospace">private:</font></div><div><font color="#38761d" face="courier new, monospace">  Part m_part;</font></div><div><font color="#38761d" face="courier new, monospace">};</font></div></div><div><font color="#38761d" face="courier new, monospace"><br /></font></div><div><div><h2><a name="TOC-Finalization-Errors"></a><font face="arial, sans-serif">Finalization Errors</font></h2></div><div><font face="arial, sans-serif">When an object is allocated on the GC managed heap it might need finalization support. Objects that derive a GC base with finalization support will be finalized on the first GC where they have become unreachable. Thus the</font><span style="font-family:arial,sans-serif;background-color:transparent;font-size:10pt"> finalization time (ie, time of destruction) is not known in advance. By default finalization of an object will call the objects destructor. If a class does not have finalization support its destructor will never be called. The existence of destructors that are never called can hide subtle bugs and so we check agains this with the GC plugin. The basic rule is that a class with a "non-trivial destructor" must have finalization support. A class has a trivial destructor if and only if the destructor is the default generated destructor and all of the class bases and members have trivial destructors.</span></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">If you get the error:</font></div></div><div><ul><li><font face="arial, sans-serif"> Class 'Foo' requires finalization.</font></li></ul><div><font face="arial, sans-serif">then your class/struct has a "non-trivial finalizer" and therefore needs to inherit from a finalized GC base class, such as, GarbageCollectedFinalized. The plugin will try to emit notes about which bases, members and destructors are causing the class to have a non-trivial finalizer. </font><span style="font-family:arial,sans-serif;background-color:transparent;font-size:10pt">For example:</span></div></div><div><font face="arial, sans-serif"><br /></font></div><div><div><font color="#990000" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  ~Foo();</span></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">};</span></div></div><div><font face="arial, sans-serif"><br /></font></div><div><font face="arial, sans-serif">will issue a note about a "user-declared destructor". The destructor can then either be removed or finalization support can be added to the class:</font></div><div><font face="arial, sans-serif"><br /></font></div><div><div><font color="#38761d" face="courier new, monospace">class Foo : public GarbageCollectedFinalized&lt;Foo&gt; {</font></div><div><font color="#38761d" face="courier new, monospace">public:</font></div><div><span style="color:rgb(56,118,29);font-family:courier new,monospace;font-size:10pt">  ~Foo();</span></div><div><font color="#38761d" face="courier new, monospace">};</font></div></div><div><font color="#38761d" face="courier new, monospace"><br /></font></div><div><div><font face="arial, sans-serif">If you get the error:</font></div><div><ul><li><font face="arial, sans-serif"> Finalizer '~Foo' accesses potentially finalized field 'm_baz'.</font></li></ul><div><font face="arial, sans-serif">then your finalizer is accessing a field of Foo that might be finalized in the same GC round. In other words, the object pointed to by m_baz might already be reclaimed by the GC. For example:</font></div></div></div><div><font face="arial, sans-serif"><br /></font></div><div><div><font color="#990000" face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">  ~Foo { m_baz-&gt;doSomeCleanup(); }</span></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt">   void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</span></div><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div><font face="arial, sans-serif">needs to be changed to perform the cleanup of baz in some other way dependent on the concrete situation. Maybe the cleanup code can be moved into the finalization of Baz.</font></div><div><font face="arial, sans-serif"><br /></font></div><div><div><h2><a name="TOC-Dispatch-Errors"></a><font face="arial, sans-serif">Dispatch Errors</font></h2></div><div>Some places in the Blink code base avoid introducing a vtable for a class hierarchy, such as the CSSValue class hierarchy. In such cases the programmer needs to define the dispatch methods manually.</div><div><br /></div><div>If you get the errors:</div><div><ul><li>Class 'Foo' is missing manual trace dispatch.</li><li>Class 'Foo' is missing manual finalization dispatch.</li></ul><div>your class needs to define a trace method and/or a finalizeGarbageCollectedObject method to perform the manual dispatch.</div></div><div><br /></div><div>If you get the errors:</div><div><ul><li>Class 'Foo' contains or inherits virtual methods but implements manual dispatching.</li></ul><div>your class has implemented manual dispatch but might be able to simply have a virtual trace and destructor.</div></div><div><br /></div><div>If you get the errors:</div><div><ul><li>Missing dispatch to class 'Bar' in manual trace dispatch.</li><li>Missing dispatch to class 'Bar' in manual finalize dispatch.</li></ul><div>then the derived class 'Bar' is not dispatched to from the manually implemented dispatch.</div></div></div><div><br /></div><div><div><h2><a name="TOC-Derived-Class-Errors"></a><font face="arial, sans-serif">Derived Class Errors</font></h2></div><div>If you get the error:</div></div><div><ul><li>Class 'Foo' must derive its GC base in the left-most position.</li></ul><div>then the class Foo inherits from a GC base, but does so incorrectly. To ensure<span style="background-color:transparent;font-size:10pt"> that the vtable entry and GC meta data of a class is mapped to a reliable location in memory, w</span><span style="background-color:transparent;font-size:10pt">e require that the GC base is always inherited in the left-most position in the super-class declarations. For example:</span></div></div><div><span style="background-color:transparent;font-size:10pt"><br /></span></div><div><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">class Foo : public Bar, public GarbageCollected&lt;Foo&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><font color="#990000" face="courier new, monospace">  </font><span style="color:rgb(153,0,0);font-family:courier new,monospace;background-color:transparent;font-size:10pt">void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</span></div></span><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><br /></div><div>needs to swap the position of Bar and the GC base:</div><div><br /></div><div><font color="#38761d"><span style="background-color:transparent"><div><font face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt;, </font><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">public Bar</span><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt"> {</span></div></span></font><font color="#38761d"><span style="background-color:transparent"><div><font face="courier new, monospace">public:</font></div><div><font face="courier new, monospace">  </font><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</span></div></span><span style="background-color:transparent"><div><font face="courier new, monospace">private:</font></div><div><font face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font face="courier new, monospace">};</font></div></span></font></div><div><br /></div><div>The same is true if the GC base is inherited from some other derived class, say Baz, then the super-class declaration of Baz must be in the left-most position.</div><div><br /></div><div>If you get the error:</div><div><ul><li>Left-most base class 'Bar' of derived class 'Foo' must be polymorphic.</li><li>Left-most base class 'Bar' of derived class 'Foo' must define a virtual trace method.</li></ul><div>then the base class 'Bar' needs to be polymorphic and if 'Foo' has a virtual trace method then it must be declared virtual in 'Bar'. The requirement is to ensure that the GC have a consistent view of a vtable/virtual-trace even if a GC happens while an object is only partially constructed. In both cases, the typical fix will simply be to define a virtual trace in 'Bar', override it in 'Foo' and trace the super class there. For example:</div></div><div><br /></div><div><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">class Bar : public GarbageCollected&lt;Bar&gt; {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><font color="#990000" face="courier new, monospace">  Bar(); // could potentially trigger a GC.</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div><font color="#990000" face="courier new, monospace">class Foo : public Bar {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><font color="#990000" face="courier new, monospace">  virtual </font><span style="color:rgb(153,0,0);font-family:courier new,monospace;font-size:10pt;background-color:transparent">void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</span></div></span><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">private:</font></div><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><br /></div><div>needs to define trace in 'Bar' and trace it in 'Foo':</div><div><br /></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">class Bar : public GarbageCollected&lt;Bar&gt; {</font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">public:</font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">  Bar();</font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">  virtual void trace(Visitor*) { }</font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">};</font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace"><br /></font></span></font></div><div><font color="#38761d"><span style="background-color:transparent"><font face="courier new, monospace">class Foo : </font><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">public Bar</span><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent"> {</span></span></font><font color="#38761d"><span style="background-color:transparent"><div><font face="courier new, monospace">public:</font></div><div><font face="courier new, monospace">  </font><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">void trace(Visitor* visitor)</span></div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">  {</span></div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">    visitor-&gt;trace(m_baz);</span></div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">    Bar::trace(visitor);</span></div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">  }</span></div></span><span style="background-color:transparent"><div><font face="courier new, monospace">private:</font></div><div><font face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font face="courier new, monospace">};</font></div></span></font></div></span></div><div><br /></div><div>If you get the error:</div><div><ul><li>Stack-allocated class 'Foo' derives class 'Bar' which is not stack allocated</li></ul><div>then either class Foo can not be annotated as "stack allocated", or class Bar must be annotated "stack allocated" and used as such. A stack allocated class cannot be new'ed, ie, allocated on the managed heap or using any other kind of allocator. For example:</div></div><div><br /></div><div><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">class Bar {</font></div><div><font color="#990000" face="courier new, monospace">public:</font></div><div><font color="#990000" face="courier new, monospace">  </font><span style="color:rgb(153,0,0);font-family:courier new,monospace;background-color:transparent;font-size:10pt">void someMethod();</span></div></span><span style="background-color:transparent"><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;background-color:transparent;font-size:10pt">};</span></div><div><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace"><br /></font></div><div><font color="#990000" face="courier new, monospace">class Foo : public Bar {</font></div><div><font color="#990000" face="courier new, monospace">  STACK_ALLOCATED();</font></div><div><span style="color:rgb(153,0,0);font-family:courier new,monospace;background-color:transparent;font-size:10pt">private:</span></div></span><span style="background-color:transparent"><div><font color="#990000" face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font color="#990000" face="courier new, monospace">};</font></div><div><font color="#990000" face="courier new, monospace"><br /></font></div><div>needs to either make Bar stack allocated:</div><div><br /></div><div><span style="background-color:transparent"><div><font color="#38761d" face="courier new, monospace">class Bar {</font></div></span><div><font color="#38761d" face="courier new, monospace">  STACK_ALLOCATED();</font></div><font color="#38761d"><span style="background-color:transparent"><div><font face="courier new, monospace">public:</font></div><div><font face="courier new, monospace">  </font><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">void someMethod();</span></div></span><span style="background-color:transparent"><div><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">};</span></div><div><span style="background-color:transparent"><div><font face="courier new, monospace"><br /></font></div><div><font face="courier new, monospace">class Foo : public Bar {</font></div><div><span style="background-color:transparent;font-family:courier new,monospace;font-size:10pt">private:</span></div></span><span style="background-color:transparent"><div><font face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font face="courier new, monospace">};</font></div></span></div></span></font></div><div><br /></div><div><div>Notice that the stack allocated annotation is inherited and that a stack allocated object does not need to define a trace method: its pointers are found conservatively on the stack.</div></div><div><br /></div><div>Alternatively, Foo can be made GC allocated:</div><div><br /></div><div><span style="background-color:transparent"><font color="#38761d" face="courier new, monospace">class Bar {</font></span><div><span style="font-family:courier new,monospace;background-color:transparent;color:rgb(56,118,29);font-size:10pt">public:</span></div><font color="#38761d"><span style="background-color:transparent"><div><font face="courier new, monospace">  </font><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">void someMethod();</span></div></span><span style="background-color:transparent"><div><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">};</span></div><div><span style="background-color:transparent"><div><font face="courier new, monospace"><br /></font></div><div><font face="courier new, monospace">class Foo : public GarbageCollected&lt;Foo&gt;, public Bar {</font></div><div><span style="background-color:transparent"><div><font face="courier new, monospace">public:</font></div><div><font face="courier new, monospace">  </font><span style="font-family:courier new,monospace;background-color:transparent;font-size:10pt">void trace(Visitor* visitor) { visitor-&gt;trace(m_baz); }</span></div></span></div><div><span style="background-color:transparent;font-family:courier new,monospace;font-size:10pt">private:</span></div></span><span style="background-color:transparent"><div><font face="courier new, monospace">  Member&lt;Baz&gt; m_baz;</font></div><div><font face="courier new, monospace">};</font></div></span></div></span></font></div><div><br /></div><div><br /></div></span></div></span></div></span></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/blink-gc-plugin-errors">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9tZ9xJjLuN23YLjEH0sEOAbB-oWJa49NcW6DUrFA2vq7smRMiWoAmWwJ5-QF_plxjSO5Q832p9kWM3yLzuIY455idQnyPvilwEyvAI0hbs61a3Rn_/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
