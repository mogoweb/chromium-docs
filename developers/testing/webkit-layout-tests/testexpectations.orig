<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/testing","deleted":false,"title":"Testing and infrastructure","dir":"ltr"},{"path":"/developers/testing/webkit-layout-tests","deleted":false,"title":"Layout Tests","dir":"ltr"},{"path":"/developers/testing/webkit-layout-tests/testexpectations","deleted":false,"title":"Test Expectations","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/testing/webkit-layout-tests/testexpectations\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/testing/webkit-layout-tests","parentWuid":"wuid:gx:1a8b2a346aa3984","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Test Expectations","locale":"en","wuid":"wuid:gx:40912166aa8b896b","revision":12,"path":"/developers/testing/webkit-layout-tests/testexpectations","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"testexpectations","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Test Expectations - The Chromium Projects" />
<meta itemprop="name" content="Test Expectations - The Chromium Projects" />
<meta property="og:title" content="Test Expectations - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Test Expectations - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/testing" dir="ltr">Testing and infrastructure</A>‎ &gt; ‎<A href="/developers/testing/webkit-layout-tests" dir="ltr">Layout Tests</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Test Expectations</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-How-we-manage-tests-that-fail"><strong>1 </strong>How we manage tests that fail</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-How-to-rebaseline"><strong>1.1 </strong>How to rebaseline</a></li></ol></li><li class="goog-toc"><a href="#TOC-Suppressing-failures-using-the-TestExpectations-file"><strong>2 </strong>Suppressing failures using the TestExpectations file</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Ordering"><strong>2.1 </strong>Ordering</a></li><li class="goog-toc"><a href="#TOC-Syntax"><strong>2.2 </strong>Syntax</a></li><li class="goog-toc"><a href="#TOC-Semantics"><strong>2.3 </strong>Semantics</a></li></ol></li></ol></div></div></div></div></div><h2><a name="TOC-How-we-manage-tests-that-fail"></a>How we manage tests that fail</h2><div>The primary function of the LayoutTests is as a "regression test suite". This means that, while we care about whether a page is being rendered correctly, we care more about whether the page is being rendered the way we expect it to. In other words, we look more for changes in behavior than we do for correctness.</div><div><br /></div><div>All layout tests have "expected results", which may be one of several forms. The test may produce a text file containing javascript log messages, or a text rendering of the Render Tree. It may also produce a screen capture of the rendered page as PNG files as well. For WebAudio tests, we can produce WAV files instead of either text or PNG files. For any of these types of tests, there are files checked into the LayoutTests directory named "-expected.{txt,png,wav}". Lastly, we also support the concept of "reference tests", which check that two pages are rendered identically (pixel-by-pixel). As long as the two tests' output match, the tests pass. For more on reference tests, see <a href="http://trac.webkit.org/wiki/Writing%20Reftests">http://trac.webkit.org/wiki/Writing%20Reftests</a>.</div><div><br /></div><div>When the output doesn't match, there are two potential reasons for it:</div><div><ol><li><span style="font-size:10pt">The port is performing "correctly", but the output simply won't match the generic version. The usual reason for this is for things like form controls, which are rendered differently on each platform.</span></li><li><span style="font-size:10pt">The port is performing "incorrectly" (i.e., the test is failing).</span></li></ol></div><div>In both cases, the convention is to check in a new "-expected" file, even though that file may be codifying errors. This helps us maintain test coverage for all the other things the test is testing while we resolve the bug.</div><div><br /></div><div><font size="4"><b>What do to with a failing test</b></font></div><div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><br /></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><b style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:10pt;background-color:transparent">If a test can be rebaselined, it should always be rebaselined instead of adding lines to TestExpectations.</b><span style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif;font-size:10pt;background-color:transparent"> Bugs at crbug.com</span><span style="font-size:10pt;background-color:transparent"> should track fixing incorrect behavior, not lines in TestExpectations.</span></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><br /></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">If a test is never supposed to pass (e.g. it's testing Windows-specific behavior, so can't ever pass on Linux/Mac), move it to the NeverFixTests file. That gets it out of the way of the rest of the project.</div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><br /></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">There are some cases where you can't rebaseline and, unfortunately, we don't have a better solution than reverting the patch that caused the failure or adding a line to TestExpectations and fixing the bug later. <b>Reverting the patch is strongly preferred.</b></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><b><br /></b></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">These are the cases where you can't rebaseline:</div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">1) It's a reftest</div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">2) It gives different output in release and debug</div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">3) It's flaky, crashes or times out.</div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">4) It's for a feature that isn't shipped on some platforms yet, but will shortly.</div></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif">5) It's a W3C auto-imported test. These tests don't have -expected.txt files, so can't just be rebaselined.</div><div><h3 style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><a name="TOC-How-to-rebaseline"></a><font size="4">How to rebaseline</font></h3><ul><li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><span style="font-size:small;background-color:transparent">If the change has already cycled on all the bots:</span></li><ul><li style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><span style="font-size:small;background-color:transparent">If you have not setup your subversion config, you need to </span>configure your <code>~/.subversion/config</code> (or <code>%APPDATA%\Subversion\config</code> on Windows) file to contain the following properties in <a href="http://src.chromium.org/svn/trunk/tools/build/slave/config">/trunk/tools/build/slave/config</a> (<a href="http://src.chromium.org/viewvc/chrome/trunk/tools/build/slave/config" style="font-size:10pt">ViewVC</a>).</li></ul><ol style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><li><span style="font-size:small;background-color:transparent">Add a [ <b>Rebaseline</b> ] line to TestExpectations</span></li><li><span style="font-size:small;background-color:transparent">run "webkit-patch rebaseline-expectations"</span></li><li><span style="font-size:small;background-color:transparent">Post the patch created in step 2 for review</span></li></ol><li><font size="2">If the change has not cycled on the bots:</font></li><ul><li><font size="2">If the test is already listed in TestExpectations as flaky:</font></li><ul><li><font size="2">Mark the test <b>NeedsManualRebaseline</b> and comment out the flaky line so that you patch can land without turning the tree red.</font></li><li><font size="2">Once the bots have cycled, follow the rebaseline-expectations steps above and uncomment out the flaky line commented out in the previous checkin.</font></li></ul><li><font size="2">If the test is not already listed in TestExpectations, mark it as <b>NeedsRebaseline</b>. </font><span style="font-size:10pt;background-color:transparent">The rebaseline-o-matic bot will automatically detect when the bots have cycled (by looking at the blame on the file) and do the rebaseline for you. As long as the test doesn't timeout or crash, it won't turn the bots red if it has a NeedsRebaseline expectation.</span></li></ul></ul></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><b><font size="4">Different TestExpectations files</font></b></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><br /></div><div style="color:rgb(34,34,34);font-family:arial,sans-serif"><div>ASANExpectations: Tests that fail under ASAN</div><div>LeakExpectations: Tests that have memory leaks under the leak checker</div><div>NeverFixTests: Tests that we <b>never</b> intend to fix (e.g. a test for Windows-specific behavior will never be fixed on Linux/Mac).</div><div><span style="font-size:10pt;background-color:transparent">SlowTests: Tests that take longer than the usual timeout to run. Slow tests are given 5x the usual timeout.</span></div><div>SmokeTests: A small subset of tests that we run on the Android bot.</div><div>StaleTestExpectations: Platform-specific lines that have been in TestExpectations for many months. They're moved here to get them out of the way of people doing rebaselines since they're clearly not getting fixed anytime soon.</div><div>TestExpectations: The main test failure suppression file. This should really only be used for flaky lines and NeedsRebaseline/NeedsManualRebaseline lines. </div><div>W3CImportExpectations: Expectations for auto-imported w3c tests.</div></div><h2><a name="TOC-Suppressing-failures-using-the-TestExpectations-file"></a>Suppressing failures using the TestExpectations file</h2><div>The test expectations are listed in the file LayoutTests/TestExpectations.</div><h3><a name="TOC-Ordering"></a>Ordering</h3><div>The file is not ordered.<b> Hint: </b><span style="color:rgb(34,34,34);font-family:arial,sans-serif;background-color:transparent;font-size:10pt">Put new changes into a random spot in the file to reduce the chance of merge conflicts when landing your patch.</span></div><h3><a name="TOC-Syntax"></a>Syntax</h3><div>The syntax of the file is roughly one expectation per line. An expectation can apply to either a directory of tests, or a specific tests. Lines prefixed with "# " are treated as comments,
and blank lines are allowed as well.</div><div><br /></div><div>The syntax of a line is roughly:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>[ bugs ] [ "[" modifiers "]" ] test_name [ "[" expectations "]" ]</code></div></div><div><ul><li><span style="font-size:10pt">Tokens are separated by whitespace</span></li><li><span style="font-size:10pt"><b>The brackets delimiting the modifiers and expectations from the bugs and the test_name are not optional</b>; however modifiers components is optional. In other words, if you want to specify modifiers or expectations, you must enclose them in brackets.</span></li><li><span style="font-size:10pt">Lines are expected to have one or more bug identifiers, and the linter will complain about lines missing them. Bug identifiers are of the form "webkit.org/b/12345", "crbug.com/12345", "code.google.com/p/v8/issues/detail?id=12345" or "Bug(username)"</span></li><li><span style="font-size:10pt">If no modifiers are specified, the test applies to all of the configurations applicable to that file</span></li><li><span style="font-size:10pt">Modifiers can be one or more of <code>Mac</code>, <code>SnowLeopard</code>, <code>Lion</code>, <code>MountainLion</code>, <code>Win</code>, <code>XP</code>, <code>Win7</code>, <code>Linux</code>, <code>Lucid</code>, <code>x86_64</code>, <code>x86</code>, <code>Release</code>, <code>Debug</code>.</span></li><li><span style="font-size:10pt">Expectations can be one or more of <code>Crash</code>, <code>Failure</code>, <code>ImageOnlyFailure</code>, <code>Pass</code>, <code>Rebaseline</code>, <code>Slow</code>, <code>Skip</code>, <code>Timeout</code>, <code>WontFix</code>, <code>Missing,NeedsRebaseline,NeedsManualRebaseline</code>. If multiple expectations are listed, the test is considered "flaky" and any of those results will be considered as expected.</span></li></ul></div><div>For example:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>webkit.org/b/12345 [ Win Debug ] fast/html/keygen.html [ Crash ]</code></div></div><div><br /></div><div>which indicates that the "fast/html/keygen.html" test file is expected to crash when run in the Debug configuration on Windows, and the tracking bug for this crash is bug #12345 in the webkit bug repository. Note that the test will still be run, so that we can notice if it doesn't actually crash.</div><div><br /></div><div>Assuming you're running a debug build on Mac Lion, the following lines are all equivalent (in terms of whether the test is performed and its expected outcome):</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><span style="color:rgb(0,96,0);line-height:1;font-size:10pt"><code>fast/html/keygen.html [ Skip ]</code><br /><code>fast/html/keygen.html [ WontFix ]</code><br /><code>Bug(darin) [ Lion Debug] fast/html/keygen.html [ Skip ]</code></span></div></div><h3><a name="TOC-Semantics"></a>Semantics</h3><div><ul><li><span style="font-size:10pt"><code>WontFix</code> implies <code>Skip</code> and also indicates that we don't have any plans to make the test pass.</span></li><li><span style="font-size:10pt"><b>WontFix lines go in the NeverFixTests file</b> as we never intend to fix them. These are just for tests that only apply to some subset of the platforms we support.</span></li><li><span style="font-size:10pt"><code>WontFix</code> and <code>Skip</code> must be used by themselves and cannot be specified alongside <code>Crash</code> or another expectation keyword.</span></li><li><span style="font-size:10pt"><code>Slow</code> causes the test runner to give the test 5x the usual time limit to run. <b>Slow lines go in the SlowTests file.</b> A given line cannot have both <code>Slow</code> and <code>Timeout</code>.</span></li></ul></div><div>Also, when parsing the file, we use two rules to figure out if an expectation line applies to the current run:</div><div><ol><li><span style="font-size:10pt">If the configuration parameters don't match the configuration of the current run, the expectation is ignored.</span></li><li><span style="font-size:10pt">Expectations that match more of a test name are used before expectations that match less of a test name.</span></li></ol></div><div>For example, if you had the following lines in your file, and you were running a debug build on Mac SnowLeopard:</div><div><br /></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>webkit.org/b/12345 [ SnowLeopard ] fast/html [ Failure ]</code></div><div><code>webkit.org/b/12345 [ SnowLeopard ] fast/html/keygen.html [ Pass ]</code></div><div><code>webkit.org/b/12345 [ Vista ] fast/forms/submit.html [ ImageOnlyFailure ]</code></div><div><code>webkit.org/b/12345 fast/html/section-element.html [ Failure Crash ]</code></div></div><div><br /></div><div>You'd expect:</div><div><ul><li><span style="font-size:10pt"><code>fast/html/article-element.html</code> to fail with a text diff (since it is in the fast/html directory).</span></li><li><span style="font-size:10pt"><code>fast/html/keygen.html</code> to pass (since the exact match on the test name).</span></li><li><span style="font-size:10pt"><code>fast/html/submit.html</code> to pass (since the configuration parameters don't match).</span></li><li><span style="font-size:10pt"><code>fast/html/section-element.html</code> to either crash or produce a text (or image and text) failure, but not time out or pass.</span></li></ul></div><div>Again, <b>duplicate expectations are not allowed within the file</b> and will generate warnings. </div><div><br /></div><div>You can verify that any changes you've made to an expectations file are correct by running:</div><div><br /></div><div><div class="sites-codeblock sites-codesnippet-block"><code>% lint-test-expectations</code></div></div><div><br /></div><div>which will cycle through all of the possible combinations of configurations looking for problems.</div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/testing/webkit-layout-tests/testexpectations">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9WIxuNHYQVVEWQIy6KanpC4MEHlRpbghXLa0liBdIGWJBTgv9O9YU-2izWCvZzTR4qScAYQ5sx6xwflDTqObYjrlVqTH-EGOKrT2yCLWr47jZGPRc/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
