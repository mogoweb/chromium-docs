<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/testing","deleted":false,"title":"Testing and infrastructure","dir":"ltr"},{"path":"/developers/testing/try-server-usage","deleted":false,"title":"Try Server usage","dir":"ltr"},{"path":"/developers/testing/try-server-usage/design","deleted":false,"title":"Design doc: Try server","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/testing/try-server-usage/design\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/testing/try-server-usage","parentWuid":"wuid:gx:6cc38cc1928aef00","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Design doc: Try server","locale":"en","wuid":"wuid:gx:75f2b5fabe6ced1e","revision":6,"path":"/developers/testing/try-server-usage/design","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"design","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Design doc: Try server - The Chromium Projects" />
<meta itemprop="name" content="Design doc: Try server - The Chromium Projects" />
<meta property="og:title" content="Design doc: Try server - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Design doc: Try server - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/testing" dir="ltr">Testing and infrastructure</A>‎ &gt; ‎<A href="/developers/testing/try-server-usage" dir="ltr">Try Server usage</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Design doc: Try server</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-right-wrapping-on"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Objective"><strong>1 </strong>Objective</a></li><li class="goog-toc"><a href="#TOC-Background"><strong>2 </strong>Background</a></li><li class="goog-toc"><a href="#TOC-Overview"><strong>3 </strong>Overview</a></li><li class="goog-toc"><a href="#TOC-Infrastructure"><strong>4 </strong>Infrastructure</a></li><li class="goog-toc"><a href="#TOC-Detailed-design"><strong>5 </strong>Detailed design</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Server"><strong>5.1 </strong>Server</a></li><li class="goog-toc"><a href="#TOC-User"><strong>5.2 </strong>User</a></li><li class="goog-toc"><a href="#TOC-Slave"><strong>5.3 </strong>Slave</a></li></ol></li><li class="goog-toc"><a href="#TOC-Caveats"><strong>6 </strong>Caveats</a></li><li class="goog-toc"><a href="#TOC-Latency"><strong>7 </strong>Latency</a></li><li class="goog-toc"><a href="#TOC-Scalability"><strong>8 </strong>Scalability</a></li><li class="goog-toc"><a href="#TOC-Redundancy-and-Reliability"><strong>9 </strong>Redundancy and Reliability</a></li><li class="goog-toc"><a href="#TOC-Security-Considerations"><strong>10 </strong>Security Considerations</a></li><li class="goog-toc"><a href="#TOC-Testing-plan"><strong>11 </strong>Testing plan</a></li><li class="goog-toc"><a href="#TOC-Historical-notes"><strong>12 </strong>Historical notes</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Improvements"><strong>12.1 </strong>Improvements</a></li></ol></li></ol></div></div></div></div></div><h2><a name="TOC-Objective"></a>Objective</h2><div>Introduce a way to run pre-commit tests on a variety of platforms for the open source Chromium project.</div><h2><a name="TOC-Background"></a>Background</h2><div>Before the chromium try server was written, the developers had to run each test locally and or commit and hope for the best. This became untenable as more and more supported OSes were being added. So the try server was born. It became possible to continue working while one or many slaves were running the tests.</div><h2><a name="TOC-Overview"></a>Overview</h2><div>The try server runs a similar configuration to the continuous integration server, except that it is triggered not on commits but on "try job request". The try server is based on the buildbot project and reuse the same code than the continuous integration servers. It has one "builder" per configuration support, for example "win" for Windows (debug is assumed) and "linux_rel" for ubuntu/release. Once a try job is requested, the try server selects one of the slave connected for this configuration and runs all the build steps to checkout, build and run the selected tests. The whole project is written in python.</div><h2><a name="TOC-Infrastructure"></a>Infrastructure</h2><div>The try server is composed of:</div><div><ul><li>One main process, the try server, running on a server. It is running the <a href="http://buildbot.net/">buildbot.net</a> code.</li><li>Several slaves (in the order of hundreds) connected to the server, in general VMs, that can run one of the supported configuration.</li><li>A try job request queue. It is currently a svn repository but effort to use a better mechanism is on-going.</li></ul><h2><a name="TOC-Detailed-design"></a>Detailed design</h2></div><h3><a name="TOC-Server"></a>Server</h3><div>The server is really just a standard buildbot configuration with a custom source trigger. The custom source trigger polls the subversion repository and reads the meta data and its diff file. Note that this access method is going to be deprecated as we are writing the ability to trigger the try job directly from Rietveld. The meta data contains information like:</div><div><ul><li>The list of configuration to run this patch on. Optionally: for each of the configuration, the list of tests to be run.</li><li>The author, its email address.</li><li>Optional: associated code review patchset.</li><li>The revision of the chromium checkout to run the patch against</li></ul></div><div>The server then selects a build slave, runs the whole build and tests on it. Once this is completed, it sends an email back with a status report to the author's email address.</div><h3><a name="TOC-User"></a>User</h3><div>Most of the user facing commands can be seen on the <a href="https://www.chromium.org/developers/testing/try-server-usage">usage page</a>. The way it works is:</div><div><ol><li>git-cl/gcl detects the list of modified files and generate a diff. It retrieves meta data associated with the diff like the rietveld issue number and the CL author.</li><li>git-cl/gcl passes all this information to trychange.py</li><li>trychange.py package this information and saves it into a subversion repository, which the try server polls, eventually triggering a build.</li></ol><h3><a name="TOC-Slave"></a>Slave</h3></div><div>The try server slaves are exactly normal buildbot slave.</div><div>Project information</div><div><ul><li>The try server is mainly the effort of maruel@. rogerta@ is looking at using rietveld as the try job request queue.</li><li>Code: the try server is an integral part of the chromium's buildbot code: <a href="http://src.chromium.org/viewvc/chrome/trunk/tools/build">http://src.chromium.org/viewvc/chrome/trunk/tools/build</a>.</li></ul><h2><a name="TOC-Caveats"></a>Caveats</h2></div><div>Using a diff file makes it tricky as merge information is lost, binary file handling is non-trivial and the exact handling varies across platforms, especially for Windows. The problem with subversion should be clear, it doesn’t have any command to apply a diff it generates itself (!)</div><div><br /></div><div>Having it completely disconnected from the code review makes it possible to send a different diff than the one sent on the code review. This is worked on.</div><div><br /></div><div>The try server is a significant contention point and the current mechanism forces the patch file data to be transferred multiple times. The rietveld-try server integration will significantly improve on that.</div><div><br /></div><div>The way the chromium try jobs are triggered is a good <i>counter</i> example of how to implement it efficiently. The way it currently works, with a subversion repository to store patches files, is because of historical reason, inertia and the fact that subversion is used on the slaves at the moment. </div><h2><a name="TOC-Latency"></a>Latency</h2><div>The latency is sum of:</div><div><ul><li>Time for git/svn to generate the diff</li><li>Time to svn commit the diff to the subversion repository. It is actually significant and can occasionally be in the order of tens of seconds.</li><li>Polling interval, in the order of 10 seconds</li><li>Wait for a build slave to be available. Instantaneous unless under 100% usage for a configuration.</li><li>Wait for the the build to complete. By far the most</li><li>Email propagation delay.</li></ul></div><h2><a name="TOC-Scalability"></a>Scalability</h2><div>The try server process itself doesn't do much beside serving summary web pages, transferring in and out build steps stdout and the diffs. The number of try slaves is still somewhat bounded to the hundreds of slaves range, due to the fact that the try server process control loop is in a single python thread.</div><h2><a name="TOC-Redundancy-and-Reliability"></a>Redundancy and Reliability</h2><div>The reliability is limited by multiple single points of failures:</div><div><ul><li>A single subversion repository to store the patches.</li><li>A single process running the try server.</li><li>The network connection must stay alive between the try server and the slave for the whole duration of the build.</li><li>The source control servers must be able support the load of hundreds of slaves checking out simultaneously.</li></ul><h2><a name="TOC-Security-Considerations"></a>Security Considerations</h2></div><div>Only committers can request a try job. As such, they can already commit anything.</div><h2><a name="TOC-Testing-plan"></a>Testing plan</h2><div>Since this is primarily a developer support infrastructure, the level of unit testing is relatively low. Still, presubmit checks verify the basic functionality of the server, e.g. it starts without crashing.</div><div><h2><a name="TOC-Historical-notes"></a>Historical notes</h2><div><div>Previously, the patches were sent directly to the master via a simple HTTP post. It was quick to implement and worked fine. The try job started right away, without any form of polling. It was also greatly insecure. Using svn for everyone has simply been a quick workaround to add authentication to the patches, since only users with proper subversion credentials can commit to the try job subversion repository. It was also to allow external contributors to be able to trigger try jobs. The reason svn was used to store the diff is because the external contributors could use the same credentials that they were using for their commits, vastly simplifying management. Note that neither Google AppEngine nor Google CloudStorage existed at that time or were publicly available. Albeit, storing thousands of patch files in a single directory shown some limitation in svnserve, causing it to slow down to a crawl during a commit, e.g. a try job request.</div><h3><a name="TOC-Improvements"></a>Improvements</h3><div>The first major improvement is to have the slave fetch the patch directly from rietveld. This way, the try server doesn't have to copy around the diff from the master to the server, significantly reducing overall I/O. Also in the git case, this causes the git process on the slave to be able to merge correctly the diff on the check out, removing much of the fuzziness that occurs with a diff based dataflow.</div><div><br /></div><div>Using this method implies that there is a 1:1 mapping between a try job and a patchset on a code review server, independent of gerrit or rietveld. While many people claim this would be somewhat annoying, it's not as bad as it may seems, especially if support for "out-of-review" try job request, e.g. the current method, is kept. If so, arbitrary try jobs like ones that involve multi-repo changes can still be tried manually. Let me clarify here. I think is totally sane for me to have two different ways to trigger a try job. One integrated in the normal code review flow, another for totally experimental or CL encompassing a change that covers multiple repos. Still, if I were to do it, I would not host these “out-of-band” try jobs on the SCM. I’d use AppEngine or Cloud Storage. Using AppEngine has the advantages that it can be event based instead of Cloud Storage, which would require polling as it is currently done.</div><div><br /></div><div>Implementing this technique permits to assert the authenticity of the patch that was tried, enabling the <a href="https://www.chromium.org/developers/testing/commit-queue/design">commit queue</a> to reuse the test result information if it is not too old.</div></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/testing/try-server-usage/design">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9_iXIieEDMXlecc3eIADXTmj8ooSd46MJ6sSyhobw4oaGrM8fn0sG_EjN61LVTpcga06qstI37HEnHQdR2Z0V_1BGN5NPfY0S4h_CJKk-XuE7WKs7/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
