<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/coding-style","deleted":false,"title":"Coding Style","dir":"ltr"},{"path":"/developers/coding-style/important-abstractions-and-data-structures","deleted":false,"title":"Important Abstractions and Data Structures","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/coding-style/important-abstractions-and-data-structures\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/coding-style","parentWuid":"wuid:gx:17ee0e09e9aefe06","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Important Abstractions and Data Structures","locale":"en","wuid":"wuid:gx:2a43de3082c37c45","revision":32,"path":"/developers/coding-style/important-abstractions-and-data-structures","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"important-abstractions-and-data-structures","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Important Abstractions and Data Structures - The Chromium Projects" />
<meta itemprop="name" content="Important Abstractions and Data Structures - The Chromium Projects" />
<meta property="og:title" content="Important Abstractions and Data Structures - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Important Abstractions and Data Structures - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/coding-style" dir="ltr">Coding Style</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Important Abstractions and Data Structures</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:250px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-TaskRunner-SequencedTaskRunner-SingleThreadTaskRunner"><strong>1 </strong>TaskRunner &amp; SequencedTaskRunner &amp; SingleThreadTaskRunner</a></li><li class="goog-toc"><a href="#TOC-MessageLoop-MessageLoopProxy-BrowserThread-RunLoop"><strong>2 </strong>MessageLoop &amp; MessageLoopProxy &amp; BrowserThread &amp; RunLoop</a></li><li class="goog-toc"><a href="#TOC-base::SequencedWorkerPool-base::WorkerPool"><strong>3 </strong>base::SequencedWorkerPool &amp; base::WorkerPool</a></li><li class="goog-toc"><a href="#TOC-base::Callback-and-base::Bind-"><strong>4 </strong>base::Callback and base::Bind()</a></li><li class="goog-toc"><a href="#TOC-scoped_ptr-T-ScopedVector"><strong>5 </strong>scoped_ptr&lt;T&gt; &amp; ScopedVector</a></li><li class="goog-toc"><a href="#TOC-scoped_refptr-T-base::RefCounted-base::RefCountedThreadSafe"><strong>6 </strong>scoped_refptr&lt;T&gt; &amp; base::RefCounted &amp; base::RefCountedThreadSafe</a></li><li class="goog-toc"><a href="#TOC-Singleton-base::LazyInstance"><strong>7 </strong>Singleton &amp; base::LazyInstance</a></li><li class="goog-toc"><a href="#TOC-base::Thread-base::PlatformThread"><strong>8 </strong>base::Thread &amp; base::PlatformThread</a></li><li class="goog-toc"><a href="#TOC-base::WeakPtr-base::WeakPtrFactory"><strong>9 </strong>base::WeakPtr &amp; base::WeakPtrFactory</a></li><li class="goog-toc"><a href="#TOC-FilePath"><strong>10 </strong>FilePath</a></li><li class="goog-toc"><a href="#TOC-ObserverList-ObserverListThreadSafe"><strong>11 </strong>ObserverList &amp; ObserverListThreadSafe</a></li><li class="goog-toc"><a href="#TOC-Pickle"><strong>12 </strong>Pickle</a></li><li class="goog-toc"><a href="#TOC-Value"><strong>13 </strong>Value</a></li><li class="goog-toc"><a href="#TOC-LOG"><strong>14 </strong>LOG</a></li><li class="goog-toc"><a href="#TOC-FileUtilProxy"><strong>15 </strong>FileUtilProxy</a></li><li class="goog-toc"><a href="#TOC-Time-TimeDelta-TimeTicks-Timer"><strong>16 </strong>Time, TimeDelta, TimeTicks, Timer</a></li><li class="goog-toc"><a href="#TOC-PrefService-ExtensionPrefs"><strong>17 </strong>PrefService, ExtensionPrefs</a></li></ol></div></div></div></div></div><br /><h2><a name="TOC-TaskRunner-SequencedTaskRunner-SingleThreadTaskRunner"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/task_runner.h&amp;q=TaskRunner&amp;sq=package:chromium&amp;type=cs">TaskRunner</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/sequenced_task_runner.h&amp;q=SequencedTaskRunner&amp;sq=package:chromium&amp;type=cs">SequencedTaskRunner</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/single_thread_task_runner.h&amp;q=SingleThreadTaskRunner&amp;sq=package:chromium&amp;type=cs">SingleThreadTaskRunner</a></h2><div>Interfaces for posting base::Callbacks "tasks" to be run by the TaskRunner. TaskRunner makes no guarantees about execution (order, concurrency, or if it's even run at all). SequencedTaskRunner offers certain guarantees about the sequence of execution (roughly speaking FIFO, but see the header for nitty gritty details if interested) and SingleThreadTaskRunner offers the same guarantees as SequencedTaskRunner except all tasks run on the same thread. MessageLoopProxy is the canonical example of a SingleThreadTaskRunner. These interfaces are also useful for testing via dependency injection. <b>NOTE:</b> successfully posting to a TaskRunner does not necessarily mean the task will run.<br /><br /></div><div><b>NOTE:</b> A <b>very</b> useful member function of TaskRunner is PostTaskAndReply(), which will post a task to a target TaskRunner and on completion post a "reply" task to the origin TaskRunner.<br /><h2><a name="TOC-MessageLoop-MessageLoopProxy-BrowserThread-RunLoop"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/message_loop/message_loop.h&amp;q=MessageLoop&amp;sq=package:chromium&amp;type=cs&amp;l=46">MessageLoop</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/message_loop/message_loop_proxy.h&amp;q=MessageLoopProxy&amp;sq=package:chromium&amp;type=cs&amp;l=17">MessageLoopProxy</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/content/public/browser/browser_thread.h&amp;q=BrowserThread&amp;sq=package:chromium&amp;type=cs">BrowserThread</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/run_loop.h&amp;q=run_loop.h&amp;sq=package:chromium&amp;type=cs&amp;l=31">RunLoop</a></h2>These are various APIs for posting a task. MessageLoop is a concrete object used by MessageLoopProxy (the most widely used task runner in Chromium code). You should almost always use MessageLoopProxy instead of MessageLoop, or if you're in chrome/ or content/, you can use BrowserThread. This is to avoid races on MessageLoop destruction, since MessageLoopProxy and BrowserThread will delete the task if the underlying MessageLoop is already destroyed.<b> NOTE:</b> successfully posting to a MessageLoop(Proxy) does not necessarily mean the task will run. </div><div><br /></div><div>PS: There's some debate about when to use SequencedTaskRunner vs MessageLoopProxy vs BrowserThread. Using an interface class like SequencedTaskRunner makes the code more abstract/reusable/testable. On the other hand, due to the extra layer of indirection, it makes the code less obvious. Using a concrete BrowserThread ID makes it immediately obvious which thread it's running on, although arguably you could name the SequencedTaskRunner variable appropriately to make it more clear. The current decision is to only convert code from BrowserThread to a TaskRunner subtype when necessary. MessageLoopProxy should probably always be passed around as a SingleThreadTaskRunner or a parent interface like SequencedTaskRunner.<br /><div></div><h2><a name="TOC-base::SequencedWorkerPool-base::WorkerPool"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/threading/sequenced_worker_pool.h&amp;q=base::SequencedWorkerPool&amp;sq=package:chromium&amp;l=72&amp;type=cs">base::SequencedWorkerPool</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/threading/worker_pool.h&amp;q=base::WorkerPool&amp;sq=package:chromium&amp;l=30&amp;type=cs">base::WorkerPool</a></h2><p>These are the two primary worker pools in Chromium. SequencedWorkerPool is a more complicated worker pool that inherits from TaskRunner and provides ways to order tasks in a sequence (by sharing a SequenceToken) and also specifies shutdown behavior (block shutdown on task execution, do not run the task if the browser is shutting down and it hasn't started yet but if it has then block on it, or allow the task to run irrespective of browser shutdown and don't block shutdown on it). SequencedWorkerPool also provides a facility to return a SequencedTaskRunner based on a SequenceToken. The Chromium browser process will shutdown base::SequencedWorkerPool after all main browser threads (other than the main thread) have stopped. base::WorkerPool is a global object that is not shutdown on browser process shutdown, so all the tasks running on it will not be joined. It's generally unadvisable to use base::WorkerPool since tasks may have dependencies on other objects that may be in the process of being destroyed during browser shutdown.</p><h2><a name="TOC-base::Callback-and-base::Bind-"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/callback.h" style="font-family:arial,sans-serif">base::Callback</a><span style="color:rgb(34,34,34);font-family:arial,sans-serif"> and </span><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/bind.h&amp;q=Base::bind&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">base::Bind()</a></h2>base::Callback is a set of internally refcounted templated callback classes with different arities and return values (including void). Note that these callbacks are copyable, but share (via refcounting) internal storage for the function pointer and the bound arguments. base::Bind() will bind arguments to a function pointer (under the hood, it copies the function pointer and all arguments into an internal refcounted storage object) and returns a base::Callback.<br /><br /></div><div>base::Bind() will automagically AddRef()/Release() the first argument if the function is a member function and will complain if the type is not refcounted (avoid this problem with base::WeakPtr or base::Unretained()). Also, for the function arguments, it will use a COMPILE_ASSERT to try to verify they are not raw pointers to a refcounted type (only possible with full type information, not forward declarations). Instead, use scoped_refptrs or call make_scoped_refptr() to prevent <a href="http://code.google.com/p/chromium/issues/detail?id=28083">bugs</a>. In addition, base::Bind() understands base::WeakPtr. If the function is a member function and the first argument is a base::WeakPtr to the object, base::Bind() will inject a wrapper function that only invokes the function pointer if the base::WeakPtr is non-NULL. base::Bind() also has the following helper wrappers for arguments.<br /><ul><li>base::Unretained() - disables the refcounting of member function receiver objects (which may not be of refcounted types) and the COMPILE_ASSERT on function arguments. Use with care, since it implies you need to make sure the lifetime of the object lasts beyond when the callback can be invoked. For the member function receiver object, it's probably better to use a base::WeakPtr instead.</li><li>base::Owned() - transfer ownership of a raw pointer to the returned base::Callback storage. Very useful because TaskRunners are not guaranteed to run callbacks (which may want to delete the object) on shutdown, so by making the callback take ownership, this prevents annoying shutdown leaks when the callback is not run.</li><li>base::Passed() - useful for passing a scoped object (scoped_ptr/ScopedVector/etc) to a callback. The primary difference between base::Owned() and base::Passed() is base::Passed() requires the function signature take the scoped type as a parameter, and thus allows for <b>transferring</b> ownership via .release(). <b>NOTE:</b> since the scope of the scoped type is the function scope, that means the base::Callback <b>must only be called once</b>. Otherwise, it would be a potential use after free and a definite double delete. Given the complexity of base::Passed()'s semantics in comparison to base::Owned(), you should <b>prefer base::Owned() to base::Passed()</b> in general.</li><li>base::ConstRef() - passes an argument as a const reference instead of copying it into the internal callback storage. Useful for obvious performance reasons, but generally should not be used, since it requires that the lifetime of the referent must live beyond when the callback can be invoked.</li><li>base::IgnoreResult() - use this with the function pointer passed to base::Bind() to ignore the result. Useful to make the callback usable with a TaskRunner which only takes Closures (callbacks with no parameters nor return values).</li></ul><h2><a name="TOC-scoped_ptr-T-ScopedVector"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/scoped_ptr.h&amp;q=scoped_ptr&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">scoped_ptr&lt;T&gt;</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/scoped_vector.h&amp;sq=package:chromium&amp;type=cs">ScopedVector</a></h2>Scoped types that delete the pointer / array / vector elements when the type goes out of scope.<br /></div><div><h2><a name="TOC-scoped_refptr-T-base::RefCounted-base::RefCountedThreadSafe"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/ref_counted.h">scoped_refptr&lt;T&gt; &amp; base::RefCounted &amp; base::RefCountedThreadSafe</a></h2>Reference counting is occasionally useful but is more often a sign that someone isn't thinking carefully about ownership. Use it when ownership is truly shared (for example, multiple tabs sharing the same renderer process), <b>not</b> for when lifetime management is difficult to reason about.<br /><h2><a name="TOC-Singleton-base::LazyInstance"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/singleton.h&amp;q=singleton&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">Singleton</a><span style="color:rgb(34,34,34);font-family:arial,sans-serif"> &amp; </span><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/lazy_instance.h&amp;q=base::LazyInstance&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">base::LazyInstance</a></h2><span style="color:rgb(34,34,34);font-family:arial,sans-serif">They're globals, so you generally should <a href="http://www.object-oriented-security.org/lets-argue/singletons">avoid using them</a>, as per the <a href="http://google-styleguide.googlecode.com/svn/trunk/cppguide.xml?showone=Static_and_Global_Variables#Static_and_Global_Variables">style guide</a>. That said, when you use globals in Chromium code, it's often good to use one of these, and in general, prefer base::LazyInstance over Singleton. The reason to use these classes is construction is lazy (thereby preventing startup slowdown due to static initializers) and destruction order is well-defined. They are all destroyed in opposite order as construction when the AtExitManager is destroyed. In the Chromium browser process, the AtExitManager is instantiated early on in the main thread (the UI thread), so all of these objects will be destroyed on the main thread, even if constructed on a different thread. The reason to prefer base::LazyInstance over base::Singleton is base::LazyInstance reduces heap fragmentation by reserving space in the data segment and using placement new to construct the object in that memory location. <b>NOTE:</b> Both Singleton and base::LazyInstance provide "leaky" traits to leak the global on shutdown. This is often advisable (except potentially in library code where the code may be dynamically loaded into another process's address space or when data needs to be flushed on process shutdown) in order to not to slow down shutdown. There are valgrind suppressions for these "leaky" traits.</span><br /><h2><a name="TOC-base::Thread-base::PlatformThread"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/threading/thread.h&amp;q=base::Thread&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">base::Thread</a><span style="color:rgb(34,34,34);font-family:arial,sans-serif"> &amp; </span><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/threading/platform_thread.h&amp;q=base::PlatformThread&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">base::PlatformThread</a></h2>Generally you shouldn't use these, since you should usually post tasks to an existing TaskRunner. PlatformThread is a platform-specific thread. base::Thread contains a MessageLoop running on a PlatformThread.<br /><h2><a name="TOC-base::WeakPtr-base::WeakPtrFactory"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/weak_ptr.h&amp;q=base::WeakPtr&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">base::WeakPtr</a> &amp; <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/memory/weak_ptr.h&amp;q=base::WeakPtrFactory&amp;sq=package:chromium&amp;type=cs&amp;l=246" style="font-family:arial,sans-serif">base::WeakPtrFactory</a></h2>Mostly thread-unsafe weak pointer that returns NULL if the referent has been destroyed. It's safe to pass across threads (and to destroy on other threads), but it should only be used on the original thread it was created on. base::WeakPtrFactory is u<span style="color:rgb(34,34,34);font-family:arial,sans-serif">seful for automatically canceling base::Callbacks when the referent of the base::WeakPtr gets destroyed.</span><br /><h2><a name="TOC-FilePath"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/files/file_path.h&amp;q=FilePath&amp;sq=package:chromium&amp;type=cs&amp;l=132" style="font-family:arial,sans-serif">FilePath</a></h2><div>A cross-platform representation of a file path. You should generally use this instead of platform-specific representations.</div><h2><a name="TOC-ObserverList-ObserverListThreadSafe"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/observer_list.h&amp;q=ObserverList&amp;sq=package:chromium&amp;l=54" style="font-family:arial,sans-serif">ObserverList</a><span style="color:rgb(34,34,34);font-family:arial,sans-serif"> &amp; </span><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/observer_list_threadsafe.h&amp;q=ObserverListThreadSafe&amp;sq=package:chromium&amp;type=cs&amp;l=94" style="font-family:arial,sans-serif">ObserverListThreadSafe</a></h2><div>ObserverList is a thread-unsafe object that is intended to be used as a member variable of a class. It provides a simple interface for iterating on a bunch of Observer objects and invoking a notification method.</div><div><br /></div><div>ObserverListThreadSafe similar. It contains multiple ObserverLists, and observer notifications are invoked on the same PlatformThreadId that the observer was registered on, thereby allowing proxying notifications across threads and allowing the individual observers to receive notifications in a single threaded manner.</div><h2><a name="TOC-Pickle"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/pickle.h&amp;q=Pickle&amp;sq=package:chromium&amp;type=cs" style="font-family:arial,sans-serif">Pickle</a></h2><div>Pickle provides a basic facility for object serialization and deserialization in binary form.</div><h2><a name="TOC-Value"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/values.h&amp;sq=package:chromium&amp;rcl=1367374264&amp;l=55" style="font-family:arial,sans-serif">Value</a></h2><div>Values allow for specifying recursive data classes (lists and dictionaries) containing simple values (bool/int/string/etc). These values can also be serialized to JSON and back.</div><h2><a name="TOC-LOG"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/logging.h&amp;sq=package:chromium" style="font-family:arial,sans-serif">LOG</a></h2><div>This is the basic interface for logging in Chromium.</div><h2><a name="TOC-FileUtilProxy"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/files/file_util_proxy.h&amp;q=FileUtilProxy&amp;sq=package:chromium&amp;l=25&amp;type=cs" style="font-family:arial,sans-serif">FileUtilProxy</a></h2><span style="color:rgb(34,34,34);font-family:arial,sans-serif">Generally you should not do file I/O on jank-sensitive threads (BrowserThread::UI and BrowserThread::IO), so you can proxy them to another thread (such as BrowserThread::FILE) via these utilities.</span><br /><h2><a name="TOC-Time-TimeDelta-TimeTicks-Timer"></a><font color="#222222" face="arial, sans-serif"><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/time/time.h&amp;sq=package:chromium">Time</a></font>, <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/time/time.h&amp;sq=package:chromium">TimeDelta</a>, <a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/time/time.h&amp;sq=package:chromium">TimeTicks</a>, <span style="color:rgb(34,34,34);font-family:arial,sans-serif"><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/timer/timer.h&amp;sq=package:chromium">Timer</a></span></h2>Generally use TimeTicks instead of Time to keep a stable tick counter (Time may change if the user changes the computer clock).<br /><h2><a name="TOC-PrefService-ExtensionPrefs"></a><a href="https://code.google.com/p/chromium/codesearch#chromium/src/base/prefs/pref_service.h&amp;q=PrefService&amp;sq=package:chromium&amp;l=51&amp;type=cs">PrefService</a>, <a href="https://code.google.com/p/chromium/codesearch#chromium/src/extensions/browser/extension_prefs.h">ExtensionPrefs</a></h2>Containers for persistent state associated with a user <a href="http://code.google.com/searchframe#OAMlx_jo-ck/src/chrome/browser/profiles/profile.h">Profile</a>.</div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/coding-style/important-abstractions-and-data-structures">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9RirNFY9PPj7G5dcqtpTiFTLTGM9zUlWwHHLFOpa059L64FV-Y5_widiRSY6mmJSy8Q6al5pHk1kC1lp8nAA5rBurpdDOhpkSBcI34fkGNvg-rXzL/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
