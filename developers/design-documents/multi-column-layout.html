<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/design-documents","deleted":false,"title":"Design Documents","dir":"ltr"},{"path":"/developers/design-documents/multi-column-layout","deleted":false,"title":"Multi-column layout","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/design-documents/multi-column-layout\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/design-documents","parentWuid":"wuid:gx:359ef223e0fb14ac","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Multi-column layout","locale":"en","wuid":"wuid:gx:35cf6df8b1c772ef","revision":34,"path":"/developers/design-documents/multi-column-layout","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"multi-column-layout","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Multi-column layout - The Chromium Projects" />
<meta itemprop="name" content="Multi-column layout - The Chromium Projects" />
<meta property="og:title" content="Multi-column layout - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Multi-column layout - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<script src="https://www.gstatic.com/caja/v6003-es53-1-gb2a25f6/caja.js"> </script>
<script src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_caja.js"> </script>
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../../developers.1.html" dir="ltr">For Developers</A>‎ &gt; ‎<A href="../design-documents.1.html" dir="ltr">Design Documents</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Multi-column layout</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div>Spec: <a href="http://www.w3.org/TR/css3-multicol/">http://www.w3.org/TR/css3-multicol/</a></div><div>Editor's draft: <a href="http://dev.w3.org/csswg/css-multicol/">http://dev.w3.org/csswg/css-multicol/</a></div><div><br /></div><h2><a name="TOC-The-flow-thread-LayoutMultiColumnFlowThread-"></a>The flow thread (LayoutMultiColumnFlowThread)</h2><div><span style="font-size:10pt;background-color:transparent">Breaking content into multiple columns means that line boxes may no longer only be stacked below each other, and also that child blocks may no longer be rectangular, visually, if they cross a column boundary. We try to worry as little about that internally, though. A multi-column container will insert a special child renderer - the flow thread - which lays out everything as a long single strip (with the width of one column - all columns have the same width). It's only during painting and hit testing (and similar operations) that we need to break this single strip into columns.</span></div><div><span style="font-size:10pt;background-color:transparent"><br /></span></div><div><span style="font-size:10pt;background-color:transparent">All DOM children of the multicol container are moved into the flow thread, instead of being direct children of the multicol container. </span><span style="font-size:10pt;background-color:transparent">The flow thread does not take up any space in its container. We create LayoutMultiColumnSet siblings (of the flow thread) that makes sure that we take up the correct amount of space. The flow thread c</span><span style="font-size:10pt;background-color:transparent">annot be painted / hit-tested / etc. directly. LayoutMultiColumnSet is needed to calculate correct translation and clipping for each column. It's needed to convert between flow thread coordinates and visual coordinates. A </span><span style="background-color:transparent">LayoutMultiColumnSet represents one row of columns. It has no children.</span></div><h2><a name="TOC-Definitions"></a><span style="background-color:transparent">Definitions</span></h2><div><span style="font-size:10pt;background-color:transparent">So in multicol (and all other fragmentation contexts) we need to distinguish between flow thread coordinates and visual coordinates.</span></div><div><span style="background-color:transparent"><br /></span></div><div><span style="background-color:transparent">Flow thread coordinates: Used internally in the layout engine. Every renderer's dimensions (and overflow rectangles, and pretty much everything else) are in flow thread coordinates. The flow thread (which holds all multicol content) is laid out as one tall single-column strip, not worrying much [*] about where each column begins and ends.</span></div><div><span style="background-color:transparent"><br /></span></div><div><span style="background-color:transparent">Visual coordinates: The actual dimensions for painting, hit-testing, etc (basically, what you see on the screen). Calculated from flow thread coordinates, by determining which column a given point is in, and then adding that column's offset to the inline-direction coordinate, and subtracting that column's flow thread portion rectangle's logical top from the block-direction coordinate.</span></div><div><span style="background-color:transparent"><br /></span></div><div><span style="background-color:transparent">Flow thread portion rectangle (in flow thread coordinates): Each column has a flow thread portion rectangle. It defines which part of the flow thread a given column occupies. It is stored (or calculated) as a rectangle, although we really only care about the logical top and logical bottom coordinates. Logical widths and inline-direction coordinates are the same for every column anyway.</span></div><div><span style="background-color:transparent"><br /></span></div><div><span style="background-color:transparent">[*] However, the flow thread needs to add pagination struts at column boundaries (described later), to achieve a uniform column height.</span></div><h2><a name="TOC-Example"></a>Example</h2><div><span style="color:rgb(0,96,0);font-size:10pt;background-color:transparent">&lt;div style="-webkit-columns:3; -webkit-column-rule:solid; </span><span style="color:rgb(0,96,0);font-size:10pt;background-color:transparent">-webkit-column-gap:20px; line-height:20px; width:220px;"&gt;</span></div><div><code>    line1&lt;br&gt;</code></div><div><code>    line2&lt;br&gt;</code></div><div><code>    line3&lt;br&gt;</code></div><div><code>    line4&lt;br&gt;</code></div><div><code>    line5&lt;br&gt;</code></div><div><code>    &lt;div id="elm"&gt;</code></div><div><code>        LINE6&lt;br&gt;</code></div><div><code>        LINE7&lt;br&gt;</code></div><div><code>    &lt;/div&gt;</code></div><div><code>    line8&lt;br&gt;</code></div><div><code>    line9&lt;br&gt;</code></div><div><code>&lt;/div&gt;</code></div><div><br /></div><div>The render tree would look like this:</div><div><br /></div><div><code>LayoutBlockFlow (the multicol container DIV)</code></div><div><code>    <span style="font-size:13.3333330154419px">Layout</span>MultiColumnFlowThread (anonymous)</code></div><div><code>        <span style="font-size:13.3333330154419px">Layout</span>Block (anonymous, to hold inline content)</code></div><div><code>            <span style="font-size:13.3333330154419px">Layout</span>Text "line1"</code></div><div><code>            <span style="font-size:13.3333330154419px">Layout</span>BR</code></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span>Text "line2"</code></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span>BR</code></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span>Text "line3"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "line4"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "line5"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>        <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Block</span> ("elm" DIV)</code></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "LINE6"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "LINE7"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>        <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Block</span> (anonymous, to hold inline content)</code></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "line8"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><code>            <span style="font-size:13.3333330154419px">Layout</span><span style="font-size:13.3333330154419px">Text</span> "line9"</code></div><div style="font-size:13.3333330154419px"><code>            </code><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">Layout</span><span style="font-size:13.3333330154419px;color:rgb(0,96,0);font-family:monospace;background-color:transparent">BR</span></div><div style="font-size:13.3333330154419px"><div style="font-size:13.3333330154419px"><code>    LayoutMultiColumnSet (anonymous)</code></div><div><code><br /></code></div></div><div style="font-size:13.3333330154419px"><span style="font-size:10pt;background-color:transparent">Column width will be 60px (220px minus two gaps (2 * 20px), then divided by the </span><span style="font-size:10pt;background-color:transparent">number of columns (3)).</span></div><div><br /></div><div>Column height will also be 60px (three lines, 3 * 20px).</div><div><br /></div><div>It will be rendered like this, visually:</div><div><br /></div><div><code>+---------------------------+</code></div><div><code>|line1   | line4   | LINE7  |</code></div><div><code>|line2   | line5   | line8  |</code></div><div><code>|line3   | LINE6   | line9  |</code></div><div><code>+---------------------------+</code></div><div><br /></div><div>The flow thread, however, is laid out like an imaginary tall single column<span style="font-size:10pt;background-color:transparent">, like this:</span></div><div><br /></div><div><code>+-------+</code></div><div><code>|line1  |</code></div><div><code>|line2  |</code></div><div><code>|line3  |</code></div><div><code>|line4  |</code></div><div><code>|line5  |</code></div><div><code>|LINE6  |</code></div><div><code>|LINE7  |</code></div><div><code>|line8  |</code></div><div><code>|line9  |</code></div><div><code>+-------+</code></div><div><br /></div><div>The width of the flow thread is the same as the column width - 60px:</div><div>The height of the flow thread is 9*20px = 180px.</div><div>The flow thread portion rectangle for the first column is (0, 0, 60px, 60px) - logical top:0, logical bottom:60px</div><div><div style="font-size:13.4400005340576px">The flow thread portion rectangle for the second column is (0, 60px, 60px, 60px) - logical top:60px, logical bottom:120px</div></div><div><div style="font-size:13.4400005340576px"><div style="font-size:13.4400005340576px">The flow thread portion rectangle for the third column is (0, 120px, 60px, 60px) - logical top:120px, logical bottom:180px</div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px;background-color:transparent">The visual rectangle for the first column is (0, 0, 60px, 60px).</span></div><div><span style="font-size:13.4400005340576px">The visual rectangle for the second column is (80px, 0, 60px, 60px) (x = 60px + a gap of 20px).</span></div><div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">The visual rectangle for the third column is (160px, 0, 60px, 60px).</span></div></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px"><br /></span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">The position of the "elm" DIV, in flow thread coordinates, relatively to the flow thread, is (0, 100px). Its size (in the same coordinate space) is (60px, 40px).</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">To convert the top/left position (0, 100px) of this element from flow thread coordinates to visual coordinates, we need to do this:</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">1. Figure out which column it's in. Int-divide its top position by the column height - 100px / 60px = 1 (aha, the second column)</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">2. Add the visual left position of the column (80px).</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">3. Subtract the flow thread portion rectangle top coordinate (60px).</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px">So: (0 + 80px, 100px - 60px) = (80px, 40px).</span></div><div style="font-size:13.4400005340576px"><span style="font-size:13.4400005340576px"><br /></span></div><div><span style="font-size:10pt;background-color:transparent">The position of LINE6 relatively to the multicol container, in flow thread coordinates, is (0, 100px).</span></div></div></div><div><div style="font-size:13.3333330154419px">The position of LINE7 relatively to the multicol container, in flow thread coordinates, is (0, 120px).</div></div><div style="font-size:13.3333330154419px"><div style="font-size:13.3333330154419px">The position of LINE6 relatively to the multicol container, in visual coordinates, is (80px, 40px).</div><div style="font-size:13.3333330154419px"></div></div><div><div style="font-size:13.3333330154419px"><div style="font-size:13.3333330154419px">The position of LINE7 relatively to the multicol container, in visual coordinates, is (160px, 0).</div><div style="font-size:13.3333330154419px"></div></div></div><div><br /></div><div>The bounding box of "elm" (the one with LINE6 and LINE7) in flow thread <span style="font-size:10pt;background-color:transparent">coordinates, relatively to the multicol container, will be (0, 100px, 60px, </span><span style="font-size:10pt;background-color:transparent">40px). A nice rectangle. But the block isn't rectangular, visually, since "elm"</span><span style="font-size:10pt;background-color:transparent"> lives in two columns. There's one portion </span><span style="font-size:10pt;background-color:transparent">at the bottom in the second column, at (80px, 40px, 60px, 20px) (in visual </span><span style="font-size:10pt;background-color:transparent">coordinates, relatively to the multicol container), and one portion at the top </span><span style="font-size:10pt;background-color:transparent">in the third column, at (160px, 0, 60px, 20px) (in visual coordinates, </span><span style="font-size:10pt;background-color:transparent">relatively to the multicol container). The visual bounding box is the union of </span><span style="font-size:10pt;background-color:transparent">these two portions - i.e. (80px, 0, 140px, 60px).</span></div></div><div><h2><a name="TOC-Pagination-struts"></a>Pagination struts</h2><div style="font-size:13.3333330154419px">A pagination strut is inserted in front of a column break, when a column ends up with unusable space at a column boundary (unbreakable content (e.g. a line) got moved to the next column, because there was <b>some</b>, but not enugh, space available in the previous column). For example, if we have a bunch of lines, and the column height is 5em, and line height is 2em, you can fit 2 lines per column. At the bottom of each column there'll be 1em of unusable space. So we need to insert a strut in front of lines that are "moved" to the next columns. This way the flow thread can be sliced nicely and easily into columns when painting and hit-testing.</div></div><div style="font-size:13.3333330154419px"><br /></div><h3 style="font-size:13.3333330154419px"><a name="TOC-Example1"></a>Example</h3><div><span style="color:rgb(0,96,0);font-family:monospace;font-size:10pt;background-color:transparent">&lt;div style="</span><span style="color:rgb(0,96,0);font-family:monospace;font-size:10pt;background-color:transparent">-webkit-columns: 3; column-fill: auto; height: 3.8em; </span><span style="color:rgb(0,96,0);font-family:monospace;font-size:10pt;background-color:transparent">border: solid; -webkit-column-rule: 1px solid;"</span><span style="color:rgb(0,96,0);font-family:monospace;font-size:10pt;background-color:transparent">&gt;</span></div><div><span style="background-color:transparent"><font color="#006000" face="monospace"><div>    &lt;div style="background:yellow;"&gt;</div><div>        &lt;span style="font-size:1.7em;"&gt;Tall line&lt;/span&gt;&lt;br&gt;</div><div>        line2&lt;br&gt;</div><div>        line3&lt;br&gt;</div><div>    &lt;/div&gt;</div><div>    line4&lt;br&gt;</div><div><span>    </span>line5&lt;br&gt;</div><div><span>    </span>line6&lt;br&gt;</div><div><span>    </span>line7&lt;br&gt;</div><div>&lt;/div&gt;</div></font></span></div><div><br /></div><div>This gives the following flow thread, with pagination struts shown in magenta:</div><div><br /></div><div><div><div xmlns:jot="http://www.google.com/ns/jotspot/srvtmpl/" id="__cajaGadgetContainer__0" style="display:block;float:left;"><caja-v-html><caja-v-head></caja-v-head><caja-v-body><div style="width: 10em; margin: 1em">
<div style="overflow: hidden; height: 3.8em; background: yellow">
<span style="font-size: 1.7em">Tall line</span><br />
        line2<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div style="overflow: hidden; height: 3.8em">
<div style="background: yellow">line3<br /></div>
        line4<br />
        line5<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div>
        line6<br />
        line7<br />
</div>
</div>
</caja-v-body></caja-v-html></div><script>sites.caja.run("{___.loadModule({\'instantiate\':function(___,IMPORTS___){return},\'cajolerName\':\'com.google.caja\',\'cajolerVersion\':\'v6003-es53-1-gb2a25f6\',\'cajoledDate\':1442986599834})}", "__cajaGadgetContainer__0");</script></div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div>Visual rendering, with the flow thread super-imposed for each column. Struts shown in magenta:</div><div><br /></div><div><div><div xmlns:jot="http://www.google.com/ns/jotspot/srvtmpl/" id="__cajaGadgetContainer__1" style="display:block;float:left;"><caja-v-html><caja-v-head></caja-v-head><caja-v-body><div style="padding: 7em 0">
<div style="position: relative; border: solid; width: 32em; height: 3.8em">
<div style="float: left; width: 10em; height: 100%; overflow: hidden; background: yellow">
<div>
<span style="font-size: 1.7em">Tall line</span><br />
                line2<br />
</div>
<div style="height: 10em; background: magenta"></div>
</div>
<div style="float: left; width: 1em; height: 100%">
<div style="width: 0; margin: auto; height: 100%; border-left: 1px solid"></div>
</div>
<div style="float: left; width: 10em; height: 100%; overflow: hidden">
<div>
<div style="background: yellow">
                    line3<br />
</div>
                line4<br />
                line5<br />
</div>
<div style="height: 10em; background: magenta"></div>
</div>
<div style="float: left; width: 1em; height: 100%">
<div style="width: 0; margin: auto; height: 100%; border-left: 1px solid"></div>
</div>
<div style="float: left; width: 10em">
<div>
                line6<br />
                line7<br />
</div>
</div>
<div style="position: absolute; opacity: 0.2; top: 0; left: 0; width: 10em">
<div style="overflow: hidden; height: 3.8em; background: yellow">
<span style="font-size: 1.7em">Tall line</span><br />
                line2<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div style="overflow: hidden; height: 3.8em">
<div style="background: yellow">line3<br /></div>
                line4<br />
                line5<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div>
                line6<br />
                line7<br />
</div>
</div>
<div style="position: absolute; opacity: 0.2; top: -3.8em; left: 11em; width: 10em">
<div style="overflow: hidden; height: 3.8em; background: yellow">
<span style="font-size: 1.7em">Tall line</span><br />
                line2<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div style="overflow: hidden; height: 3.8em">
<div style="background: yellow">line3<br /></div>
                line4<br />
                line5<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div>
                line6<br />
                line7<br />
</div>
</div>
<div style="position: absolute; opacity: 0.2; top: -7.6em; left: 22em; width: 10em">
<div style="overflow: hidden; height: 3.8em; background: yellow">
<span style="font-size: 1.7em">Tall line</span><br />
                line2<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div style="overflow: hidden; height: 3.8em">
<div style="background: yellow">line3<br /></div>
                line4<br />
                line5<br />
<div style="height: 10em; background: magenta"></div>
</div>
<div>
                line6<br />
                line7<br />
</div>
</div>
</div>
</div>
</caja-v-body></caja-v-html></div><script>sites.caja.run("{___.loadModule({\'instantiate\':function(___,IMPORTS___){return},\'cajolerName\':\'com.google.caja\',\'cajolerVersion\':\'v6003-es53-1-gb2a25f6\',\'cajoledDate\':1442986599845})}", "__cajaGadgetContainer__1");</script></div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><h2><a name="TOC-Column-balancing"></a>Column balancing</h2><h2 style="font-size:13.3333330154419px"><a name="TOC-If-column-height-cannot-be-deduced-from-CSS-properties-typically-height-because-the-height-is-auto-or-column-fill-is-balance-that-s-the-initial-value-or-if-a-column-row-is-followed-by-a-column-span:all-element-we-need-to-attempt-to-calculate-an-optimal-col"></a><span style="font-size:10pt;font-weight:normal;background-color:transparent">If column height cannot be deduced from CSS properties (typically "height"), because the height is auto, or column-fill is 'balance' (that's the initial value), or if a column row is followed by a column-span:all element, we need to attempt to calculate an optimal column height on our own, based on the contents.</span></h2><div><div>It goes like this:</div><div><br /></div><div><span style="font-size:10pt;background-color:transparent">1. Lay out the flow thread without implicit breaks</span></div><div>2. Initial / guessed / minimal column height is: flow thread's height divided by the number of columns.</div><div>3. Lay out the flow thread again, with implicit breaks, inserting any necessary pagination struts at column boundaries.</div><div>4. If we get too many columns now, stretch column height by the "minimum space shortage" and repeat the previous step, as many times as necessary.</div><div><br /></div><div>Minimum space shortage: the smallest amount of space that would have prevented a break at a given position in the previous layout pass.</div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/design-documents/multi-column-layout">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9gqOuVSOQvVZLDPws5ziJssvsXNvwnZbn1AeHjL0MNDNwsWB0AIEXpwOU4sBrW-7vChGTWlGz-HW57o1uoyaIK4PwOaeeTlm9OyhuXJGyVl9qbJUx/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
