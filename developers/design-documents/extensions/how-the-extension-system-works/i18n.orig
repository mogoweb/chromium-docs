<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/design-documents","deleted":false,"title":"Design Documents","dir":"ltr"},{"path":"/developers/design-documents/extensions","deleted":false,"title":"Extensions","dir":"ltr"},{"path":"/developers/design-documents/extensions/how-the-extension-system-works","deleted":false,"title":"How the Extension System Works","dir":"ltr"},{"path":"/developers/design-documents/extensions/how-the-extension-system-works/i18n","deleted":false,"title":"i18n for extensions","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/design-documents/extensions/how-the-extension-system-works/i18n\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/design-documents/extensions/how-the-extension-system-works","parentWuid":"wuid:gx:139f62f8afff8e0c","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"i18n for extensions","locale":"en","wuid":"wuid:gx:559d7696f2d438f","revision":32,"path":"/developers/design-documents/extensions/how-the-extension-system-works/i18n","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"i18n","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="i18n for extensions - The Chromium Projects" />
<meta itemprop="name" content="i18n for extensions - The Chromium Projects" />
<meta property="og:title" content="i18n for extensions - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>i18n for extensions - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/design-documents" dir="ltr">Design Documents</A>‎ &gt; ‎<A href="/developers/design-documents/extensions" dir="ltr">Extensions</A>‎ &gt; ‎<A href="/developers/design-documents/extensions/how-the-extension-system-works" dir="ltr">How the Extension System Works</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">i18n for extensions</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><span style="font-family:Verdana,sans-serif;font-size:13px"><div style="margin-top:0px;margin-bottom:0px"><b><font size="4">
<div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed sites-embed-full-width" style="width:100%;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-3"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Introduction"><strong>1 </strong>Introduction</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Google-Gadgets-approach"><strong>1.1 </strong>Google Gadgets approach</a></li><li class="goog-toc"><a href="#TOC-Firefox-approach"><strong>1.2 </strong>Firefox approach</a></li></ol></li><li class="goog-toc"><a href="#TOC-Proposed-solution"><strong>2 </strong>Proposed solution</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Locale-fallback"><strong>2.1 </strong>Locale fallback</a><ol class="goog-toc"><li class="goog-toc"><a href="#TOC-Supported-locales"><strong>2.1.1 </strong>Supported locales</a></li></ol></li><li class="goog-toc"><a href="#TOC-Replacement-policy"><strong>2.2 </strong>Replacement policy</a></li><li class="goog-toc"><a href="#TOC-Message-container"><strong>2.3 </strong>Message container</a></li><li class="goog-toc"><a href="#TOC-Message-format"><strong>2.4 </strong>Message format</a></li><li class="goog-toc"><a href="#TOC-Conflict-resolution"><strong>2.5 </strong>Conflict resolution</a></li><li class="goog-toc"><a href="#TOC-Plural-form"><strong>2.6 </strong>Plural form</a></li><li class="goog-toc"><a href="#TOC-Chrome-API"><strong>2.7 </strong>Chrome API</a></li><li class="goog-toc"><a href="#TOC-Structure-on-disk"><strong>2.8 </strong>Structure on disk</a></li><li class="goog-toc"><a href="#TOC-Manifest"><strong>2.9 </strong>Manifest</a></li><li class="goog-toc"><a href="#TOC-HTML-in-general"><strong>2.10 </strong>HTML in general</a></li><li class="goog-toc"><a href="#TOC-External-resources"><strong>2.11 </strong>External resources</a></li><li class="goog-toc"><a href="#TOC-Local-Resources"><strong>2.12 </strong>Local Resources</a></li></ol></li></ol></div></div></div></div>
<br />
</font></b></div><h2><a name="TOC-Introduction"></a>Introduction</h2><div style="margin-top:0px;margin-bottom:0px">Developers tend to hard-code messages in the code, in their native language, or more often in English, and we need to provide simple enough message replacement system for them to prevent that behavior.</div><p style="margin:0px">There are two approaches we can use, one widely known Firefox ENTITY replacement, and the other Google Gadgets are using.</p><h3><a name="TOC-Google-Gadgets-approach"></a>Google Gadgets approach</h3><div style="margin-top:0px;margin-bottom:0px">Google gadgets are based on XML spec, which carries some metadata and html/js of a gadget.</div><div style="margin-top:0px;margin-bottom:0px">Each spec lists supported locales, and links to locale files. Any item can be replaced within the gadget spec (urls, messages...). Substitution is done in container code (iGoogle, Orkut...), where we control the whole process (fallback order for example).</div><div style="margin-top:0px;margin-bottom:0px">Message catalogs are in XML format (to better support our translation pipeline).</div><div style="margin-top:0px;margin-bottom:0px">Public API, sample gadget spec and message bundles could be found at <a href="http://code.google.com/intl/sr-RS/apis/gadgets/docs/i18n.html" style="color:rgb(85,26,139)">http://code.google.com/intl/sr-RS/apis/gadgets/docs/i18n.html</a>.</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><h3><a name="TOC-Firefox-approach"></a>Firefox approach</h3><div style="margin-top:0px;margin-bottom:0px">Firefox is using XUL files for their extensions (XML format). XML parser automatically replaces DTD ENTITYs within a XML document given DTD file(s). For details see <a href="http://www.rietta.com/firefox/Tutorial/locale.html" rel="nofollow" style="color:rgb(85,26,139)" title="how to localize firefox extensions.">how to localize firefox extensions.</a></div><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">Problem with this approach is that we don't actually have XML/XHTML files tied to an extension. Also, we may want to implement more flexible fallback algorithm.</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><h2 style="font-size:14pt"><a name="TOC-Proposed-solution"></a>Proposed solution</h2><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px">We use HTML/JS to develop extensions, and to keep metadata about extensions (manifest) vs. XUL files for Firefox. </div><div style="margin-top:0px;margin-bottom:0px">We should use modified Google Gadget approach since they are too HTML/JS entities:</div><div style="margin-top:0px;margin-bottom:0px"><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">Messages are stored in <b>JSON</b> objects (key-value) - one object per catalog.</li><li style="margin-top:0px;margin-bottom:0px">Message placeholders are in <b>__MSG_message_name__</b> format.</li><li style="margin-top:0px;margin-bottom:0px">Provide formatted messages, <b>getMessage(</b>formatted_msg_name, [arg1, arg2,...]<b>)</b>. See <a href="http://code.google.com/chrome/extensions/i18n.html">http://code.google.com/chrome/extensions/i18n.html</a> for actual implementation.<br /></li><li style="margin-top:0px;margin-bottom:0px"><b>Single catalog</b> per locale. This makes fallback and conflict resolution algorithms much simpler, and it avoids need for namespaces. Multiple catalogs could help with pre-made translations (like city names, country names, common phrases like Open, Close, Extension version...) but this could be achieved by unifying all subcatalogs into one master catalog and resolving ID conflicts.</li><li style="margin-top:0px;margin-bottom:0px">Catalogs are placed at the <b>fixed location</b>, to avoid storing that information in the source files (like links to catalogs in gadgets).</li></ul><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">See details below.</div></div><h3 style="font-size:12pt"><a name="TOC-Locale-fallback"></a>Locale fallback</h3><div style="margin-top:0px;margin-bottom:0px">Only some locales will have all of the messages translated, or resources generated. Some locales may be completely missing. In both cases Chrome should gracefully fall back to what's available.</div><div style="margin-top:0px;margin-bottom:0px">To do that we need to order locales in tree like structure based on locale identifiers.</div><div style="margin-top:0px;margin-bottom:0px"><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">Use full locale identifier as locale name - <b>language</b>_<b>script</b>_<b>country@locale_extensions</b>. For full description of locale identifier look at <a href="http://www.unicode.org/reports/tr35/#Unicode_Language_and_Locale_Identifiers" rel="nofollow" title="Unicode Locale Description.">Unicode Locale Description.</a> Script and locale extensions are optional. Extended parameters can be sorting order (dictionary vs. phonebook) or anything locale specific.</li><li style="margin-top:0px;margin-bottom:0px">Fallback goes from specialized to generic, i.e. : sr_latn_rs -&gt; sr_latn -&gt; sr -&gt; default_locale.</li><li style="margin-top:0px;margin-bottom:0px">default_locale is a root locale.</li></ul></div><div style="margin-top:0px;margin-bottom:0px"><br /><h4><a name="TOC-Supported-locales"></a>Supported locales</h4><span style="font-family:Verdana,sans-serif;font-size:13px">
<p>
</p>
<div>We support larger set of locales than Chrome UI. Current list is (as of 35300<span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times New Roman;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:monospace;text-align:left">)</span></span>:<br />am, ar, bg, bn, ca, cs, da, de, el, en, en_GB, en_US, es, es_419, et, fi, fil, fr, gu, he, hi, hr, hu, id, it, ja, kn, ko, lt,</div>
<div>lv, ml, mr, nb, nl, or, pl, pt, pt_BR, pt_PT, ro, ru, sk, sl, sr, sv, sw, ta, te, th, tr, uk, vi, zh, zh_CN, zh_TW </div></span>
<br /></div><h3 style="font-size:12pt"><a name="TOC-Replacement-policy"></a>Replacement policy</h3><div style="margin-top:0px;margin-bottom:0px">To avoid hard-coding strings, developer should use message placeholders in the code/static files.</div><div style="margin-top:0px;margin-bottom:0px"><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">Use message placeholders, like __MSG_some_message__.</li><li style="margin-top:0px;margin-bottom:0px">For formatted messages (positional arguments) use $1 - $9.</li></ul><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">Message concatenation is usually a bad thing, and should be avoided, but it's possible with __MSG_msg_1__ + __MSG_msg_2__.</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><h3 style="font-size:12pt"><a name="TOC-Message-container"></a>Message container</h3><div style="margin-top:0px;margin-bottom:0px">Message placeholders and message bodies have simple key-value structure, which can be implemented as:</div><div style="margin-top:0px;margin-bottom:0px"><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">JSON - native to everything we do.</li><li style="margin-top:0px;margin-bottom:0px">Message bundles should be UTF-8 encoded.</li></ul><div style="margin-top:0px;margin-bottom:0px"><font color="#ff0000"><br /></font></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><b>Proposed JSON format</b>:</div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">{</div><div style="margin-top:0px;margin-bottom:0px">  "name": {</div><div style="margin-top:0px;margin-bottom:0px">       "message": "message text - short sentence or even a paragraph with a optional placeholder(s)",</div><div style="margin-top:0px;margin-bottom:0px">       "description": "Description of a message that should give context to a translator",</div><div style="margin-top:0px;margin-bottom:0px">          "placeholders": {</div><div style="margin-top:0px;margin-bottom:0px">              "ph_1": {</div><div style="margin-top:0px;margin-bottom:0px">                  "content": "Actual string that's placed within a message.",<br /></div><div style="margin-top:0px;margin-bottom:0px">                  "example": "Example shown to a translator."</div><div style="margin-top:0px;margin-bottom:0px">              },</div><div style="margin-top:0px;margin-bottom:0px">              ...</div><div style="margin-top:0px;margin-bottom:0px">       }</div><div style="margin-top:0px;margin-bottom:0px">  },</div><div style="margin-top:0px;margin-bottom:0px">...</div><div style="margin-top:0px;margin-bottom:0px">}</div><div style="margin-top:0px;margin-bottom:0px"><br /></div></div><div style="margin-top:0px;margin-bottom:0px"><b>Example</b>:</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">{</div><div style="margin-top:0px;margin-bottom:0px">  "hello": {</div><div style="margin-top:0px;margin-bottom:0px">       "message": "Hello $YOUR_NAME$",</div><div style="margin-top:0px;margin-bottom:0px">       "description": "Peer greeting",</div><div style="margin-top:0px;margin-bottom:0px">          "placeholders": {</div><div style="margin-top:0px;margin-bottom:0px">             "your_name": {</div><div style="margin-top:0px;margin-bottom:0px">                 "content": "$1",</div><div style="margin-top:0px;margin-bottom:0px">                 "example": "Cira"</div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px">  },</div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px">  "bye": {</div><div style="margin-top:0px;margin-bottom:0px">       "message": "Bye from $CHROME$ to $YOUR_NAME$",</div><div style="margin-top:0px;margin-bottom:0px">       "description": "Going away greeting",</div><div style="margin-top:0px;margin-bottom:0px">          "placeholders": {</div><div style="margin-top:0px;margin-bottom:0px">              "chrome": {</div><div style="margin-top:0px;margin-bottom:0px">                 "content": "Chrome",</div><div style="margin-top:0px;margin-bottom:0px">              },</div><div style="margin-top:0px;margin-bottom:0px">              "your_name": {</div><div style="margin-top:0px;margin-bottom:0px">                 "content": "$1",</div><div style="margin-top:0px;margin-bottom:0px">                 "example": "Cira"</div><div style="margin-top:0px;margin-bottom:0px">              }</div><div style="margin-top:0px;margin-bottom:0px">         }</div><div style="margin-top:0px;margin-bottom:0px">  }</div></div><div style="margin-top:0px;margin-bottom:0px">}</div><div style="margin-top:0px;margin-bottom:0px"><ul><li><i>name</i> is the name of the message used in message substitution (__MSG_<b>name</b>__, or getMessage(<b>name</b>)). It's a key portion to the value that holds message text and description. Name has to be unique per catalog, but message body and description don't have to. Message name is case insensitive.<br /></li><li><i>message</i> is actual translated message. Required attribute.</li><li><i>description</i> is there to help a translator by giving context of the message (or better description). Optional attribute.</li><li><i>$NAME$</i> section defines a placeholder, and it's an element indicating a placeholder in your message. Placeholders provide immutable English-language text to show to translators in place of parts of your messages that you don't want them to edit, such as HTML, Trademarked name, formatting specifiers, etc. A placeholder should have a name attribute (ph_1) and preferably an example element showing how the content will appear to the end user (to give the translator some context). All A-Z, 0 - 9 and _ are allowed. Placeholder section is optional if message has no $NAME$ sections. Placeholder name is case insensitive.<br /></li><li><i>content</i> is<i> <span style="font-style:normal">is the actual message text placeholder is replacing. It's required within a placeholder section.</span></i></li><li><i>example</i> is an example of what the contents of a placeholder will look like when actually shown to a customer. These are used by the translators to help understand what the placeholder will look like. Examples are optional but highly recommended; there should be one for each placeholder. For example, a "$1" formatting string that will be populated with a dollar amount should have an example like "$23.45". For HTML tags or reserved words, the content of the example is the content of the message string itself. It's optional within a placeholder section.</li></ul><h3><a name="TOC-Message-format"></a>Message format</h3><div><font color="#ff0000"><br /></font></div><div>There are couple of possible forms message can take:<br /><ul><li>simple text - "Hello world!".</li><li>formatted message with positional arguments - "Hello $PERSON_2$ and $PERSON_1$" - argument 2 will be printed after Hello, and argument 1 after and. Translator can re-order positional parameters depending on the language.</li></ul><h3><a name="TOC-Conflict-resolution"></a>Conflict resolution</h3><p>Same message ID should exist only once per catalog. If there are duplicates - detected when packing extension - we should ask developer to remove them.</p></div></div><div style="margin-top:0px;margin-bottom:0px"><h3><a name="TOC-Plural-form"></a>Plural form</h3><p>Dealing with plural forms is hard. Each language has different rules and special cases. To avoid complexity we are going to use plural neutral form.</p><p>Instead of saying "11 file were moved" we could say "Files moved: 11".<br /></p><p>This is a valid solution in most cases.</p></div><h3 style="font-size:12pt"><a name="TOC-Chrome-API"></a>Chrome API</h3><div style="margin-top:0px;margin-bottom:0px">Chrome will automatically replace all message placeholders when loading static files (html, js, manifest...) given the current browser UI language.</div><div style="margin-top:0px;margin-bottom:0px">Scripts may want to use messages from different locales, or to fetch resources and replace message placeholders in them dynamically.</div><div style="margin-top:0px;margin-bottom:0px">For that we may need:</div><div style="margin-top:0px;margin-bottom:0px"><ul style="margin-top:0px;margin-bottom:0px"><li style="margin-top:0px;margin-bottom:0px">chrome.i18n.getMessage("message") would return message translation for current locale</li></ul><h3><a name="TOC-Structure-on-disk"></a>Structure on disk</h3><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px">There would be a _<b>locales</b> subdirectory under main extension directory.</div><div style="margin-top:0px;margin-bottom:0px">It would contain N subdirectories named as locale identifiers (sr, en_US, en, en_GB, ...).</div><div style="margin-top:0px;margin-bottom:0px"><br /></div>top_extension_directory/_<b>locales</b>/<b>locale_identifier</b>/</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px">Each locale_identifier subdirectory can contain only one <b>messages.json </b>file.</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px">Extension manifest has an optional "default_locale": "language_country" field that points to default language. Some edge cases:</div><div style="margin-top:0px;margin-bottom:0px"><ul><li>There is only one locale in the package - fail if it doesn't match default_locale.</li><li>default_locale is missing, and we have more than one locale in the package - fail. This case shouldn't happen - we wouldn't create package like that.</li><li>default_locale points to a locale not present in the package - fail.</li></ul></div></div><div style="margin-top:0px;margin-bottom:0px">Default locale is used as final fallback option if message couldn't be found for current locale.<br /><br /></div><div style="margin-top:0px;margin-bottom:0px"><span style="font-size:19px;font-weight:bold">Use cases</span></div></div></div></div></div><h3 style="font-size:12pt"><a name="TOC-Manifest"></a>Manifest</h3><div style="margin-top:0px;margin-bottom:0px">Manifest file contains metadata about extension in JSON format.</div><div style="margin-top:0px;margin-bottom:0px">When loading manifest file, Chrome should replace all __MSG_msg_name__ identifiers with messages from the catalog and then process the final object.</div><h3 style="font-size:12pt"><a name="TOC-HTML-in-general"></a>HTML in general</h3><div style="margin-top:0px;margin-bottom:0px">New tab page and possibly some other static content. We currently use google2 template system? which is somewhat an overkill for couple of pages.</div><div style="margin-top:0px;margin-bottom:0px">We could deliver message catalogs for each locale as part of installation package, and use message placeholders in new tab source.</div><h3 style="font-size:12pt"><a name="TOC-External-resources"></a>External resources</h3><div style="margin-top:0px;margin-bottom:0px">All absolute urls (like href, src...) should be pointed to __MSG_some_url__, and each locale could provide separate implementation (image, script...).</div><div style="margin-top:0px;margin-bottom:0px">On loading extension files - html, js - Chrome would replace all __MSG_some_url__ with actual, locale specific, url.</div><div style="margin-top:0px;margin-bottom:0px"><br /></div><h3><a name="TOC-Local-Resources"></a>Local Resources</h3><p>Local resources, like &lt;img src="foo/bar.png"&gt; should be auto resolved to _locale/current_locale/foo/bar.png or if that resource is missing to fallback location.</p></span></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/design-documents/extensions/how-the-extension-system-works/i18n">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXukca4jaDOG9SuQz_G8t7Hl9hOJRVOALq0LGrCpYGG5byiD4myf6vKDMnFW-4-Ufhh13NNvWVZ1kT3tMUWDSjW0C8t7UKOskUeKgbhl4gkusfVfmMczTgQjB4U2dH-QWYUz5Q9z/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
