<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/design-documents","deleted":false,"title":"Design Documents","dir":"ltr"},{"path":"/developers/design-documents/extensions","deleted":false,"title":"Extensions","dir":"ltr"},{"path":"/developers/design-documents/extensions/proposed-changes","deleted":false,"title":"Proposed \u0026 Proposing New Changes","dir":"ltr"},{"path":"/developers/design-documents/extensions/proposed-changes/apis-under-development","deleted":false,"title":"API Proposals (New APIs Start Here)","dir":"ltr"},{"path":"/developers/design-documents/extensions/proposed-changes/apis-under-development/settings","deleted":false,"title":"Settings API","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/design-documents/extensions/proposed-changes/apis-under-development/settings\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/design-documents/extensions/proposed-changes/apis-under-development","parentWuid":"wuid:gx:4a1283b73b239cf","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Settings API","locale":"en","wuid":"wuid:gx:455d19b6b257f4cc","revision":21,"path":"/developers/design-documents/extensions/proposed-changes/apis-under-development/settings","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"settings","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/config/pagetemplates/extension-api-proposal-template","title":"API Proposal Template"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Settings API - The Chromium Projects" />
<meta itemprop="name" content="Settings API - The Chromium Projects" />
<meta property="og:title" content="Settings API - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Settings API - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/design-documents" dir="ltr">Design Documents</A>‎ &gt; ‎<A href="/developers/design-documents/extensions" dir="ltr">Extensions</A>‎ &gt; ‎<A href="/developers/design-documents/extensions/proposed-changes" dir="ltr">Proposed &amp; Proposing New Changes</A>‎ &gt; ‎<A href="/developers/design-documents/extensions/proposed-changes/apis-under-development" dir="ltr">API Proposals (New APIs Start Here)</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Settings API</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Overview</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">This page proposes adding methods/events to chrome.settings to let extensions store settings data (assumed to be small pieces of string-like data) that is synced across a user's browser instances.  Initially, the module would start in the chrome.experimental.settings namespace.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><i><br /></i></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Use cases</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">Ever since extensions/apps sync was implemented, extension settings sync has been an oft-requested and <a href="http://googlesystem.blogspot.com/2010/12/predictions-for-googles-2011.html">anticipated</a> feature.  Syncing an extension's settings greatly enhances the usefulness of extension sync.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><i><br /></i></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Could this API be part of the web platform?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">No.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><br /></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Do you expect this API to be fairly stable?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">Yes.  This API is based on the HTML5 storage spec which is unlikely to change much.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><br /></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>What UI does this API expose?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">No additional UI is exposed.  However, we may need to add UI to chrome://extensions for turning off settings sync for particular extensions.  On the other hand, extension developers could do this themselves.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><i><br /></i></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>How could this API be abused?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">An ill-behaved extension could create lots of data to sync, bogging down both the client and the server.  This may also cause the user to be throttled, possibly affecting sync for other data types (e.g., bookmarks, preferences).</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><i><br /></i><b>How would you implement your desired features if this API didn't exist?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">Currently, extensions sync their settings by stuffing data in bookmarks.  This is obviously very hacky and causes problems for sync.<i><br /></i></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><br /></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Are you willing and able to develop and maintain this API?</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">The sync team can develop and maintain this API.</div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><i><br /></i></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Draft API spec</b></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif">It might be helpful to refer to docs for the HTML5 storage spec: see <a href="http://diveintohtml5.org/storage.html">this overview</a> and <a href="http://dev.w3.org/html5/webstorage/">the spec itself</a>.<a href="/"></a></div><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b><br /></b></div></div><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><span style="font-family:Verdana,sans-serif"><b>API Reference: chrome.experimental.settings (later chrome.extension.settings)</b></span></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><br /></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><span style="font-family:Verdana,sans-serif"><b>Methods</b></span></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><br /></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>getSettings</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="'courier new', monospace">chrome.experimental.settings.getSettings(function callback)</font></div><div style="margin-top:0px;margin-bottom:0px"><span style="font-family:Verdana,sans-serif"><b>    Parameters</b></span></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><span style="font-family:Verdana,sans-serif"><b><i>     callback ( function )</i></b></span></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>    Callback function</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif">    The callback parameter should specify a function that looks like this:</font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="verdana, sans-serif">    </font><font face="'courier new', monospace">function(Storage settings) {...}</font></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="verdana, sans-serif">    </font><span style="font-family:Verdana,sans-serif"><b>settings ( Storage )</b></span></div><div style="margin-top:0px;margin-bottom:0px"><b><span style="font-weight:normal"><div style="margin-top:0px;margin-bottom:0px;font-family:Arial,Verdana,sans-serif"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="verdana, sans-serif">    The settings Storage object.  It is guaranteed that nothing else will access this (including sync) for the lifetime of the callback.</font></div></div></div></div></div></div></span></b></div></div></div></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><br /></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>Events</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><br /></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>onSettingsChanged</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="'courier new', monospace">chrome.experimental.settings.onSettingChanged.addListener(function(StorageEvent e) {...});</font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif">Fires when a setting has been changed, either locally or from another browser instance.</font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>    Parameters</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif"><b>    e ( StorageEvent )</b></font></div></div></div><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px"><font face="Verdana, sans-serif">    Details of the setting that was changed.</font></div></div></div></blockquote><font face="Verdana, sans-serif"><ul><li>The Storage object passed to the getSettings callback behaves very similarly to the localStorage object; it is persisted across browser restarts and is per-profile.  However, any changes made to it may eventually be synced to other browser instances with synced turned on.  Also, the onSettingsChanged event may be fired when changes from other browser instances are synced to the local one.</li><li>No guarantees are made as to how long it takes for changes to propagate, or even if they're propagated at all.  Sync may be turned off, clients may be throttled, and other reasons may prevent or delay propagation.</li><li>Each top-level key-value pair is guaranteed to be synced atomically.  That is, while settings["a"] and settings["b"] may be synced independently, two clients writing separate values to the same key will cause the final state to be either one or the other.  However, the settings Storage object at worst behaves like another localStorage.</li><li>The storage limits for the settings Storage object are more stringent than localStorage; tentatively, it is planned that each key/value pair can have a maximum of 16kb, and the total storage for an extension cannot exceed 100kb.  It is expected that the most common use case for this are small pieces of string-like data, e.g. settings and preferences.</li><li>Extension developers must take care not to modify settings too often or else they risk being throttled (if they do on the order of hundreds or thousands of changes in a 24 hour period).</li><li>Sync will only kick in after a call to getSettings to propagate any changed settings and/or apply any new settings.  This means that an extension developer has some control on how often sync fires.</li><li>Uninstalling an extension currently clears all settings data for it.  (This may be surprising in some cases; we may need to revisit this in the future.)</li><li>This API will have its own manifest permission ("settings") but won't trigger a warning.</li></ul></font><blockquote style="margin:0 0 0 40px;border:none;padding:0px"><div style="font-family:Verdana,sans-serif">Example usage:</div><div style="font-family:Verdana,sans-serif"><br /></div><div><font face="'courier new', monospace">// Imagine an extension that retrieves data from a particular URL.</font></div><div><font face="'courier new', monospace">chrome.experimental.settings.getSettings(function(settings) {</font></div><div><font face="'courier new', monospace">  // Do initial frobnigation, setting a default value if necessary.</font></div><div><font face="'courier new', monospace">  var dataUrl = settings["dataUrl"];</font></div><div><font face="'courier new', monospace">  if (!dataUrl) {</font></div><div><font face="'courier new', monospace">    // This will be propagated to other browser instances after this</font></div><div><font face="'courier new', monospace">    // callback.</font></div><div><font face="'courier new', monospace">    dataUrl = settings["dataUrl"] = "http://www.foo.com/mydata";</font></div><div><font face="'courier new', monospace">  }</font></div><div><font face="'courier new', monospace">  doInitialFrobnigate(dataUrl);</font></div><div><font face="'courier new', monospace">});</font></div><div><font face="'courier new', monospace"><br /></font></div><div><font face="'courier new', monospace">// Do an update every time the dataUrl setting is changed (either</font></div><div><font face="'courier new', monospace">// locally or remotely).</font></div><div><font face="'courier new', monospace">chrome.experimental.settings.onSettingChanged.addListener(function(e) {</font></div><div><font face="'courier new', monospace">  if (e.key == "dataUrl") {</font></div><div><font face="'courier new', monospace">    console.info("Changing data URL from " + e.oldValue + " to " + e.newValue);</font></div><div><span style="font-family:courier new,monospace">    doUpdateFrobnigate(e.newValue);</span></div><div><span style="font-family:courier new,monospace">  }</span></div><div><font face="'courier new', monospace">});</font></div><div><font face="'courier new', monospace"><br /></font></div><div><font face="verdana, sans-serif">Example code demonstrating when it's okay to access the settings object:</font></div><div><font face="verdana, sans-serif"><br /></font></div><div><span style="border-collapse:collapse"><font face="'courier new', monospace">chrome.extension.settings.getSettings(function(settings) {<br /> // While this callback is being invoked, the extension has exclusive access to the settings.<br /> // At other times the extension does not have access. We do this to avoid raciness between<br /> // multiple processes manipulating the data concurrently.<br /> var foo = settings.foo;<br /> settings.foo = foo + 1;  // using settings object here is OK<br /><br /> window.setTimeout(function() {<br />    // This is invalid! The extension no longer has access to |settings|. We need to make it<br />    // so that trying to read or write from the settings object after the callback is complete<br />    // throws an error.<br />   alert(settings.foo);<br /> }, 1000);<br /><br /> // Access to the extension's settings goes away at the end of this callback.<br />});</font></span></div><div><font face="'courier new', monospace"><br /></font></div></blockquote><div style="margin-top:0px;margin-bottom:0px"><div style="margin-top:0px;margin-bottom:0px;font-family:Verdana,sans-serif"><b>Open questions</b></div><div style="margin-top:0px;margin-bottom:0px"><ul><li><span style="font-family:Verdana,sans-serif">Is there a need for syncing other types of data, e.g. large pieces of data or structured data?</span></li><li><font face="Verdana, sans-serif">Do we need anything for the enterprise use case?  It may be useful to be able to provide a default settings object and maybe even to mark some settings non-editable.</font></li></ul></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/design-documents/extensions/proposed-changes/apis-under-development/settings">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9sFZs8rWNIAX9yY2RsTR9Phuj0nT3XuzXsHDkLICWcZ8-yX0gABm1D5ov7nO4k2UiUqjolifdN6AXJHZR8EIFbP70Timdee4HV2hJcJVeL9RVUQts/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
