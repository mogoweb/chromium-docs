<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/how-tos","deleted":false,"title":"How-Tos","dir":"ltr"},{"path":"/developers/how-tos/get-the-code","deleted":false,"title":"Get the Code: Checkout, Build, Run \u0026 Submit","dir":"ltr"},{"path":"/developers/how-tos/get-the-code/working-with-branches","deleted":false,"title":"Working with Branches","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/how-tos/get-the-code/working-with-branches\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/how-tos/get-the-code","parentWuid":"wuid:gx:6bcea0c758de87e3","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Working with Branches","locale":"en","wuid":"wuid:gx:10e8c1ccecc8df04","revision":2,"path":"/developers/how-tos/get-the-code/working-with-branches","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"working-with-branches","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Working with Branches - The Chromium Projects" />
<meta itemprop="name" content="Working with Branches - The Chromium Projects" />
<meta property="og:title" content="Working with Branches - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Working with Branches - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/how-tos" dir="ltr">How-Tos</A>‎ &gt; ‎<A href="/developers/how-tos/get-the-code" dir="ltr">Get the Code: Checkout, Build, Run &amp; Submit</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Working with Branches</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><h3><a name="TOC-Basics"></a>Basics</h3><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">Enumerate your local branches:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  cd src<br />  git branch</pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">Switching from one branch to another: Example: Switching from branch 'branch1' to branch 'branch2'.</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  cd src<br />  git checkout branch2</pre><p>Note that <code>-</code> can be used to refer to the previous branch, which is useful when switching between two branches.</p><pre><div class="sites-codeblock sites-codesnippet-block"><code>git checkout some_branch</code><br /><code>git checkout -  # back to previous branch!</code></div></pre><h3><a name="TOC-Suggested-branching-workflow"></a>Suggested branching workflow</h3><p>We normally do our feature work in branches to keep changes isolated from each other. The recommended workflow is to make local branches off the server master, referred<span style="font-family:arial,sans-serif;font-size:10pt;background-color:transparent"> to as the </span><tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em;background-color:transparent">origin/master</tt><span style="font-family:arial,sans-serif;font-size:10pt;background-color:transparent"> branch.  The </span><code>git-new-branch</code><span style="font-size:10pt;background-color:transparent"><font face="arial, sans-serif"> command (in depot_tools) will do this:</font></span></p><ul style="padding-left:25px;max-width:62em;font-family:arial,sans-serif"><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git new-branch branch_name</pre></ul><font face="arial, sans-serif">Note that this is equivalent to the following:<br /></font><ul style="padding-left:25px;max-width:62em;font-family:arial,sans-serif"><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git checkout <span style="color:rgb(102,102,0)">-</span>b new_branch origin/master</pre></ul><h3><a name="TOC-Branch-off-a-branch"></a>Branch off a branch</h3><div>If you have dependent changes, a very productive workflow is to have a branch off a branch. Notably, this means that your patch sets (in Rietveld) will show the separate changes, and be easy to review, rather than showing the merged changes (including irrelevant changes), and means you can commit downstream CLs without having to rebase them after the upstream has landed. Do this as follows:</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>git checkout master</code></div><div><code>git checkout branch1</code></div><div><code># some edits, commit</code></div><div><code>git checkout -b branch2</code></div><div><code>git branch --set-upstream-to=branch1</code></div><div><code># some edits, commit</code></div><div></div></div><br /><div>Now when you update the first branch, you can simply <font face="courier new, monospace">git pull</font><font face="arial, sans-serif"> on the second branch as normal to pull in your changes:</font></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>git checkout branch1</code></div><div><code># some edits, commit</code></div><div><code>git checkout branch2</code></div><div><code>git pull</code></div></div><div><br /></div><div>Note that these incremental patch sets are easy to review, but <i>cannot</i> be applied to HEAD (because they are based off another branch), so you cannot test them on try bots. To test these, upload the diff from HEAD to a different (test-only) issue and test there:</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>ISSUE=$(git cl issue | sed -r 's/[^0-9]*([0-9]*).*/\1/')  # Save current issue via </code><span style="font-size:10pt;background-color:transparent"><code>git cl issue</code></span></div><div><code>git cl issue 0  # Clear issue</code></div><div><code>git cl upload -t "[TEST ONLY] Run tests for $ISSUE" -f origin/master  # Upload to new issue, no prompts</code></div><div><font color="#006000" face="monospace">TEST_ISSUE=$(git cl issue | sed -r 's/[^0-9]*([0-9]*).*/\1/')  # Save test issue</font></div><div><code>git cl try</code></div><div><code>git cl issue $ISSUE  # Restore original issue</code></div><div></div></div><div><br /></div><div>To open the test issue in Rietveld:</div><div><div></div></div><div class="sites-codeblock sites-codesnippet-block"><div><div><code>git cl issue $TEST_ISSUE</code></div><div><span style="font-size:10pt;background-color:transparent"><code>git cl web</code></span></div><div><code>git cl issue $ISSUE</code></div></div><div></div></div><br /><div>To try again:</div><div><div></div></div><div class="sites-codeblock sites-codesnippet-block"><div><div><code>git cl issue $TEST_ISSUE</code></div><div><font color="#006000" face="monospace">git cl upload -t 'Try again' -f origin/master</font></div><div><code>git cl try</code></div></div><div><code>git cl issue $ISSUE</code></div></div><div><br /></div><div>...and then when finished, delete the CL to clean up (via Rietveld):</div><div class="sites-codeblock sites-codesnippet-block"><div><code>git cl issue $TEST_ISSUE</code></div><div><code># git cl delete  # This command does not exist, go through Rietveld</code></div><div><code>git cl web</code></div><div><code>git cl issue $ISSUE</code></div></div><br /><div>Lastly, when an upstream branch has landed, and you've rebased it so it agrees with master, you can set the downstream branch's upstream branch to be <font face="courier new, monospace">origin/master</font>, which means you can now forget about the earlier branch:</div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code>git checkout branch2</code></div><div><code>git pull  # assuming branch1 is up-to-date with origin/master</code></div><div><code>git branch --set-upstream-to=origin/master</code></div></div><h3><a name="TOC-Splitting-up-a-CL"></a>Splitting up a CL</h3><div>A common variant of "branch off a branch" is splitting up a large CL into pieces. Given a local branch <code>big</code>, you'd like to split it up into <code>branch1</code> and <code>branch2</code>.</div><div><br /></div><div>One way to do this is to split off <code>branch1</code>, have that reviewed and committed, update local repo (<code>gclient sync</code>), and then rebase <code>big</code> to <code>master</code>. This is ok, but adds latency, and you can get the same result locally, so the second part of the CL can be uploaded and reviewed even before the first part is committed.</div><div><br /></div><div>This can be done manually, particularly if the files don't overlap, by making a new branch <code>branch1</code>, manually copying the changed files in the first part, then branching <code>branch2</code> off of that, and manually copying the files in the second part.</div><div><br /></div><div>However, this can be done more cleanly via git. The main points are <code>git-add -i</code> (<a href="http://git-scm.com/book/en/Git-Tools-Interactive-Staging">Interactive Staging</a>: <span style="font-size:10pt;background-color:transparent">to interactively choose files or hunks of a patch set) and </span><code style="font-size:10pt;background-color:transparent">git-rebase</code><span style="font-size:10pt;background-color:transparent"> (to set the second part to be dependent on the first part, removing the common changes); </span><a href="http://git-scm.com/docs/git-cherry-pick" style="font-size:10pt;background-color:transparent"><code>git-cherry-pick</code></a><span style="font-size:10pt;background-color:transparent"> is a technicality:</span></div><div></div><div class="sites-codeblock sites-codesnippet-block"><div><code># first split off branch1</code></div><div><code>git checkout origin/master</code></div><div><code>git new-branch branch1</code></div><div><code>git cherry-pick -n ..big  # apply and stage all ancestors of big that are not ancestors of HEAD, do not commit</code></div><div><code>git add -i</code><span style="color:rgb(0,96,0);font-family:monospace;line-height:1;font-size:10pt"> </span><span style="color:rgb(0,96,0);font-family:monospace;line-height:1;font-size:10pt"> # interactively choose which files or hunks to stage</span></div><div><code><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git commit  # commit staged changes</code></div><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git checkout -- . # discard unstaged changes</code></div><div><code><br /></code></div><div><code><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code># next set big to be a branch off of branch1</code></div><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git checkout big</code></div><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git branch --set-upstream-to=branch1</code></div><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git rebase branch1  # may need to resolve conflicts</code></div><div style="color:rgb(0,0,0);font-family:Arial,Verdana,sans-serif"><code>git branch -m branch2  # done!</code></div></code></div></code></div></div><div><br /></div><div>Concretely, <code>git-cherry-pick -n</code> applies and stages all changes, but does not commit them. In <span style="font-size:10pt;background-color:transparent"><code>git-add -i</code>, you can unstage files via <code>3: <b>r</b>evert</code>, and then stage files (or hunks of files, or edit the diff manually) via <code>5: <b>p</b>atch</code>, with manually editing via by the </span><span style="background-color:transparent"><code>e - manually edit the current hunk</code> option when staging a hunk.</span><span style="font-size:10pt;background-color:transparent"> While tedious, this is often easier than resolving conflicts during rebasing.</span></div><h3><a name="TOC-Deleting-an-obsolete-branch"></a>Deleting an obsolete branch</h3><div>You generally want to delete local branches after the changes have been committed to master. It is safest to check that your work has, in fact, been committed before deleting it.</div><div>Remember that you can always apply a CL that has been posted via:</div><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git checkout <span style="color:rgb(102,102,0)">-</span>b myworkfrompatch<br />  git cl patch <span style="color:rgb(0,102,102)">12345</span>  <span style="color:rgb(136,0,0)"># Using CL issue number, not bug number, applies latest patch set</span><br />  git cl patch https<span style="color:rgb(102,102,0)">:</span><span style="color:rgb(136,0,0)">//codereview.chromium.org/download/issue12345_1.diff  # Use URL of raw patch for older patch sets</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">...so as long as your CL has been posted, you can easily recover your work. Otherwise, you'll need to dig through the git repository, so be careful.</p><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">Simply, if master (remote or local) is up-to-date and your branch has been rebased, <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">git branch -d</tt> will delete the branch. If not, it will refuse; to force deletion, use <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">git branch -D</tt>. So make sure master is up-to-date, rebase branch, and then try deleting (optionally check manually before).</p><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">Beware that if your local branch has many revisions (instead of always amending a single revision), rebasing to master may fail, since it will try to apply the patches incrementally. You can avoid this by squashing your local revisions into a single revision (see <a href="http://git-scm.com/book/en/Git-Tools-Rewriting-History" rel="nofollow" style="color:rgb(0,0,204)">6.4 Git Tools - Rewriting History</a>, or more simply <a href="http://gitready.com/advanced/2009/02/10/squashing-commits-with-rebase.html" rel="nofollow" style="color:rgb(0,0,204)">squashing commits with rebase</a>). This may be more trouble than it's worth, but it's the safest way.</p><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">To check that the branch has been committed upstream:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git checkout mywork<br />  git rebase origin<span style="color:rgb(102,102,0)">/</span>master<br />  git diff <span style="color:rgb(102,102,0)">--</span>stat origin<span style="color:rgb(102,102,0)">/</span>master  <span style="color:rgb(136,0,0)"># optional check</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">If there are no differences, delete the branch:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git checkout origin<span style="color:rgb(102,102,0)">/</span>master<br />  git branch <span style="color:rgb(102,102,0)">-</span>d mywork  <span style="color:rgb(136,0,0)"># will only work if has been merged</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif"><b style="line-height:1.25em;font-size:10pt;background-color:transparent">NOTE:</b><span style="line-height:1.25em;font-size:10pt;background-color:transparent"> If you haven't waited long enough after your commit, it is possible that 'git fetch' did not get your svn commit and git will continue to believe that you have local changes, which will prevent "git branch -d" from succeeding. It's best to redo the steps later, (The repo is updated every 3 minutes) but you can also instruct git to force-delete your branch.</span></p><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">Note that when you delete your branch, it will give you the SHA-1 hash for its tip:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">    <span style="color:rgb(102,0,102)">Deleted</span> branch mywork <span style="color:rgb(102,102,0)">(</span>was <span style="color:rgb(0,102,102)">123abc0</span><span style="color:rgb(102,102,0)">).</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">You can then recover the branch via:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">    git checkout <span style="color:rgb(102,102,0)">-</span>b mywork <span style="color:rgb(0,102,102)">123abc0</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">If you forget the hash, you can find it via <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">git reflog</tt>. (Reference: <a href="http://stackoverflow.com/questions/3640764/can-i-recover-branch-after-the-deletion-in-git" rel="nofollow" style="color:rgb(0,0,204)">Can I recover branch after the deletion in git?</a>)</p><h3 style="font-size:medium;border:0px;padding:0.5ex 0.5em 0.5ex 0px;margin:0px;max-width:700px;font-family:arial,sans-serif;background-image:none"><a name="Prevent_commits_to_master"></a>Prevent commits to master</h3><p style="line-height:1.25em;max-width:64em"><span style="font-family:arial,sans-serif">If you commit to <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">master</tt>, updating will be messy.  (This is a good reason to simply delete </span><font face="courier new, monospace">master</font><font face="arial, sans-serif"> entirely, as noted near the top of this document.  You only need to read the remainder of this section if you don't do this.)</font></p><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">You can prevent this by adding a pre-commit hook that checks if you're in <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">master</tt> and stops you from doing this. Create a file named <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">chromium/src/.git/hooks/pre-commit</tt> and add the below to it, then mark executable. (Blink developers: add in blink directory as well.)</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)"><span style="color:rgb(136,0,0)">#!/bin/bash</span><br /><br /><span style="color:rgb(136,0,0)"># Prevent commits against the 'master' branch</span><br /><span style="color:rgb(0,0,136)">if</span> <span style="color:rgb(102,102,0)">[[</span> <span style="color:rgb(0,136,0)">`git rev-parse --abbrev-ref HEAD`</span> <span style="color:rgb(102,102,0)">==</span> <span style="color:rgb(0,136,0)">'master'</span> <span style="color:rgb(102,102,0)">]]</span><br /><span style="color:rgb(0,0,136)">then</span><br />    echo <span style="color:rgb(0,136,0)">'You cannot commit to the master branch!'</span><br />    echo <span style="color:rgb(0,136,0)">'Stash your changes and apply them to another branch, using:'</span><br />    echo <span style="color:rgb(0,136,0)">'git stash'</span><br />    echo <span style="color:rgb(0,136,0)">'git checkout &lt;branch&gt;'</span><br />    echo <span style="color:rgb(0,136,0)">'git stash apply'</span><br />    <span style="color:rgb(0,0,136)">exit</span> <span style="color:rgb(0,102,102)">1</span><br /><span style="color:rgb(0,0,136)">fi</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">If you've accidentally uploaded a change list from master, you can clear the association of an issue number with master via:</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git cl issue <span style="color:rgb(0,102,102)">0</span></pre><p style="line-height:1.25em;max-width:64em;font-family:arial,sans-serif">If you've accidentally committed to <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">master</tt>, then, after copying your work to a new branch (e.g., make patch and then apply to new branch), you can clean up <tt style="font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;font-size:12px;max-width:66em">master</tt> by deleting your accidental commit as per <a href="http://stackoverflow.com/a/6866485" rel="nofollow" style="color:rgb(0,0,204)">this answer</a> to <a href="http://stackoverflow.com/questions/927358/how-to-undo-the-last-git-commit" rel="nofollow" style="color:rgb(0,0,204)">How to undo the last Git commit?</a> -- see more details there.</p><pre style="font-size:12px;padding:0.5em;overflow:auto;font-family:Monaco,DejaVu Sans Mono,Bitstream Vera Sans Mono,Lucida Console,monospace;max-width:70em;background-color:rgb(238,238,238)">  git reset <span style="color:rgb(102,102,0)">--</span>hard HEAD<span style="color:rgb(102,102,0)">~</span><span style="color:rgb(0,102,102)">1</span></pre></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/how-tos/get-the-code/working-with-branches">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq924uQmsBJvFk5jnssb3ECCbMwdFGdiMfI0AxIW1RkziIHYuvw05wk4aOTh3QxtA5iqAfvXlzk9SsuWT6QlN9FrtxJDAINhTKfbFokt2PVl51TNJ57/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
