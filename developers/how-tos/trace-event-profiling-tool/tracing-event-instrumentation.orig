<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="/_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/how-tos","deleted":false,"title":"How-Tos","dir":"ltr"},{"path":"/developers/how-tos/trace-event-profiling-tool","deleted":false,"title":"The Trace Event Profiling Tool (about:tracing)","dir":"ltr"},{"path":"/developers/how-tos/trace-event-profiling-tool/tracing-event-instrumentation","deleted":false,"title":"Adding Traces to Chromium/WebKit/Javascript","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/how-tos/trace-event-profiling-tool/tracing-event-instrumentation\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers/how-tos/trace-event-profiling-tool","parentWuid":"wuid:gx:33634d51f825446f","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"Adding Traces to Chromium/WebKit/Javascript","locale":"en","wuid":"wuid:gx:7dc4322eb0303523","revision":5,"path":"/developers/how-tos/trace-event-profiling-tool/tracing-event-instrumentation","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"tracing-event-instrumentation","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="Adding Traces to Chromium/WebKit/Javascript - The Chromium Projects" />
<meta itemprop="name" content="Adding Traces to Chromium/WebKit/Javascript - The Chromium Projects" />
<meta property="og:title" content="Adding Traces to Chromium/WebKit/Javascript - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/overlay.css?cb=beigeandblueundefineda100%25%25150goog-ws-leftthemedefaultstandard" />
<link rel="stylesheet" type="text/css" href="/_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>Adding Traces to Chromium/WebKit/Javascript - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="https://www.chromium.org/" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="https://www.chromium.org/" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-projects" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/Home" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/chromium-os" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/for-testers/bug-reporting-guidelines" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://www.chromium.org/developers/discussion-groups" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="/system/app/pages/sitemap/hierarchy" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="/developers" dir="ltr">For Developers</A>‎ &gt; ‎<A href="/developers/how-tos" dir="ltr">How-Tos</A>‎ &gt; ‎<A href="/developers/how-tos/trace-event-profiling-tool" dir="ltr">The Trace Event Profiling Tool (about:tracing)</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">Adding Traces to Chromium/WebKit/Javascript</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div><div><font size="3">See <a href="https://www.chromium.org/developers/how-tos/trace-event-profiling-tool">Trace Event Profiling Tool (about:tracing)</a> for more information on about:tracing</font></div><div><font size="3"><br /></font></div><font size="3">Sometimes, about:tracing wont show you all the detail you want. Don't worry, you can add more instrumentation yourself.</font><div><font size="3"><br /></font></div><div><div><b><span style="font-family:Arial;background-color:transparent;font-weight:normal;vertical-align:baseline;white-space:pre-wrap"><div style="background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><font size="3">Trace macros are very low overhead. When tracing is not turned on, trace macros cost at most a few dozen clocks. When running, trace macros cost a few thousand clocks at most. Arguments to the trace macro are evaluated only when tracing is on --- if tracing is off, the value of the arguments dont get computed.</font></span></b></div></span></b></div><div></div></div><h2><a name="TOC-Function-Tracing"></a>Function Tracing</h2><div>The basic trace macros are TRACE_EVENTx, in 0, 1, and 2 argument flavors. These time the enclosing scope. In Chrome code, just do this:</div></div><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><span style="font-family:courier new,monospace">#include "base/trace_event/trace_event.h"</span></div><div><span style="font-family:courier new,monospace">// This </span><span style="font-family:courier new,monospace">traces the start and end of the function automatically:</span></div></div><div><div><div><font face="'courier new', monospace">void doSomethingCostly() {</font></div></div></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><font face="'courier new', monospace">  TRACE_EVENT0("MY_SUBSYSTEM", "doSomethingCostly");</font></div></div></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><font face="'courier new', monospace">  ...</font></div></div></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><font face="'courier new', monospace">}</font></div></div></div></blockquote><div><br /></div>In WebKit/Source/WebCore/, you can trace this way:<br /><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><span style="font-family:courier new,monospace">#include "platform/TraceEvent.h"</span></div></div></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><div><font face="'courier new', monospace">void doSomethingCostly() {</font></div></div></div></div><div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">  TRACE_EVENT0("MY_SUBSYSTEM", "doSomethingCostly");</span></div></div><div><div><span style="font-family:courier new,monospace;font-size:10pt;background-color:transparent">  ...</span></div></div><div><span style="font-family:courier new,monospace">}</span></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div></div></div></blockquote><div><div><span style="background-color:transparent;vertical-align:baseline"><b><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><br /></span></b></div><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline">The "MY_SUBSYSTEM" argument is a logical category for the trace event. This category can be used by the UI to hide certain kinds events, or even skip them from being collected. A common practice is to use the chromium module in which the code lies, so for example, code in content/renderer gets the "renderer" category.</span></b></div><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><br /></span></b></div><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent">TRACE_EVENT1 and 2 allows you to capture 1 and 2 pieces of data long with the event. So, for example, this records the paint dimensions number along with the paint:</div><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent"><span style="font-family:courier new,monospace;font-size:13px;white-space:normal"><span>    </span>void RenderWidget::paint(const Rect&amp; r) {</span></div><div style="font-weight:normal;font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent"><span style="font-family:courier new,monospace;font-size:13px;white-space:normal"><span>    <span>    TRACE_EVENT2("renderer", "RenderWidget::paint", "width", r.width(), "height", r.height());</span></span><br /></span></div></b><div style="background-color:transparent"><br /><h2><a name="TOC-Javascript-Tracing"></a>Javascript Tracing</h2>You<b><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><div style="font-family:Arial;font-size:15px;white-space:pre-wrap;background-color:transparent;display:inline!important"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><div style="background-color:transparent;display:inline!important"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"><div style="background-color:transparent;display:inline!important"><b><span style="background-color:transparent;font-weight:normal;vertical-align:baseline"> can instrument javascript code as well:</span></b></div></span></b></div></span></b></div></span></b></b></div></span></div><div><p dir="ltr" style="font-weight:bold;margin-left:36pt;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;background-color:transparent;font-weight:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"><font face="'courier new', monospace">function Foo() {</font></span></p><p dir="ltr" style="font-weight:bold;margin-left:36pt;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;background-color:transparent;font-weight:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"><font face="'courier new', monospace">   console.time(“Foo”);<br />   var now = Date.now();</font></span></p><p dir="ltr" style="font-weight:bold;margin-left:36pt;margin-top:0pt;margin-bottom:0pt"><span style="font-size:15px;background-color:transparent;font-weight:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"><font face="'courier new', monospace">   while (Date.now() &lt; now + 1000);</font></span></p><p dir="ltr" style="font-weight:bold;margin-left:36pt;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:15px;font-weight:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"><font face="'courier new', monospace">   console.timeEnd("Foo");</font></span></p><p dir="ltr" style="font-weight:bold;margin-left:36pt;margin-top:0pt;margin-bottom:0pt"><span style="background-color:transparent;font-size:15px;font-weight:normal;text-decoration:none;vertical-align:baseline;white-space:pre-wrap"><font face="'courier new', monospace">}</font></span></p></div></div><div><div><span style="background-color:transparent;vertical-align:baseline"><span style="background-color:transparent;vertical-align:baseline"><div style="font-size:15px;font-weight:normal;white-space:pre-wrap;text-decoration:none;background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;text-decoration:none;vertical-align:baseline"><br /></span></b></div><div style="font-size:15px;font-weight:normal;white-space:pre-wrap;text-decoration:none;font-family:Arial;background-color:transparent"><b><span style="background-color:transparent;font-weight:normal;text-decoration:none;vertical-align:baseline">Note that currently, console.time/timeEnd spam the inspector console when it is open --- when inspector is closed, there is little or no performance penalty to the API.</span></b></div><div style="background-color:transparent"><h2><a name="TOC-CountersTo-track-a-value-as-it-evolves-over-time-use-TRACE_COUNTERx-or-TRACE_COUNTER_IDx.-For-example:"></a>Counters<br /><span style="background-color:transparent;font-family:Arial;font-size:15px;font-weight:normal;white-space:pre-wrap">To track a value as it evolves over time, use TRACE_COUNTERx or TRACE_COUNTER_IDx. For example:</span></h2><h2><a name="TOC-include-base-trace_event-trace_event.h-shmAlloc-...-...-TRACE_COUNTER2-shm-BytesAllocated-allocated-g_shmBytesAllocated-remaining-g_shmBytesFree-shmFree-...-...-TRACE_COUNTER2-shm-BytesAllocated-allocated-g_shmBytesAllocated-remaining-g_shmBytesFree-"></a><div style="font-size:13px;font-weight:normal"><span style="background-color:transparent;vertical-align:baseline"><div style="background-color:transparent"><div><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><span style="font-family:courier new,monospace">#include </span><span style="font-family:courier new,monospace;font-size:13.3333330154419px;background-color:transparent">"base/trace_event/trace_event.h"</span></div></div></div></blockquote><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><font face="'courier new', monospace">shmAlloc(...) {<br />   ...<br />   TRACE_COUNTER2("shm", "BytesAllocated", "allocated", g_shmBytesAllocated, "remaining", g_shmBytesFree);<br />}</font></div></div><div><font face="'courier new', monospace">shmFree(...) {<br />   ...<br /></font><span style="font-family:courier new,monospace">   TRACE_COUNTER2("shm", "BytesAllocated", "allocated", g_shmBytesAllocated, "remaining", g_shmBytesFree);</span><br style="font-family:courier new,monospace" /><font face="'courier new', monospace">}</font></div></blockquote></div></div></span></div></h2><h2><a name="TOC-Sometimes-a-counter-is-specific-to-a-class-instance.-For-that-use-the-_ID-variant:"></a><span style="background-color:transparent;font-family:Arial;font-size:15px;font-weight:normal;white-space:pre-wrap">Sometimes a counter is specific to a class instance. For that, use the _ID variant:</span></h2><blockquote style="margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><h2><a name="TOC-Document::didModifySubtree-...-TRACE_COUNTER2-dom-numDOMNodes-calcNumNodes-"></a><div style="font-size:13px;font-weight:normal"><span style="background-color:transparent;vertical-align:baseline"><div style="background-color:transparent"><div><span style="font-family:courier new,monospace;background-color:transparent">Document::didModifySubtree(...) {</span><br /><span style="font-family:courier new,monospace;background-color:transparent">   TRACE_COUNTER2("dom", "numDOMNodes", calcNumNodes());</span><br /><div><font face="'courier new', monospace">}</font></div></div></div></span></div></h2></div></div></blockquote><h2><a name="TOC-This-will-create-a-different-counter-for-each-ID."></a><span style="background-color:transparent;font-family:Arial;font-size:15px;font-weight:normal;white-space:pre-wrap">This will create a different counter for each ID.</span></h2><h2><a name="TOC-Asynchronous-Events"></a><span style="background-color:transparent">Asynchronous Events</span></h2><span style="background-color:transparent;font-family:Arial;font-size:15px;font-weight:normal;white-space:pre-wrap">Sometimes, you will have an asynchronous event that you want to track. For this, use TRACE_EVENT_ASYNC_BEGINx and TRACE_EVENT_ASYNC_ENDx. For example:</span><div><span style="background-color:transparent;vertical-align:baseline"><div style="background-color:transparent"><div><blockquote style="text-decoration:none;font-weight:normal;font-family:Arial,Verdana,sans-serif;font-size:13px;white-space:normal;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div><div><span style="font-family:courier new,monospace">#include </span><span style="font-family:courier new,monospace;font-size:13.3333330154419px;background-color:transparent">"base/trace_event/trace_event.h"</span></div></div></div></blockquote><blockquote style="text-decoration:none;font-weight:normal;font-size:13px;white-space:normal;margin-top:0px;margin-right:0px;margin-bottom:0px;margin-left:40px;border-top-style:none;border-right-style:none;border-bottom-style:none;border-left-style:none;border-width:initial;border-color:initial;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px"><div><div style="font-family:Arial,Verdana,sans-serif"><font face="'courier new', monospace">AsyncFileOperation::AsyncFileOperation(...) {<br /><span>    TRACE_EVENT_ASYNC_BEGIN("io", "AsyncFileOperation", this);</span><br /></font></div></div><div style="font-family:Arial,Verdana,sans-serif"><span style="font-family:courier new,monospace">}</span></div><div style="font-family:Arial,Verdana,sans-serif"><span style="font-family:courier new,monospace">void AsyncFileOperation::OnReady() {</span></div><div style="font-family:Arial,Verdana,sans-serif"><span style="font-family:courier new,monospace">    TRACE_EVENT_ASYNC_END("io', "AsyncFileOperation", this);<br />    ...<br />}</span></div><div style="font-family:Arial,Verdana,sans-serif"><span style="font-family:courier new,monospace"><br /></span></div></blockquote><font face="arial, sans-serif" size="3">Async operations can start and finish on different threads, or even different proceses. Association is done by the concatenation of the name string and the third "id" argument. The nearest match in time establishes the relationship. </font></div><div><font face="arial, sans-serif" size="3"><br /></font></div><div><font face="arial, sans-serif" size="3"><br /></font></div></div></span></div></div></span></span></div><div style="text-align:left"></div></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/how-tos/trace-event-profiling-tool/tracing-event-instrumentation">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/recentChanges">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="/system/app/pages/reportAbuse" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9wXxoopQ8KtYCnOyLSNN8o8ilxII5mLNcJyR3hC9Hnv2vwRfc95n15lF8qftNGQ9UHn_gRlS8AGn4LURpijTu3JuQgFrELA328k3lKGm232vkKf-k/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
