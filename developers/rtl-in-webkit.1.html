<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" itemscope="" itemtype="http://schema.org/WebPage">
<head>
<meta http-equiv="X-UA-Compatible" content="chrome=1" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var e="wtsrt_",g="tbsd_",h="tbnd_",k="start",l="_wtsrt",m="_tbnd",n="CSI/";(function(){function f(a){this.t={};this.tick=function(a,c,b){this.t[a]=[void 0!=b?b:(new Date).getTime(),c];if(void 0==b)try{window.console.timeStamp(n+a)}catch(d){}};this.tick(k,null,a)}var a;window.performance&&(a=window.performance.timing);var p=a?new f(a.responseStart):new f;window.jstiming={Timer:f,load:p};if(a){var c=a.navigationStart,d=a.responseStart;0<c&&d>=c&&(window.jstiming.srt=d-c)}if(a){var b=window.jstiming.load;0<c&&d>=c&&(b.tick(l,void 0,c),b.tick(e,l,d),b.tick(g,e))}try{a=null,
window.chrome&&window.chrome.csi&&(a=Math.floor(window.chrome.csi().pageT),b&&0<c&&(b.tick(m,void 0,window.chrome.csi().startE),b.tick(h,m,c))),null==a&&window.gtbExternal&&(a=window.gtbExternal.pageT()),null==a&&window.external&&(a=window.external.pageT,b&&0<c&&(b.tick(m,void 0,window.external.startE),b.tick(h,m,c))),a&&(window.jstiming.pt=a)}catch(q){}})(); })()
</script>
<link rel="shortcut icon" href="../_/rsrc/1354323194313/favicon.ico" type="image/x-icon" />
<link rel="apple-touch-icon" href="https://ssl.gstatic.com/sites/p/56e332/system/app/images/apple-touch-icon.png" type="image/png" />
<script type="text/javascript">/* Copyright 2008 Google. */ (function() { var d="",g="__duration__",h="function";function k(c){return document.getElementById(c)}window.byId=k;function l(c){return c.replace(/^\s+|\s+$/g,d)}window.trim=l;var m=[],n=0;window.JOT_addListener=function(c,a,b){var e=new String(n++);c={eventName:c,handler:a,compId:b,key:e};m.push(c);return e};window.JOT_removeListenerByKey=function(c){for(var a=0;a<m.length;a++)if(m[a].key==c){m.splice(a,1);break}};
window.JOT_removeAllListenersForName=function(c){for(var a=0;a<m.length;a++)m[a].eventName==c&&m.splice(a,1)};window.JOT_postEvent=function(c,a,b){var e={eventName:c,eventSrc:a||{},payload:b||{}};if(window.JOT_fullyLoaded)for(a=m.length,b=0;b<a&&b<m.length;b++){var f=m[b];f&&f.eventName==c&&(e.listenerCompId=f.compId||d,(f=typeof f.handler==h?f.handler:window[f.handler])&&f(e))}else window.JOT_delayedEvents.push({eventName:c,eventSrc:a,payload:b})};window.JOT_delayedEvents=[];
window.JOT_fullyLoaded=!1;window.JOT_formatRelativeToNow=function(c,a){var b=((new Date).getTime()-c)/6E4;if(1440<=b||0>b)return null;var e=0;60<=b&&(b/=60,e=2);2<=b&&e++;return a?window.JOT_siteRelTimeStrs[e].replace(g,Math.floor(b)):window.JOT_userRelTimeStrs[e].replace(g,Math.floor(b))}; })()
</script>
<script>

  

  var breadcrumbs = [{"path":"/developers","deleted":false,"title":"For Developers","dir":"ltr"},{"path":"/developers/rtl-in-webkit","deleted":false,"title":"BiDi support in WebKit","dir":"ltr"}];
  var JOT_clearDotPath = 'https://ssl.gstatic.com/sites/p/56e332/system/app/images/cleardot.gif';

  
  var JOT_userRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

  
  

  

  var webspace = {"enableAnalytics":true,"pageSharingId":"jotspot_page","enableUniversalAnalytics":false,"sharingPolicy":"OPENED_WITH_INDICATOR","siteTitle":"The Chromium Projects","isStartPageEnabled":true,"adsensePublisherId":null,"features":{"languageSelectDefaultTextSetToDefault":true,"validateClientGvizDataSourceUrls":true,"moreMobileStyleImprovements":true,"newInsertMenuIcons":true,"accessibleSortingButtons":true,"domainAnalyticsInGAOnly":true,"noCaptcha":true,"fileCabinetScreenReaderFix":true,"updatedTosAndPrivacyLinks":null,"pageDrafts":false,"mobileOrientationFix":true,"plusBadge":false,"pdfEmbedSupport":false,"jsClickFix":true},"isPublic":true,"isConsumer":false,"serverFlags":{"cajaBaseUrl":"//www.gstatic.com/caja","cajaDebugMode":false},"onepickBaseUrl":"https://docs.google.com","domainAnalyticsAccountId":"","plusPageId":"","signInUrl":"https://www.google.com/a/SelectSession?continue\u003dhttps://sites.google.com/a/chromium.org/dev/developers/rtl-in-webkit\u0026service\u003djotspot","analyticsAccountId":"UA-5484340-1","scottyUrl":"/_/upload","homePath":"/","siteNoticeUrlEnabled":null,"plusPageUrl":"","adsensePromoClickedOrSiteIneligible":true,"csiReportUri":"https://gg.google.com/csi","sharingId":"jotspot","termsUrl":"//www.google.com/intl/en/policies/terms/","gvizVersion":1,"editorResources":{"sitelayout":["https://ssl.gstatic.com/sites/p/56e332/system/app/css/sitelayouteditor.css"],"text":["https://ssl.gstatic.com/sites/p/56e332/system/js/codemirror.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codemirror_css.css","https://ssl.gstatic.com/sites/p/56e332/system/js/trog_edit__en.js","https://ssl.gstatic.com/sites/p/56e332/system/app/css/trogedit.css","/_/rsrc/1441580320000/system/app/css/editor.css","https://ssl.gstatic.com/sites/p/56e332/system/app/css/codeeditor.css","/_/rsrc/1441580320000/system/app/css/camelot/editor-jfk-wlb.css"]},"sharingUrlPrefix":"/_/sharing","isAdsenseEnabled":true,"domain":"chromium.org","baseUri":"","name":"dev","siteTemplateId":false,"siteNoticeRevision":null,"siteNoticeUrlAddress":null,"siteNoticeMessage":null,"page":{"isRtlLocale":false,"canDeleteWebspace":null,"isPageDraft":null,"parentPath":"/developers","parentWuid":"wuid:gx:982466121d9f2cd","siteLocale":"en","timeZone":"America/Los_Angeles","type":"text","title":"BiDi support in WebKit","locale":"en","wuid":"wuid:gx:272cb1d688746722","revision":57,"path":"/developers/rtl-in-webkit","isSiteRtlLocale":false,"pageInheritsPermissions":null,"name":"rtl-in-webkit","canChangePath":true,"state":"","properties":{},"bidiEnabled":false,"currentTemplate":{"path":"/system/app/pagetemplates/text","title":"Web Page"}},"canPublishScriptToAnyone":true,"user":{"keyboardShortcuts":true,"sessionIndex":"","guest_":true,"displayNameOrEmail":"guest","userName":"guest","uid":"","renderMobile":false,"domain":"","namespace":"","hasWriteAccess":false,"namespaceUser":false,"primaryEmail":"guest","hasAdminAccess":false},"gadgets":{"baseUri":"/system/app/pages/gadgets"}};
  webspace.page.breadcrumbs = breadcrumbs;

  
  var JOT_siteRelTimeStrs = ["a minute ago","__duration__ minutes ago","an hour ago","__duration__ hours ago"];

</script>
<script type="text/javascript">
                window.jstiming.load.tick('scl');
              </script>
<meta name="title" content="BiDi support in WebKit - The Chromium Projects" />
<meta itemprop="name" content="BiDi support in WebKit - The Chromium Projects" />
<meta property="og:title" content="BiDi support in WebKit - The Chromium Projects" />
<meta name="description" content="Home of the Chromium Open Source Project" />
<meta itemprop="description" content="Home of the Chromium Open Source Project" />
<meta id="meta-tag-description" property="og:description" content="Home of the Chromium Open Source Project" />
<style type="text/css">
</style>
<link rel="stylesheet" type="text/css" href="https://ssl.gstatic.com/sites/p/56e332/system/app/themes/beigeandblue/standard-css-beigeandblue-ltr-ltr.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/overlay.css%3Fcb=beigeandblueundefineda100%2525%2525150goog-ws-leftthemedefaultstandard.css" />
<link rel="stylesheet" type="text/css" href="../_/rsrc/1441580320000/system/app/css/camelot/allthemes-view.css" />
<!--[if IE]>
          <link rel="stylesheet" type="text/css" href="/system/app/css/camelot/allthemes%2die.css" />
        <![endif]-->
<title>BiDi support in WebKit - The Chromium Projects</title>
<meta itemprop="image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<meta property="og:image" content="/_/rsrc/1438879449147/config/customLogo.gif?revision=3" />
<script type="text/javascript">
                window.jstiming.load.tick('cl');
              </script>
</head>
<body xmlns="http://www.google.com/ns/jotspot" id="body" class=" en            ">
<div id="sites-page-toolbar" class="sites-header-divider">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-status" class="sites-status" style="display:none;"><div id="sites-notice" class="sites-notice" role="status" aria-live="assertive"> </div></div>
</div>
<div id="sites-chrome-everything-scrollbar">
<div id="sites-chrome-everything" class="">
<div id="sites-chrome-page-wrapper" style="direction: ltr">
<div id="sites-chrome-page-wrapper-inside">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-chrome-header-wrapper" style="height:auto;">
<table id="sites-chrome-header" class="sites-layout-hbox" cellspacing="0" style="height:auto;">
<tr class="sites-header-primary-row" id="sites-chrome-userheader">
<td id="sites-header-title" class="" role="banner"><div class="sites-header-cell-buffer-wrapper"><a href="../index.html" id="sites-chrome-userheader-logo"><img id="logo-img-id" src="../_/rsrc/1438879449147/config/customLogo.gif%3Frevision=3" alt="The Chromium Projects" class="sites-logo  " /></a><h2><a href="../index.html" dir="ltr" id="sites-chrome-userheader-title">The Chromium Projects</a></h2></div></td><td class="sites-layout-searchbox  "><div class="sites-header-cell-buffer-wrapper"><form id="sites-searchbox-form" action="https://www.chromium.org/system/app/pages/search" role="search"><input type="hidden" id="sites-searchbox-scope" name="scope" value="search-site" /><input type="text" id="jot-ui-searchInput" name="q" size="20" value="" aria-label="Search this site" /><div id="sites-searchbox-button-set" class="goog-inline-block"><div role="button" id="sites-searchbox-search-button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0">Search this site</div></div></form></div></td>
</tr>
<tr class="sites-header-secondary-row" id="sites-chrome-horizontal-nav">
<td colspan="2" id="sites-chrome-header-horizontal-nav-container" role="navigation">
</td>
</tr>
</table>
</div>
<div id="sites-chrome-main-wrapper">
<div id="sites-chrome-main-wrapper-inside">
<table id="sites-chrome-main" class="sites-layout-hbox" cellspacing="0" cellpadding="{scmCellpadding}" border="0">
<tr>
<td id="sites-chrome-sidebar-left" class="sites-layout-sidebar-left initial" style="width:150px">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_7648876402527094" class="sites-embed" role="navigation"><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-projects.html" jotId="wuid:gx:10ae433dadbbab13" class="sites-navigation-link">Home</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../Home.1.html" jotId="wuid:gx:43582b9d2029d3af" class="sites-navigation-link">Chromium</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../chromium-os.1.html" jotId="wuid:gx:83df2ab1f8880ba" class="sites-navigation-link">Chromium OS</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_14720868319272995" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Quick links</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="../for-testers/bug-reporting-guidelines.html" class="sites-navigation-link">Report bugs</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="discussion-groups.html" class="sites-navigation-link">Discuss</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="../system/app/pages/sitemap/hierarchy.html" jotId="wuid:gx:4b58a9a350ad12f" class="sites-navigation-link">网站地图</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19690813310444355" class="sites-embed" role="navigation"><h4 class="sites-embed-title">Other sites</h4><div class="sites-embed-content sites-sidebar-nav"><ul role="navigation" jotId="navList"><li class="nav-first "><div dir="ltr" style="padding-left: 5px;"><a href="http://blog.chromium.org/" class="sites-navigation-link">Chromium Blog</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="http://code.google.com/chrome/extensions/" class="sites-navigation-link">Google Chrome Extensions</a></div></li><li class=""><div dir="ltr" style="padding-left: 5px;"><a href="https://developers.google.com/chrome/chrome-frame/" class="sites-navigation-link">Google Chrome Frame</a></div></li></ul></div></div>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_19695218559354544" class="sites-embed" role="complementary"><h4 class="sites-embed-title"></h4><div class="sites-embed-content sites-embed-content-sidebar-textbox"><div dir="ltr"><span style="font-size:x-small">Except as otherwise </span><a href="http://developers.google.com/site-policies.html#restrictions"><span style="font-size:x-small">noted</span></a><span style="font-size:x-small">, the content of this page is licensed under a </span><a href="http://creativecommons.org/licenses/by/2.5/"><span style="font-size:x-small">Creative Commons Attribution 2.5 license</span></a><span style="font-size:x-small">, and examples are licensed under the </span><a href="http://src.chromium.org/viewvc/chrome/trunk/src/LICENSE" target="_blank"><span style="font-size:x-small">BSD License</span></a><span style="font-size:x-small">.<br /></span></div></div></div>
</td>
<td id="sites-canvas-wrapper">
<div id="sites-canvas" role="main">
<div id="goog-ws-editor-toolbar-container"> </div>
<div xmlns="http://www.w3.org/1999/xhtml" id="title-crumbs" style="">
<A href="../developers.1.html" dir="ltr">For Developers</A>‎ &gt; ‎
  </div>
<h3 xmlns="http://www.w3.org/1999/xhtml" id="sites-page-title-header" style="" align="left">
<span id="sites-page-title" dir="ltr" tabindex="-1" style="outline: none">BiDi support in WebKit</span>
</h3>
<div id="sites-canvas-main" class="sites-canvas-main">
<div id="sites-canvas-main-content">
<table xmlns="http://www.w3.org/1999/xhtml" cellspacing="0" class="sites-layout-name-one-column sites-layout-hbox"><tbody><tr><td class="sites-layout-tile sites-tile-name-content-1"><div dir="ltr"><div>
<h2><a name="TOC-RTL-Task-Force"></a><span style="font-size:13px;font-weight:normal">
<div>
<div><div class="sites-embed-align-left-wrapping-off"><div class="sites-embed-border-off sites-embed" style="width:800px;"><div class="sites-embed-content sites-embed-type-toc"><div class="goog-toc sites-embed-toc-maxdepth-6"><p>Contents</p><ol class="goog-toc"><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-RTL-Task-Force1"><strong>1 </strong>RTL Task Force</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-Standard-Proposal:-Additional-Requirements-for-Bidi-in-HTML"><strong>2 </strong>Standard Proposal: Additional Requirements for Bidi in HTML</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-Test-Suite"><strong>3 </strong>Test Suite</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-The-Challenges"><strong>4 </strong>The Challenges</a><ol class="goog-toc"><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-Lack-of-one-to-one-correspondence-between-visual-and-logical-character-positions."><strong>4.1 </strong>Lack of one-to-one correspondence between visual and logical character positions.</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-Lack-of-clear-spec-on-BiDi-editing-behavior"><strong>4.2 </strong>Lack of clear spec on BiDi editing behavior</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-Lack-of-clear-spec-on-behavior-of-HTML-in-the-face-of-certain-BiDi-issues."><strong>4.3 </strong>Lack of clear spec on behavior of HTML in the face of certain BiDi issues.</a></li></ol></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-References"><strong>5 </strong>References</a></li><li class="goog-toc"><a href="rtl-in-webkit.1.html#TOC-RTL-Release-Note"><strong>6 </strong>RTL Release Note</a></li></ol></div></div></div></div><p><font size="3"><br /></font></p></div><span style="font-size:13px;font-weight:normal"><div><h2><a name="TOC-RTL-Task-Force1"></a><span style="font-size:20px;font-weight:bold">RTL Task Force</span></h2></div></span></div></span></h2><p><font size="2"><span style="font-weight:normal;font-family:arial,sans-serif">Objective: Improve RTL handling in webkit editing and layout/rendering.</span></font></p><p><font size="2"><span style="font-weight:normal;font-family:arial,sans-serif"> Mailing list: rtl-editing@google.com</span></font></p><p><a href="https://spreadsheets.google.com/a/google.com/ccc?key=0AjIpE6jmfbPCdHJlOW9iUUp5WmpuQ1VIUTBFR2VncUE&amp;authkey=CKCj8d4O&amp;hl=en#gid=0"><font size="2"><span style="font-weight:normal;font-family:arial,sans-serif">Issue tracker</span></font></a></p><p><font size="2"><span style="font-weight:normal;font-family:arial,sans-serif">Members: Alex Komoroske (PM), Xiaomei Ji, Ryosuke Niwa, Jeremy Moskovich, Levi Weintraub, Uri Bernstein, Aharon Lanin, Roland Steiner, Jason Elbaum, Ahmed Hassan, Mohamed Elhawary, Michal Levin (UX). </span></font></p><h2><a name="TOC-Standard-Proposal:-Additional-Requirements-for-Bidi-in-HTML"></a><font size="2"><br style="font-weight:normal;font-family:arial,sans-serif" /></font>    Standard Proposal: Additional Requirements for Bidi in HTML</h2><span style="font-family:Arial,sans-serif;font-size:12px;color:rgb(34,34,34);white-space:nowrap"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;color:rgb(0,0,0);white-space:normal">
<div><span style="font-family:arial,sans-serif;border-collapse:collapse">
<div>
<ul><li><a href="http://www.w3.org/TR/html-bidi/" style="color:rgb(0,102,204);outline-style:none">Proposal</a></li></ul>
<ul><li><a href="https://docs.google.com/a/google.com/document/d/17nb3wlYkIG9MNtL1mlXVPOVe4QwyApiHRYim3nTi5CE/edit?hl=en#" style="color:rgb(0,102,204);outline-style:none">Implementation status</a></li></ul>
<ul><li><a href="https://bugs.webkit.org/show_bug.cgi?id=50910" style="color:rgb(0,102,204);outline-style:none">WebKit master bug</a></li></ul>
</div>
</span></div></span></span><h2><a name="TOC-Test-Suite"></a><span style="font-family:Arial,sans-serif;color:rgb(34,34,34);white-space:nowrap"><span style="font-family:Arial,Verdana,sans-serif;color:rgb(0,0,0);white-space:normal"><font size="4">
Test Suite
</font></span></span></h2><span style="font-family:Arial,sans-serif;font-size:12px;color:rgb(34,34,34);white-space:nowrap"><span style="font-family:Arial,Verdana,sans-serif;font-size:13px;color:rgb(0,0,0);white-space:normal"><div><span style="font-weight:normal">RTL in Rich Text Edit in <a href="http://www.browserscope.org/" style="color:rgb(0,102,204);outline-style:none">browserscope</a>.</span></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><span style="font-weight:normal">HTML+CSS internationalization test suite:<a href="http://www.w3.org/International/tests/tests-html-css/list-text-direction" style="color:rgb(0,102,204);outline-style:none"> text direction</a>.</span></div>
</span></span>
<h2><a name="TOC-The-Challenges"></a>The Challenges</h2>
<div>
<h3><a name="TOC-Lack-of-one-to-one-correspondence-between-visual-and-logical-character-positions."></a>Lack of one-to-one correspondence between visual and logical character positions.<br />
</h3>
<div>For right-to-left text, logical order (the order the text is stored) and visual order (the order the text is displayed) are not the same. They are not just the reversed order of each other when bi-directional text is involved. They also don't have a simple relationship (without going through reordering resolved levels in the <a href="http://unicode.org/reports/tr9/"> Unicode Bidi Algorithm</a>). For example, the last logical run of text could be a in the middle visually (not visually first neither visually last). </div>
<div><span style="border-collapse:collapse">
<div style="font-family:arial,sans-serif">&lt;div style="direction: ltr;"&gt;</div>
<div style="font-family:arial,sans-serif"><span style="white-space:pre-wrap"> </span>Just<br />
</div>
<div style="font-family:arial,sans-serif"><span style="white-space:pre-wrap"> </span>&lt;span&gt;testing רק&lt;/span&gt;<br />
</div>
<div style="font-family:arial,sans-serif"><span style="white-space:pre-wrap"> </span>בודק<br />
</div>
<div style="font-family:arial,sans-serif">&lt;/div&gt;<br />
<br />
<br />
</div>
<div><font face="arial, sans-serif">[Bidi editing in Mozilla] </font><span style="border-collapse:separate;font-size:small;line-height:16px"><font face="arial, sans-serif">The main issue involved in bidirectional editing is that there is no one-to-one relationship between a logical position in the text, and a visual position on screen. A single logical position can map to two different visual positions, and a single visual position might map to two different logical positions.</font></span></div>
</span><span style="font-size:small;line-height:16px"><font face="arial, sans-serif">
<p><small><i>In the following examples, I will use uppercase Latin letters to represent RTL (e.g. Hebrew) letters, whereas lowercase Latin letters will represent LTR (e.g. Latin) letters. This is the convention, as it makes it easier for people who can not read RTL languages to understand the examples.</i></small></p>
<p>Consider, for example, the text with the following logical representation: <b>latinHEBREWmore</b> (this example deliberately omits spaces, in order to avoid the issues associated with resolving their directionality). This text is displayed on the screen as <b>latinWERBEHmore</b>.</p>
<p>Consider the logical position between <b>n</b> and <b>H</b>. This is immediately after <b>n</b>, so it maps to the visual position between <b>n</b> and <b>W</b>. But it is also immediately before <b>H</b>, so it also maps to the visual position between <b>H</b> and <b>m</b>.</p>
<p>Now, consider the visual position between <b>n</b> and <b>W</b>. It is immediately after <b>n</b>, so it can be mapped to the logical position between <b>n</b> and <b>H</b>. But it also immediately after <b>W</b>, so it can also be mapped to the logical position between <b>W</b> and <b>m</b>.</p>
<p>Bidirectional text is stored logically, and (obviously) displayed visually. The caret, being a graphical element, corresponds to a visual location. The user can manipulate text and move the caret through a combination of <b>logical functions</b> (such as typing or deleting) and <b>visual functions</b> (such as using the arrow keys). Therefore, the problem of mapping between logical and visual positions in a way that meets the user's expectations is the central problem of bidirectional editing.[Bidi editing in Mozilla]</p></font></span>IBM has a non-trivial <a href="http://www-01.ibm.com/software/globalization/topics/bidiui/conversion.jsp">algorithm </a>for rendering the caret in correct position in bi-directional text.<span style="font-size:small;line-height:16px"><font face="arial, sans-serif"><br />
</font></span></div>
<h3><a name="TOC-Lack-of-clear-spec-on-BiDi-editing-behavior"></a>Lack of clear spec on BiDi editing behavior<br />
</h3>
<span style="font-size:small;line-height:16px"><font face="arial, sans-serif"><p>As mentioned above, mapping between logical and visual positions is the 
central problem of bidirectional editing. But, there is no standard on how 
such mapping should be done. Different browsers behave differently. For 
example, a logical string "123ABC" (where 123 represents Arabic number 
and ABC represents Arabic letter) is rendered as "CBA123" visually when 
the paragraph directionality is left-to-right. The visual positions in Firefox, IE, and Chrome/WebKit are as following:<br />
</p></font></span>
<pre>Internet Explorer: (0)(1)(7)C(6)B(5)A(4)1(2)2(3)3<br />Firefox: (0)(7)C(6)B(5)A(1)(4)1(2)2(3)3<br />Chrome/WebKit: (0)C(5)B(4)A1(1)2(2)3(3)(6).<br /><br /><span style="font-family:arial,sans-serif">Which one meets user's expectation is under <a href="https://bugs.webkit.org/show_bug.cgi?id=53696">discussion</a> right now.</span><br /></pre>
<span style="font-size:small;line-height:16px"><font face="arial, sans-serif">
</font></span>Another case of lacking clear spec is that there is no consensus on whether a UI function should behave logically or visually. Different browsers might behave differently. For example, IE handles cursor movement (arrow keys) as logical function, while Firefox (by default) and WebKit [after a long debate on the topic] handle it as visual function. For example, there are always discussions on whether selection should be treated as visual or logical. Currently, IE, Firefox (by default) and WebKit all treat selection as a logical operation. But Firefox also provides options to toggle between visual and logical behavior. For example, whether HOME &amp; END should put the caret at the visual extreme or they should be considered as logical operation. Currently, IE and WebKit handle HOME &amp; END as putting the caret at the visual extreme, while Firefox (by default) handles it as logical operation.<br /><span style="font-size:small;line-height:16px"><font face="arial, sans-serif"><br /></font></span><h3><a name="TOC-Lack-of-clear-spec-on-behavior-of-HTML-in-the-face-of-certain-BiDi-issues."></a>Lack of clear spec on behavior of HTML in the face of certain BiDi issues.<br />
</h3>
<p> For some HTML elements, there is no standard defined on how they should
 be rendered in RTL or in a bi-directional context. Different browsers behave
 differently. Since RTL users are mostly adjusted to the behavior of IE,
 they would expect the same behavior as that of IE, even it might not be
 the desired. For example, there is no standard defined on how to render
 &lt;input&gt; element, whether it should auto-detects the input text's 
directionality and uses that for rendering, or use the &lt;input&gt; 
element's directionality for rendering the input text. There are some 
discussions (comment <a href="https://bugs.webkit.org/show_bug.cgi?id=27889#c10" style="outline-style:none">#2</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=27889#c10" style="outline-style:none">#7</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=27889#c10" style="outline-style:none">#8</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=27889#c10" style="outline-style:none">#10</a> ) in related WebKit <a href="https://bugs.webkit.org/show_bug.cgi?id=27889" style="outline-style:none">issue</a>. For
 example, there is no standard defined on how to render 
&lt;selection&gt;/&lt;option&gt; elements when either or both the 
element have 'dir' attributes defined. There is discussion (comment <a href="https://bugs.webkit.org/show_bug.cgi?id=29612#c5">#2</a>, <a href="https://bugs.webkit.org/show_bug.cgi?id=29612#c5">#5</a>) in related Webkit <a href="https://bugs.webkit.org/show_bug.cgi?id=29612">issue</a>.
 The same goes for for script dialog text, &lt;title&gt; attribute etc. Aharon Lanin 
proposed additional requirement for BiDi in HTML for HTML5.</p>
<p><span style="border-collapse:collapse"><span style="font-size:small;line-height:16px"><font><font face="arial, sans-serif">The
 main issue involved in RTL rendering is not only whether to render bi-directional text 
correctly for any HTML structure (from example, inline element inside 
block element) </font></font></span>when 'dir' attribute is set, when 
unicode bidi control characters are used, when unicode-bidi property is 
set. But also to rendering the whole RTL page correctly. For example, previously, the #1 issue reported in Middle East North Africa by Chrome users is the <a href="https://bugs.webkit.org/show_bug.cgi?id=23556">truncation of the content of RTL page</a>s
 so only the right-most part of the content that fit in browser window 
was displayed. Fixing it requires a good understanding 
of the rendering layer (with 67k line of code) and its relation with the page and platform layers. Beyond that, the fix needed to work on different platforms (for example, Apple's Mac port has it's own distinct code path handling scroll view) as well.</span></p><br /></div>
<h2><a name="TOC-References"></a>References</h2>
<div><br />
</div>
<div>"dir" attribute:</div>
<div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://www.w3.org/TR/html401/struct/dirlang.html#h-8.2" style="color:rgb(0,0,204)" target="_blank">http://www.w3.org/TR/html401/struct/dirlang.html#h-8.2</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">"direction" and "unicode-bidi" properties:</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">
<div><a href="http://www.w3.org/TR/CSS21/visuren.html#direction" style="color:rgb(0,0,204)" target="_blank">http://www.w3.org/TR/CSS21/visuren.html#direction</a></div>
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">Handling right-to-left scripts:</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://www.w3.org/TR/i18n-html-tech-bidi/" style="color:rgb(0,0,204)" target="_blank">http://www.w3.org/TR/i18n-html-tech-bidi/</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">Internationalization techniques: handling text direction:</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://www.w3.org/International/techniques/authoring-html#direction" style="color:rgb(0,0,204)" target="_blank">http://www.w3.org/International/techniques/authoring-html#direction</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">What you need to know about the bidi algorithm and inline markup:</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://www.w3.org/International/articles/inline-bidi-markup/" style="color:rgb(0,0,204)" target="_blank">http://www.w3.org/International/articles/inline-bidi-markup/</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">Unicode Bidi Algorithm:</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://unicode.org/reports/tr9/" style="color:rgb(0,0,204)" target="_blank">http://unicode.org/reports/tr9/</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">
<div>BiDi HowTo:</div>
<div><a href="http://doctype.googlecode.com/svn/trunk/bidihowto/index.html">http://doctype.googlecode.com/svn/trunk/bidihowto/index.html</a></div>
<div><br />
</div>
<div>Public talk by Aharon on BiDi on the web:</div>
<div><a href="https://video.google.com/a/?pli=1#/Play/contentId=f041561143265ad5" style="color:rgb(0,0,204)" target="_blank">https://video.google.com/a/?pli=1#/Play/contentId=f041561143265ad5</a></div>
<div><br />
</div>
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">Bidi editing in Mozilla:</div>
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="https://wiki.mozilla.org/User:Uri/Bidi_editing" style="color:rgb(0,0,204)" target="_blank">https://wiki.mozilla.org/User:Uri/Bidi_editing</a></div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><br />
</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif">Guidelines of a logical user interface for editing bidirectional text by IBM</div>
<div style="border-collapse:collapse;font-family:arial,sans-serif"><a href="http://www-01.ibm.com/software/globalization/topics/bidiui/index.jsp">http://www-01.ibm.com/software/globalization/topics/bidiui/index.jsp</a><br /><br /></div><h2><a name="TOC-RTL-Release-Note"></a>RTL Release Note</h2>
<p>Milestone 9 (r72805): </p>
<ol><li>Solved the #1 issue reported in Middle East and North Africa. Now, RTL page with content overflow could be viewed completely with horizontal scrollbar instead of page being truncated (r72852).<br /></li>
<li>Unicode bidi control characters are preserved in text input area. So, Hebrew, Arabic, and Persian speakers can type or cut/copy/paste the text having unicode bidi control characters correctly, and they can start enjoy twitters (r71566).<br /></li></ol>Milestone 10 (r76408):<br /></div><div><ol><li>TAB inside &lt;pre&gt; overflow correctly in RTL context (r72847).</li><li>
up arrow works correctly with RTL text with word wrapping (r72861).</li><li><font size="2"><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px"><span style="font-family:arial,sans-serif">clicking to position cursor at the end of a line of Arabic text position the cursor correctly (r73548).</span></span></font></li><li>Default horizontal position of position:fixed block is right in RTL context.</li><li>move to line boundary visually works correctly in RTL context (r75018).</li><li><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Verdana,Arial,Bitstream Vera Sans,Helvetica,sans-serif;font-size:13px;line-height:17px">Caret goes to the right direction when pressing an arrow key after selection is made (r76312).</span></span></li></ol>Milestone 11 (r80534)<br /><ol><li>Support dir="auto" (r79024).</li><li>ISO-8859-8 Hebrew text displayed correctly (r78491).</li><li>Text runs with different directionality inside an embedding inline box displayed correctly in RTL context (r77267).</li><li>
Background image positioned correctly in RTL context (r78396).</li><li>&lt;option&gt; supports the dir attribute and be displayed accordingly both in the drop-down and after being chosen (r77654).</li><li><span style="border-collapse:separate;color:rgb(0,0,0);font-family:Times;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:normal;text-indent:0px;text-transform:none;white-space:normal;word-spacing:0px;font-size:medium"><span style="font-family:Verdana,Arial,Bitstream Vera Sans,Helvetica,sans-serif;font-size:13px;line-height:17px">extend selection by line boundary works correctly in RTL context (r78799).</span></span></li></ol></div></div></td></tr></tbody></table>
</div> 
</div> 
<div id="sites-canvas-bottom-panel">
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-subpages"> </div>
<div id="sites-attachments-container">
<div xmlns="http://www.w3.org/1999/xhtml" id="sites-attachments">
<div class="sites-attachments-row"><div class="sites-attachments-icon" style="left:0px;"><span aria-label="Attachments" title="Attachments"><div class="sites-translucent sites-symbol" aria-hidden="true">Č</div></span></div><div id="sites-attachments-update-div" class="sites-attachments-inner-div" style="display:none;"><span class="sites-attachments-update-icon"><img src="https://ssl.gstatic.com/sites/p/56e332/system/app/images/spinner.gif" /></span><div class="sites-attachments-update-text">Updating...</div></div></div><div class="sites-attachments-separator"></div>
<div id="attachment-wuid:gx:57d6b0f3610baca1"><div class="sites-attachments-row"><div class="sites-attachments-icon sites-attachments-icon-accessible" style="left:5px"><span class="sites-symbol sites-color-adobe-pdf" aria-label="Adobe PDF" title="Adobe PDF">Ċ</span></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name"><a href="https://docs.google.com/viewer?a=v&amp;pid=sites&amp;srcid=Y2hyb21pdW0ub3JnfGRldnxneDo1N2Q2YjBmMzYxMGJhY2Ex">WebKit_For_Web_Developers_1.pdf</a> <div class="sites-translucent">(2374k)</div></div><div class="sites-attachments-author">Xiaomei Ji, <div class="sites-translucent">Nov 19, 2010, 2:42 PM</div></div></div><div class="sites-attachments-version sites-attachments-version-accessible"><a href="https://www.chromium.org/system/app/pages/admin/revisions?wuid=wuid:gx:57d6b0f3610baca1">v.1</a></div><div id="attachment-download-wuid:gx:57d6b0f3610baca1" class="sites-attachments-icon sites-attachments-icon-accessible" style="right:0px"><a href="https://www.chromium.org/developers/rtl-in-webkit/WebKit_For_Web_Developers_1.pdf?attredirects=0&amp;d=1" aria-label="Download WebKit_For_Web_Developers_1.pdf" title="Download" role="button"><span class="sites-symbol" aria-hidden="true">ď</span></a></div></div><div class="sites-attachments-separator"></div></div>
<div id="attachment-wuid:gx:73ebde619d58a693"><div class="sites-attachments-row"><div class="sites-attachments-icon sites-attachments-icon-accessible" style="left:5px"><span class="sites-symbol sites-color-adobe-pdf" aria-label="Adobe PDF" title="Adobe PDF">Ċ</span></div><div class="sites-attachments-inner-div"><div class="sites-attachments-name"><a href="https://docs.google.com/viewer?a=v&amp;pid=sites&amp;srcid=Y2hyb21pdW0ub3JnfGRldnxneDo3M2ViZGU2MTlkNThhNjkz">WebKit_For_Web_Developers_2.pdf</a> <div class="sites-translucent">(370k)</div></div><div class="sites-attachments-author">Xiaomei Ji, <div class="sites-translucent">Nov 19, 2010, 2:42 PM</div></div></div><div class="sites-attachments-version sites-attachments-version-accessible"><a href="https://www.chromium.org/system/app/pages/admin/revisions?wuid=wuid:gx:73ebde619d58a693">v.1</a></div><div id="attachment-download-wuid:gx:73ebde619d58a693" class="sites-attachments-icon sites-attachments-icon-accessible" style="right:0px"><a href="https://www.chromium.org/developers/rtl-in-webkit/WebKit_For_Web_Developers_2.pdf?attredirects=0&amp;d=1" aria-label="Download WebKit_For_Web_Developers_2.pdf" title="Download" role="button"><span class="sites-symbol" aria-hidden="true">ď</span></a></div></div><div class="sites-attachments-separator"></div></div>
<div style="height: 10px"></div>
</div>
</div>
<a xmlns="http://www.w3.org/1999/xhtml" name="page-comments"></a>
<div xmlns="http://www.w3.org/1999/xhtml" id="COMP_page-comments"><div class="sites-comment-docos-wrapper"><div class="sites-comment-docos"><div class="sites-comment-docos-background"></div><div class="sites-comment-docos-header"><div class="sites-comment-docos-header-title">Comments</div></div><div id="sites-comment-docos-pane" class="sites-comment-docos-pane"></div></div></div></div>
</div>
</div> 
</td> 
</tr>
</table> 
</div> 
</div> 
<div id="sites-chrome-footer-wrapper">
<div id="sites-chrome-footer-wrapper-inside">
<div id="sites-chrome-footer">
</div>
</div>
</div>
</div> 
</div> 
<div id="sites-chrome-adminfooter-container">
<div xmlns="http://www.w3.org/1999/xhtml" class="sites-adminfooter" role="navigation"><p><a class="sites-system-link" href="https://www.google.com/a/UniversalLogin?service=jotspot&amp;continue=https://sites.google.com/a/chromium.org/dev/developers/rtl-in-webkit">Sign in</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/recentChanges.html">Recent Site Activity</a><span aria-hidden="true">|</span><a class="sites-system-link" href="../system/app/pages/reportAbuse.html" target="_blank">Report Abuse</a><span aria-hidden="true">|</span><a class="sites-system-link" href="javascript:;" onclick="window.open(webspace.printUrl)">Print Page</a><span aria-hidden="true">|</span><span class="sites-system-link">Powered By</span> <b class="powered-by"><a href="http://sites.google.com">Google Sites</a></b></p></div>
</div>
</div> 
</div> 
<div id="sites-chrome-onebar-footer">
</div>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('sjl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" src="https://ssl.gstatic.com/sites/p/56e332/system/js/jot_min_view__en.js"></script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    window.jstiming.load.tick('jl');
  </script>
<script xmlns="http://www.w3.org/1999/xhtml">
      
          sites.core.Analytics.createTracker();
          sites.core.Analytics.trackPageview();
        
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
                    sites.Searchbox.initialize(
                        'sites-searchbox-search-button',
                        {"object":[]}['object'],
                        'search-site',
                        {"label":"Configure search options...","url":"/system/app/pages/admin/settings"});
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
      gsites.HoverPopupMenu.createSiteDropdownMenus('sites-header-nav-dropdown', false);
    </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("7648876402527094", "Navigation", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_7648876402527094');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("14720868319272995", "Quick links", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_14720868319272995');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
            JOT_setupNav("19690813310444355", "Other sites", false);
            JOT_addListener('titleChange', 'JOT_NAVIGATION_titleChange', 'COMP_19690813310444355');
          </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
              new sites.CommentPane('//docs.google.com/comments/d/AAHRpnXvrAwjAfmld0ObrebBiGRq9abBHImPhigIUgjLbfwu3Lz1coaUywP5LmRKOt5wuvepIveDLt6l6ddQx7z9MHGRtI5gkVgflKS3vLmcqqiwHxgMgDU8NAT18ySfG6hlMYL3Dq5cD/api/js?anon=true',
                  false, false);
            </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
  setTimeout(function() {
    var fingerprint = gsites.date.TimeZone.getFingerprint([]);
    gsites.Xhr.send('https://www.chromium.org/_/tz', null, null, 'GET', null, null, { afjstz: fingerprint });
  }, 500);
</script>
<script xmlns="http://www.w3.org/1999/xhtml">
                    window.onload = function() {
                      if (false) {
                        JOT_setMobilePreview();
                      }
                      var loadTimer = window.jstiming.load;
                      loadTimer.tick("ol");
                      loadTimer["name"] = "load," + webspace.page.type + ",user_page";
                      window.jstiming.report(loadTimer, {}, 'https://gg.google.com/csi');
                    }
                  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
        JOT_insertAnalyticsCode(false,
            false);
      </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    var maestroRunner = new gsites.pages.view.SitesMaestroRunner(
        webspace, "en");
    maestroRunner.initListeners();
    maestroRunner.installEditRender();
  </script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript" defer="true">
  //<![CDATA[
    // Decorate any fastUI buttons on the page with a class of 'goog-button'.
    if (webspace.user.hasWriteAccess) {
      JOT_decorateButtons();
    }

    // Fires delayed events.
    (function() {
      JOT_fullyLoaded = true;
      var delayedEvents = JOT_delayedEvents;
      for (var x = 0; x < delayedEvents.length; x++) {
        var event = delayedEvents[x];
        JOT_postEvent(event.eventName, event.eventSrc, event.payload);
      }
      JOT_delayedEvents = null;
      JOT_postEvent('pageLoaded');
    })();
  //]]>
</script>
<script xmlns="http://www.w3.org/1999/xhtml" type="text/javascript">
    JOT_postEvent('decorateGvizCharts');
  </script>
<script type="text/javascript">
          JOT_setupPostRenderingManager();
        </script>
<script type="text/javascript">
          JOT_postEvent('renderPlus', null, 'sites-chrome-main');
        </script>
<div id="server-timer-div" style="display:none"> </div>
<script type="text/javascript">
          window.jstiming.load.tick('render');
          JOT_postEvent('usercontentrendered', this);
        </script>
</body>
</html>
